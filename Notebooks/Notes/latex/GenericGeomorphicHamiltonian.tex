\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
\title{Generic geomorphic Hamiltonian}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\pagecolor{white}
\author{Colin P. Stark}
\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{summary}{%
\section*{Summary}\label{summary}}

    The geomorphic Hamiltonian in Stark \& Stark (2022) was derived from and
equivalent to the Stream-Power Incision Model (SPIM). However, a more
generic form for a geomorphic Hamiltonian can be derived using the same
techniques. This notebook demonstrates this generality.

    If we want to map an erosion rate equation into a geomorphic
Hamiltonian, we need to make three conceptual leaps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  accept that \emph{erosion takes place normal to the erosion surface}

  \begin{itemize}
  \tightlist
  \item
    so erosion rate is naturally modeled as an \emph{erosion speed in
    the surface-normal direction};
  \end{itemize}
\item
  accept that the rate of motion of a surface is correctly expressed as
  a covector, aka a cotangent vector, aka a covariant rank-1 tensor,
  rather than as a tangent vector, aka a contravariant rank-1 tensor

  \begin{itemize}
  \tightlist
  \item
    so the erosion equation should in fact be written in terms of an
    \emph{erosion slowness covector oriented in the surface-normal
    direction};
  \end{itemize}
\item
  realize that by writing normal slowness as a function of local
  properties we actually have an eikonal, or static Hamilton-Jacobi
  equation

  \begin{itemize}
  \tightlist
  \item
    which means we have a geomorphic Hamiltonian.
  \end{itemize}
\end{enumerate}

    \hypertarget{derivation}{%
\section*{Derivation}\label{derivation}}

    Here I demonstrate how to derive a \emph{static} geomorphic Hamiltonian
for a general erosion equation that satisfies some simple constraints.
If we relax some of those constraints, and allow time-dependence and
non-locality, a Hamiltonian could still be derived, but it would be more
complex and likely non-classical (e.g., non-local Hamiltonians are
actually a thing, but a rare thing).

    \hypertarget{in-3-d-or-2-d}{%
\subsubsection*{In 3-D or 2-D}\label{in-3-d-or-2-d}}

    Let's define a general equation for the speed of surface erosion
\(\xi^{\perp}\) in the normal direction that is a function of the local
surface angle(s) \(\{\beta_k\}\) and position \(\mathbf{r}\):
\begin{equation}
    \xi^{\perp}(\{\beta_k\},\mathbf{r}) = f\!\left(\{\tan\beta_k\},\{r^i\}\right)
\end{equation}

Here the curly brackets \(\{\cdot\}\) mean a set of elements (indexed as
appropriate), such as the set of local angles \(\{\beta_k\}\), indexed
by \(k\in\{1,2\}\) in 3D and \(k\in\{1\}\) in 2D.

Such an erosion model encompasses the SPIM (in a surface-normal erosion
rate form), ``granular flow hillslopes'' (in the sense of Pauli \&
Gioia, 2007), and others. It assumes that nonlocal properties such as
water volume flux are spatially constant properties that can be
parameterized using \(\mathbf{r}\) alone. It disallows, for example,
changes in drainage network pattern or extent -- unless the erosion
model erosion rate is independent of drainage pattern, which is the case
for ``granular flow hillslopes''. It is essentially a static model,
which is why we can convert it into a static Hamiltonian, and can
rewrite it as an eikonal equation (a static Hamilton-Jacobi equation).

We recognize that surface erosion rate direction and magnitude are best
expressed using the surface-normal erosion \emph{slowness} covector
\(\mathbf{p}\). Surface erosion slowness is the reciprocal of surface
erosion speed, and since erosion speed scalar is obtained from the
erosion velocity vector (in Euclidean space) using the \(L_2\) norm, we
also use the \(L_2\) norm (in Euclidean space) to measure the length of
the slowness covector:

\begin{equation}
    \|\mathbf{p}\|_{L_2} = \dfrac{1}{\xi^{\perp}}
\end{equation}

We realize that trigonometric functions of local surface angles can all
be written using \(\{\tan\beta_i\}\) and that these tangent values can
be written as ratios of slowness covector components: \begin{equation}
    \tan\beta_k = p_i / p_j
    \qquad\text{for}\quad
    i \neq j, \, i<j
\end{equation}

for appropriate choices of \(i,j,k\).

Using Okubo's trick where all the surface erosion slowness covector
components are scaled by a positive factor \(\mathcal{F}_*\),
\begin{equation}
    \{p_i\} \rightarrow \left\{ \dfrac{p_i}{\mathcal{F}_*} \right\}
\end{equation}

substituted into the rate equation, the equation rearranged, and
\(\mathcal{F}_*\) equated with the fundamental function, we get
\begin{equation}
    {\mathcal{F}_*(\mathbf{p},\mathbf{r})} 
    = {\|\mathbf{p}\|_{L_2}}\,f\!\left(\left\{\dfrac{p_i}{p_j}\right\}, \{r^k\}\right)
\end{equation}

where \(\mathcal{F}_*(\mathbf{p},\mathbf{r})=1\), obviously. So we have
the eikonal equation \begin{equation}
    \|\mathbf{p}\|_{L_2} = \dfrac{1}{f\!\left(\cdot,\cdot\right)}
\end{equation}

which we could have obtained simply from the definition of
\(\|\mathbf{p}\|_{L_2}\) (eqn. 2), and which is equivalent to saying
that \begin{equation}
    \text{observed surface-normal erosion slowness} = \dfrac{1}{\text{required surface-normal erosion speed}}
\end{equation}

From the fundamental function we get the generic geomorphic Hamiltonian
\begin{equation}
    \mathcal{H}(\mathbf{p},\mathbf{r}) 
    := \dfrac{1}{2}\|\mathbf{p}\|_{L_2}^2 \, f^2\!\left(\left\{\dfrac{p_i}{p_j}\right\}, \{r^k\}\right)
    = \dfrac{1}{2}
\end{equation}

Given how the Hamiltonian \(\mathcal{H}\) is constructed from
\(\mathcal{F}_*\), which was obtained by the Okubo substitution, it is
inevitable that \(\mathcal{H}\) is Euler order-2 homogeneous in
\(\mathbf{p}\): \begin{align}
    \mathcal{H}(\lambda\mathbf{p},\mathbf{r}) 
    &= \dfrac{1}{2}\|\lambda\mathbf{p}\|_{L_2}^2 \, f^2\!\left(\left\{\dfrac{\lambda p_i}{\lambda p_j}\right\}, \{r^k\}\right) \\
    &= \dfrac{1}{2}\lambda^2 \|\mathbf{p}\|_{L_2}^2 \, f^2\!\left(\left\{\dfrac{p_i}{p_j}\right\}, \{r^k\}\right) \\
    &= \lambda^2 \mathcal{H}(\mathbf{p},\mathbf{r}) 
\end{align}

This order-2 homogeneity is \emph{EXTREMELY IMPORTANT} because it's
essentially the origin of all the interesting behaviour of the
geomorphic Hamiltonian, such as the close correspondence with geometric
optics, the conjugacy of slowness covector and velocity vector
\(\mathbf{p}(\mathbf{v})=1\), the amazing utility of the (semi-)metric
tensor \(g\), the parametric form of the geomorphic Lagrangian, the
geodesic equation form of the Euler-Lagrange equations, and the
consequent geodesic spray.

Hamilton's equations are given in the usual way: \begin{align}
    v^i = \dot{r}^i 
    &= \dfrac{\mathrm{d}r^i}{\mathrm{d}t} 
    = \dfrac{\partial{\mathcal{H}}}{\partial{p_i}} \\
    \dot{p}_i 
    &= \dfrac{\mathrm{d}p_i}{\mathrm{d}t} 
    = -\dfrac{\partial{\mathcal{H}}}{\partial{r^i}}
\end{align}

    \hypertarget{simpler-treatment-in-2d-vertical-section}{%
\subsubsection*{Simpler treatment in 2D (vertical
section)}\label{simpler-treatment-in-2d-vertical-section}}

    The above explanation is a bit abstract, so to make it more concrete
here it is for 2D. Using the same coordinates \(x\)-\(z\) as Stark \&
Stark (2022), and having only one local angle to worry about
(\(\beta\)), we write the erosion equation as:

\begin{equation}
    \xi^{\perp}\!\left(\beta, \mathbf{r}\right) = f\!\left(\tan\beta, r^x, r^z\right)
\end{equation}

We could just write the eikonal equation directly, given the definition
of the surface-normal erosion slowness covector \(\mathbf{p}\):
\begin{equation}
    \|\mathbf{p}\|_{L_2}= \dfrac{1}{f\!\left(\tan\beta, \mathbf{r}\right)}
\end{equation}

or we can use the Okubo trick to obtain the fundamental function
\begin{equation}
    {\mathcal{F}_*(\mathbf{p},\mathbf{r})}
    = {\sqrt{p_x^2+p_z^2}} \,f\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right)
\end{equation}

where we know that \(\mathcal{F}_*(\mathbf{p},\mathbf{r})=1\). The
generic 2D geomorphic Hamiltonian is then defined as (half) the square
of \(\mathcal{F}_*\): \begin{equation}
    \mathcal{H}(\mathbf{p},\mathbf{r})
     := \dfrac{1}{2}\left(p_x^2+p_z^2\right) \, f^2\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right)
     = \dfrac{1}{2}
\end{equation}

Euler order-2 homogeneity for \(\mathcal{H}\) is inevitable given the
manner in which \(\mathcal{F}_*\) was obtained \begin{align}
    \mathcal{H}(\lambda\mathbf{p},\mathbf{r}) 
    &= \dfrac{1}{2}(\lambda^2 p_x^2+\lambda^2 p_z^2) \, f^2\!\left(\dfrac{\lambda p_x}{\lambda p_z}, r^x, r^z\right) \\
    &= \dfrac{1}{2}\lambda^2 (p_x^2+p_z^2) \, f^2\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) \\
    &= \lambda^2 \mathcal{H}(\mathbf{p},\mathbf{r}) 
\end{align}

Hamilton's equations are then:

\begin{align}
    v^x 
    = \dfrac{\mathrm{d}r^x}{\mathrm{d}t} 
    & = \dfrac{\partial{\mathcal{H}}}{\partial{p_x}}
    = 2 p_x f^2\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) 
    + \left(p_x^2+p_z^2\right) f\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) \dfrac{\partial{f}}{\partial{p_x}} \\
    v^z 
    = \dfrac{\mathrm{d}r^z}{\mathrm{d}t} 
    & = \dfrac{\partial{\mathcal{H}}}{\partial{p_z}}
    = 2 p_z f^2\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) 
    + \left(p_x^2+p_z^2\right) f\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) \dfrac{\partial{f}}{\partial{p_z}} \\
    \dfrac{\mathrm{d}p_x}{\mathrm{d}t} 
    & 
    = -\dfrac{\partial{\mathcal{H}}}{\partial{r^x}}
    = - \left(p_x^2+p_z^2\right) \, f\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) \dfrac{\partial{f}}{\partial{r^x}} \\
    \dfrac{\mathrm{d}p_z}{\mathrm{d}t} 
    & 
    = -\dfrac{\partial{\mathcal{H}}}{\partial{r^z}}
    = - \left(p_x^2+p_z^2\right) \, f\!\left(\dfrac{p_x}{p_z}, r^x, r^z\right) \dfrac{\partial{f}}{\partial{r^z}} 
\end{align}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
