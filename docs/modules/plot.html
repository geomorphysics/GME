<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>plot.py &#8212; GME 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Jupyter notebooks" href="Notebooks.html" />
    <link rel="prev" title="ode_knickpoints.py" href="ode_knickpoints.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    

  </head><body>
    <!-- <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="../index.html">GME 1.0 documentation</a> &#187;</li>
          <li><a href="Python.html" accesskey="U">Python package <cite>gme</cite></a> &#187;</li> 
      </ul>
    </div> -->
    <!-- 
        <div class="badge">
            <a href="https://github.com/cstarkjp/GME/">Fork me on GitHub</a>
            <img src="../_static/right-red@2x.png">
        </div>
     -->
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-gme.plot">
<span id="plot-py"></span><h1><code class="docutils literal notranslate"><span class="pre">plot.py</span></code><a class="headerlink" href="#module-gme.plot" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Visualization.</p>
<p>Provides classes to generate a range of graphics for GME visualization.
A base class extends <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase" title="(in GMPLib v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gmplib.plot_utils.GraphingBase</span></code></a> provided by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/index.html" title="(in GMPLib v1.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">GMPLib</span></code></a>;
the other classes build on this.
Each is tailored to a particular category of GME problem,
such as single ray tracing or for tracking knickpoints.</p>
<hr class="docutils" />
<dl class="simple">
<dt>Requires Python packages/modules:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html" title="(in GMPLib v1.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gmplib.plot_utils</span></code></a></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.21)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.sympy.org/latest/modules/index.html#module-sympy" title="(in SymPy v1.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" title="(in Matplotlib v3.4.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/ticker_api.html#module-matplotlib.ticker" title="(in Matplotlib v3.4.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.ticker</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/patches_api.html#module-matplotlib.patches" title="(in Matplotlib v3.4.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.patches</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/api/toolkits/axes_grid1.html#module-mpl_toolkits.axes_grid1" title="(in Matplotlib v3.4.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mpl_toolkits.axes_grid1</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>Imports symbols from <a class="reference internal" href="symbols.html#module-gme.symbols" title="gme.symbols"><code class="xref py py-mod docutils literal notranslate"><span class="pre">symbols</span></code></a> module.</p>
<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.Graphing">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">Graphing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.Graphing" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase" title="(in GMPLib v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gmplib.plot_utils.GraphingBase</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.Graphing.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.Graphing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – resolution for rasterized images</p></li>
<li><p><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – general font size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.Graphing.arrow_annotate_ray_custom">
<span class="sig-name descname"><span class="pre">arrow_annotate_ray_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rx_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rz_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_ray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_ray_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dashed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_smooth_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.Graphing.arrow_annotate_ray_custom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add arrowheads to a ray trajectory to visualize the direction of motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rx_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – x coordinates along the sampled ray</p></li>
<li><p><strong>rz_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – z coordinates along the sampled ray</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">axes</span></code></a>) – ‘axes’ instance for current figure</p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>i_ray</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – index of this ray among the set currently being plotted</p></li>
<li><p><strong>i_ray_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – ray index step, used as divisor when assigning a color to match the parent ray color</p></li>
<li><p><strong>n_arrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of arrows to plot along the ray</p></li>
<li><p><strong>arrow_sf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional scale factor for arrowhead size</p></li>
<li><p><strong>arrow_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional offset from ray initial point to start adding arrowheads</p></li>
<li><p><strong>x_limits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – optional horizontal axis range</p></li>
<li><p><strong>y_limits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – optional vertical axis range</p></li>
<li><p><strong>line_style</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional line style</p></li>
<li><p><strong>line_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional line width</p></li>
<li><p><strong>ray_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional ray label for legend</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.Graphing.correct_quadrant">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">correct_quadrant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.Graphing.correct_quadrant" title="Permalink to this definition">¶</a></dt>
<dd><p>If angle <span class="math notranslate nohighlight">\(|\theta|\approx 0\)</span>, set <span class="math notranslate nohighlight">\(\theta=0\)</span>;
otherwise, if angle <span class="math notranslate nohighlight">\(\theta&lt;0\)</span>, map <span class="math notranslate nohighlight">\(\theta \rightarrow \pi-\theta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – angle in radians</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Modified value of angle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.Graphing.draw_rays_with_arrows_simple">
<span class="sig-name descname"><span class="pre">draw_rays_with_arrows_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rx_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rz_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_one_ray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.Graphing.draw_rays_with_arrows_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ray and arrowheads along the ray to visualize the direction of motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">axes</span></code></a>) – ‘axes’ instance for current figure</p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>t_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – sample times along the ray</p></li>
<li><p><strong>rx_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – x coordinates along the sampled ray</p></li>
<li><p><strong>rz_array</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – z coordinates along the sampled ray</p></li>
<li><p><strong>ls</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional line style</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.ManuscriptPlots">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">ManuscriptPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.ManuscriptPlots" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gme.plot.ManuscriptPlots.covector_isochrones">
<span class="sig-name descname"><span class="pre">covector_isochrones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.ManuscriptPlots.covector_isochrones" title="Permalink to this definition">¶</a></dt>
<dd><p>Schematic illustrating relationship between normal erosion rate vector, normal slowness covector,
isochrones, covector components, and vertical/normal erosion rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.ManuscriptPlots.huygens_wavelets">
<span class="sig-name descname"><span class="pre">huygens_wavelets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_ray_conjugacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.ManuscriptPlots.huygens_wavelets" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the loci of <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> and
their behavior defined by <span class="math notranslate nohighlight">\(F\)</span> relative to the <span class="math notranslate nohighlight">\(\xi\)</span> circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>do_ray_conjugacy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional generate ray conjugacy schematic?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">OneRayPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.alpha_beta">
<span class="sig-name descname"><span class="pre">alpha_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.88,</span> <span class="pre">0.7]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.alpha_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ray vector angle <span class="math notranslate nohighlight">\(\alpha\)</span> versus normal-slowness covector angle <span class="math notranslate nohighlight">\(\beta\)</span>
generated by a time-invariant solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional sample rate along each curve</p></li>
<li><p><strong>x_limits</strong> (<em>list of float</em>) – optional [x_min, x_max] horizontal plot range</p></li>
<li><p><strong>y_limits</strong> (<em>list of float</em>) – optional [z_min, z_max] vertical plot range</p></li>
<li><p><strong>do_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot legend?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.angular_disparity">
<span class="sig-name descname"><span class="pre">angular_disparity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.88,</span> <span class="pre">0.7]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.angular_disparity" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ray vector angular disparity <span class="math notranslate nohighlight">\(\alpha-\beta\)</span>
generated by a time-invariant solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional sample rate along each curve</p></li>
<li><p><strong>x_limits</strong> (<em>list of float</em>) – optional [x_min, x_max] horizontal plot range</p></li>
<li><p><strong>y_limits</strong> (<em>list of float</em>) – optional [z_min, z_max] vertical plot range</p></li>
<li><p><strong>do_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot legend?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_alpha">
<span class="sig-name descname"><span class="pre">profile_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot ray vector angle <span class="math notranslate nohighlight">\(\alpha\)</span> along a time-invariant profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional sample rate along each curve</p></li>
<li><p><strong>do_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot legend?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_angular_disparity">
<span class="sig-name descname"><span class="pre">profile_angular_disparity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'(b)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.6,</span> <span class="pre">0.35]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_angular_disparity" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot horizontal erosion speed <span class="math notranslate nohighlight">\(\xi^{\rightarrow}\)</span> along a time-invariant profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_g_properties">
<span class="sig-name descname"><span class="pre">profile_g_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">121</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_gstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_det</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_label_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower</span> <span class="pre">left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mod_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_recompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_g_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot velocity <span class="math notranslate nohighlight">\(\dot{r}\)</span> along a ray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_h_ray">
<span class="sig-name descname"><span class="pre">profile_h_ray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_eta_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_subsetting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_schematic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_t_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.15,</span> <span class="pre">0.5]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_h_ray" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a set of erosion rays for a time-invariant topographic profile solution of Hamilton’s equations.</p>
<p>Hamilton’s equations are integrated once (from the left boundary to the divide)
and a time-invariant profile is constructed by repeating
the ray trajectory, with a suitable truncation and vertical initial offset, multiple times at the left boundary:
the set of end of truncated rays constitutes the ‘steady-state’ topographic profile.
The point of truncation of each trajectory corresponds to the effective time lag imposed by the choice of vertical initial
offset (which is controlled by the vertical slip rate).</p>
<p>Visualization of this profile includes: (i) plotting a subsampling of the terminated points of the ray truncations;
(ii) plotting a continuous curve generated by integrating the surface gradient implied by the erosion-front normal
covector values <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> values generated by solving Hamilton’s equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>do_direct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot directly integrated ray trajectory (from <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> values) as a solid curve</p></li>
<li><p><strong>ray_subsetting</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional ray subsampling rate (typically far more rays are computed than should be plotted)</p></li>
<li><p><strong>do_schematic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally plot in more schematic form for expository purposes?</p></li>
<li><p><strong>do_simple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally simplify?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_h_rays">
<span class="sig-name descname"><span class="pre">profile_h_rays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_eta_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_subsetting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_schematic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_one_ray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_t_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.93,</span> <span class="pre">0.33]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_h_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a set of erosion rays for a time-invariant topographic profile solution of Hamilton’s equations.</p>
<p>Hamilton’s equations are integrated once (from the left boundary to the divide)
and a time-invariant profile is constructed by repeating
the ray trajectory, with a suitable truncation and vertical initial offset, multiple times at the left boundary:
the set of end of truncated rays constitutes the ‘steady-state’ topographic profile.
The point of truncation of each trajectory corresponds to the effective time lag imposed by the choice of vertical initial
offset (which is controlled by the vertical slip rate).</p>
<p>Visualization of this profile includes: (i) plotting a subsampling of the terminated points of the ray truncations;
(ii) plotting a continuous curve generated by integrating the surface gradient implied by the erosion-front normal
covector values <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> values generated by solving Hamilton’s equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>do_direct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot directly integrated ray trajectory (from <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> values) as a solid curve</p></li>
<li><p><strong>ray_subsetting</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional ray subsampling rate (typically far more rays are computed than should be plotted)</p></li>
<li><p><strong>do_schematic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally plot in more schematic form for expository purposes?</p></li>
<li><p><strong>do_simple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally simplify?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_v">
<span class="sig-name descname"><span class="pre">profile_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mod_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_v" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot velocity <span class="math notranslate nohighlight">\(\dot{r}\)</span> along a ray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.OneRayPlots.profile_vdot">
<span class="sig-name descname"><span class="pre">profile_vdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mod_vdot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_geodesic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.OneRayPlots.profile_vdot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot acceleration <span class="math notranslate nohighlight">\(\ddot{r}\)</span> along a ray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.OneRaySolution" title="gme.ode_raytracing.OneRaySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneRaySolution</span></code></a>) – instance of single ray solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.TheoryPlots">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">TheoryPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TheoryPlots" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TheoryPlots.comparison_logpolar">
<span class="sig-name descname"><span class="pre">comparison_logpolar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varphi_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idtx_pz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idtx_pz_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fgtx_pz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fgtx_pz_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TheoryPlots.comparison_logpolar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot both indicatrix and figuratrix on one log-polar graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TheoryPlots.relative_geometry">
<span class="sig-name descname"><span class="pre">relative_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varphi_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_annotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_text_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_lines_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_varphi_circle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_ray_slowness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TheoryPlots.relative_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the loci of <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> and
their behavior defined by <span class="math notranslate nohighlight">\(F\)</span> relative to the <span class="math notranslate nohighlight">\(\xi\)</span> circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>varphi_choice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the value of <span class="math notranslate nohighlight">\(\varphi\)</span> to use</p></li>
<li><p><strong>zoom_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – fractional zoom factor relative to preassigned graph limits</p></li>
<li><p><strong>do_half</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot only for <span class="math notranslate nohighlight">\(x\geq0\)</span>?</p></li>
<li><p><strong>do_annotations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot annotated arcs, faster/slower arrows?</p></li>
<li><p><strong>do_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – display the legend?</p></li>
<li><p><strong>do_text_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – display text annotations?</p></li>
<li><p><strong>do_arrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – display vector/covector arrows?</p></li>
<li><p><strong>do_lines_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – display dashed/dotted tangent lines etc?</p></li>
<li><p><strong>do_shapes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot key points using polygon symbols rather than simple circles</p></li>
<li><p><strong>do_varphi_circle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot the <span class="math notranslate nohighlight">\(\xi\)</span> (typically unit) circle?</p></li>
<li><p><strong>do_pz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – plot horizontal dotted line indicating magnitude of <span class="math notranslate nohighlight">\(p_z\)</span></p></li>
<li><p><strong>do_ray_slowness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – invert ray speed (but keep ray direction) in indicatrix?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.TimeDependentPlots">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">TimeDependentPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeDependentPlots" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeDependentPlots.profile_cusp_speed">
<span class="sig-name descname"><span class="pre">profile_cusp_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">0.05,</span> <span class="pre">1.05]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">5,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_infer_initiation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeDependentPlots.profile_cusp_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot horizontal speed of cusp propagation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.VelocityBoundarySolution" title="gme.ode_raytracing.VelocityBoundarySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">VelocityBoundarySolution</span></code></a>) – instance of velocity boundary solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sample_spacing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample interval between cusps over which to compute the speed</p></li>
<li><p><strong>x_limits</strong> (<em>list of float</em>) – optional [x_min, x_max] horizontal plot range</p></li>
<li><p><strong>y_limits</strong> (<em>list of float</em>) – optional [z_min, z_max] vertical plot range</p></li>
<li><p><strong>do_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot x-axis as dimensionless horizontal distance <span class="math notranslate nohighlight">\(x/x_1\)</span>;
otherwise plot as time <span class="math notranslate nohighlight">\(t\)</span></p></li>
<li><p><strong>do_infer_initiation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional draw dotted line inferring cusp initiation at the left boundary</p></li>
</ul>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>implement <cite>do_infer_initiation</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeDependentPlots.profile_isochrones">
<span class="sig-name descname"><span class="pre">profile_isochrones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_zero_isochrone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_subsetting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_isochrones</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isochrone_subsetting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_isochrone_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isochrone_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isochrone_ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isochrone_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'isochrone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_annotate_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_annotate_cusps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cusp_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_smooth_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.001,</span> <span class="pre">1.001)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.025,</span> <span class="pre">0.525)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_alt_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_infer_initiation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">0.92]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeDependentPlots.profile_isochrones" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot xxxx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.VelocityBoundarySolution" title="gme.ode_raytracing.VelocityBoundarySolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">VelocityBoundarySolution</span></code></a>) – instance of velocity boundary solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>do_zero_isochrone</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot initial surface?</p></li>
<li><p><strong>do_rays</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot rays?</p></li>
<li><p><strong>ray_subsetting</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional rate of ray subsetting</p></li>
<li><p><strong>ray_lw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional ray line width</p></li>
<li><p><strong>ray_ls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional ray line style</p></li>
<li><p><strong>ray_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional ray line label</p></li>
<li><p><strong>do_isochrones</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot isochrones?</p></li>
<li><p><strong>isochrone_subsetting</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional rate of isochrone subsetting</p></li>
<li><p><strong>do_isochrone_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot isochrone herringbones?</p></li>
<li><p><strong>isochrone_lw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional isochrone line width</p></li>
<li><p><strong>isochrone_ls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional isochrone line style</p></li>
<li><p><strong>isochrone_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional isochrone line label</p></li>
<li><p><strong>do_annotate_rays</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot arrowheads along rays?</p></li>
<li><p><strong>n_arrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional number of arrowheads to annotate along rays or cusp-line</p></li>
<li><p><strong>arrow_sf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional scale factor for arrowhead sizes</p></li>
<li><p><strong>arrow_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional offset to start annotating arrowheads</p></li>
<li><p><strong>do_annotate_cusps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot line to visualize cusp initiation and propagation</p></li>
<li><p><strong>cusp_lw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional cusp propagation curve line width</p></li>
<li><p><strong>x_limits</strong> (<em>list of float</em>) – optional [x_min, x_max] horizontal plot range</p></li>
<li><p><strong>y_limits</strong> (<em>list of float</em>) – optional [z_min, z_max] vertical plot range</p></li>
<li><p><strong>aspect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional figure aspect ratio</p></li>
<li><p><strong>do_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot legend</p></li>
<li><p><strong>do_alt_legend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot slightly different legend</p></li>
<li><p><strong>do_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional plot dotted grey gridlines</p></li>
<li><p><strong>do_infer_initiation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optional draw dotted line inferring cusp initiation at the left boundary</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gme.plot.</span></span><span class="sig-name descname"><span class="pre">TimeInvariantPlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_aniso">
<span class="sig-name descname"><span class="pre">profile_aniso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_eta_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_aniso" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot time-invariant profile annotated with ray vectors, normal-slowness covector herringbones,
and colorized for anisotropy (defined as the difference <span class="math notranslate nohighlight">\((\alpha-\beta)\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>sf</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em>) – optional scale factor(s) for vertical axes (bottom and top)</p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
<li><p><strong>n_arrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> vector arrows and <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> covector herringbones to plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_beta">
<span class="sig-name descname"><span class="pre">profile_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.88,</span> <span class="pre">0.7]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>For a time-invariant (steady-state) topographic profile,
plot the surface-normal covector angle <span class="math notranslate nohighlight">\(\beta\)</span> from vertical,
aka the surface tilt angle from horizontal, as a function of
dimensionless horizontal distance <span class="math notranslate nohighlight">\(x/x_1\)</span>.</p>
<p>This angle is named and calculated in three ways:
(1) <span class="math notranslate nohighlight">\(\beta_p\)</span>: directly from the series of <span class="math notranslate nohighlight">\(\mathbf{\widetilde{p}}\)</span> values
generated by ray ODE integration, since <span class="math notranslate nohighlight">\(\tan(\beta_p)=-p_x/p_z\)</span>;
(2) <span class="math notranslate nohighlight">\(\beta_{ts}\)</span>: by differentiating the computed time-invariant
topographic profile (itself constructed from the terminations of the ensemble of
progressively truncated, identical rays);
(3) <span class="math notranslate nohighlight">\(\beta_{vt}\)</span>: from the velocity triangle
<span class="math notranslate nohighlight">\(\tan(\beta_{vt}) = \dfrac{v^z+\xi^{\perp}}{v^x}\)</span>: generated by the geometric
constraint of balancing the ray velocities with surface-normal velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_beta_error">
<span class="sig-name descname"><span class="pre">profile_beta_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_beta_error" title="Permalink to this definition">¶</a></dt>
<dd><p>For a time-invariant (steady-state) topographic profile,
plot the error in the estimated surface-normal covector angle <span class="math notranslate nohighlight">\(\beta\)</span>
as a function of dimensionless horizontal distance <span class="math notranslate nohighlight">\(x/x_1\)</span>.</p>
<p>This error, expressed as a percentage, is defined as one of the following normalized differences:
(1) <span class="math notranslate nohighlight">\(100(\beta_{ts}-\beta_{p})/\beta_{p}\)</span>, or
(2) <span class="math notranslate nohighlight">\(100(\beta_{vt}-\beta_{p})/\beta_{p}\)</span>.
The error in <span class="math notranslate nohighlight">\(\beta_{vt}\)</span> can be non-trivial for $x/x_1 rightarrow 0$ and <span class="math notranslate nohighlight">\(\eta &lt; 1\)</span>
if the number of rays used to construct the topographic profile is insufficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_flow_model">
<span class="sig-name descname"><span class="pre">profile_flow_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_subtitling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_extra_annotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_flow_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the flow component of the erosion model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional number of points to plot along curve</p></li>
<li><p><strong>subtitle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional sub-title (likely ‘ramp’ or ‘ramp-flat’ or similar)</p></li>
<li><p><strong>do_subtitling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – annotate with subtitle and eta value</p></li>
<li><p><strong>do_extra_annotations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – annotate with hillslope, channel labels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_slope_area">
<span class="sig-name descname"><span class="pre">profile_slope_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">26</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_subtitling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_extra_annotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_slope_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a log-log slope-area plot for a time-invariant topographic profile solution
of Hamilton’s equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>sub</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary of model parameter values to be used for equation substitutions</p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional number of points to plot along curve</p></li>
<li><p><strong>subtitle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – optional sub-title (likely ‘ramp’ or ‘ramp-flat’ or similar)</p></li>
<li><p><strong>x_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – optional x offset</p></li>
<li><p><strong>do_subtitling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally annotate with subtitle and eta value?</p></li>
<li><p><strong>do_extra_annotations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally annotate with hillslope, channel labels?</p></li>
<li><p><strong>do_simple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – optionally avoid hillslope-channel extras?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_xi">
<span class="sig-name descname"><span class="pre">profile_xi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'(a)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot surface-normal erosion speed <span class="math notranslate nohighlight">\(\xi^{\perp}\)</span>  along a time-invariant profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_xihorizontal">
<span class="sig-name descname"><span class="pre">profile_xihorizontal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'(d)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_xihorizontal" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot horizontal erosion speed <span class="math notranslate nohighlight">\(\xi^{\rightarrow}\)</span> along a time-invariant profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gme.plot.TimeInvariantPlots.profile_xivertical">
<span class="sig-name descname"><span class="pre">profile_xivertical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gmes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmeq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xf_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.995</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pub_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'(e)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gme.plot.TimeInvariantPlots.profile_xivertical" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot vertical erosion speed <span class="math notranslate nohighlight">\(\xi^{\downarrow}\)</span> along a time-invariant profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Matplotlib</span> <span class="pre">figure</span></code></a>) – reference to figure instantiated by <a class="reference external" href="https://cstarkjp.github.io/GMPLib/modules/plot_utils.html#gmplib.plot_utils.GraphingBase.create_figure" title="(in GMPLib v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GMPLib</span> <span class="pre">create_figure</span></code></a></p></li>
<li><p><strong>gmes</strong> (<a class="reference internal" href="ode_raytracing.html#gme.ode_raytracing.TimeInvariantSolution" title="gme.ode_raytracing.TimeInvariantSolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInvariantSolution</span></code></a>) – instance of time invariant solution class defined in <a class="reference internal" href="ode_raytracing.html#module-gme.ode_raytracing" title="gme.ode_raytracing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ode_raytracing</span></code></a></p></li>
<li><p><strong>gmeq</strong> (<a class="reference internal" href="equations.html#gme.equations.Equations" title="gme.equations.Equations"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equations</span></code></a>) – GME model equations class instance defined in <a class="reference internal" href="equations.html#module-gme.equations" title="gme.equations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">equations</span></code></a></p></li>
<li><p><strong>n_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – sample rate along each curve</p></li>
<li><p><strong>y_limits</strong> (<em>list of float</em>) – optional [z_min, z_max] vertical plot range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">Visualization.</span>

<span class="sd">Provides classes to generate a range of graphics for GME visualization.</span>
<span class="sd">A base class extends :class:`gmplib.plot_utils.GraphingBase &lt;plot_utils.GraphingBase&gt;` provided by :mod:`GMPLib`;</span>
<span class="sd">the other classes build on this.</span>
<span class="sd">Each is tailored to a particular category of GME problem,</span>
<span class="sd">such as single ray tracing or for tracking knickpoints.</span>

<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">Requires Python packages/modules:</span>
<span class="sd">  -  :mod:`gmplib.plot_utils &lt;plot_utils&gt;`</span>
<span class="sd">  -  :mod:`numpy`</span>
<span class="sd">  -  :mod:`sympy`</span>
<span class="sd">  -  :mod:`matplotlib.pyplot`</span>
<span class="sd">  -  :mod:`matplotlib.ticker`</span>
<span class="sd">  -  :mod:`matplotlib.patches`</span>
<span class="sd">  -  :mod:`mpl_toolkits.axes_grid1`</span>

<span class="sd">Imports symbols from :mod:`.symbols` module.</span>

<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">gmplib.plot_utils</span> <span class="kn">import</span> <span class="n">GraphingBase</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">Abs</span><span class="p">,</span> <span class="n">lambdify</span>
<span class="kn">from</span> <span class="nn">gme.symbols</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eig</span><span class="p">,</span> <span class="n">eigh</span><span class="p">,</span> <span class="n">det</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FormatStrFormatter</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span><span class="p">,</span> <span class="n">FancyArrow</span><span class="p">,</span> <span class="n">FancyArrowPatch</span><span class="p">,</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">RegularPolygon</span>
<span class="kn">from</span> <span class="nn">matplotlib.legend_handler</span> <span class="kn">import</span> <span class="n">HandlerPatch</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Graphing&#39;</span><span class="p">,</span> <span class="s1">&#39;OneRayPlots&#39;</span><span class="p">,</span> <span class="s1">&#39;TimeInvariantPlots&#39;</span><span class="p">,</span>
           <span class="s1">&#39;TimeDependentPlots&#39;</span><span class="p">,</span> <span class="s1">&#39;TheoryPlots&#39;</span><span class="p">,</span> <span class="s1">&#39;ManuscriptPlots&#39;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Graphing</span><span class="p">(</span><span class="n">GraphingBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclasses :class:`gmplib.plot_utils.GraphingBase &lt;plot_utils.GraphingBase&gt;`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor method.</span>

<span class="sd">        Args:</span>
<span class="sd">            dpi (int): resolution for rasterized images</span>
<span class="sd">            font_size (int): general font size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dpi</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mycolors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">do_smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap_choice</span><span class="o">=</span><span class="s1">&#39;brg&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_smooth</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[(</span><span class="n">i</span><span class="o">//</span><span class="n">r</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">n_colors</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_choice</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">gray_color</span><span class="p">(</span><span class="n">i_isochrone</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">n_isochrones</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i_isochrone</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_isochrones</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.75</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">correct_quadrant</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If angle :math:`|\theta|\approx 0`, set :math:`\theta=0`;</span>
<span class="sd">        otherwise, if angle :math:`\theta&lt;0`, map :math:`\theta \rightarrow \pi-\theta`.</span>

<span class="sd">        Args:</span>
<span class="sd">            angle (float): angle in radians</span>

<span class="sd">        Returns:</span>
<span class="sd">            Modified value of angle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">&lt;=</span><span class="mf">1e-10</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">angle</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">angle</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="n">angle</span>

    <span class="k">def</span> <span class="nf">draw_rays_with_arrows_simple</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">t_array</span><span class="p">,</span> <span class="n">rx_array</span><span class="p">,</span> <span class="n">rz_array</span><span class="p">,</span> <span class="n">v_array</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_one_ray</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot ray and arrowheads along the ray to visualize the direction of motion.</span>

<span class="sd">        Args:</span>
<span class="sd">            axes (:class:`Matplotlib axes &lt;matplotlib.axes.Axes&gt;`): &#39;axes&#39; instance for current figure</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            t_array (numpy.ndarray): sample times along the ray</span>
<span class="sd">            rx_array (numpy.ndarray): x coordinates along the sampled ray</span>
<span class="sd">            rz_array (numpy.ndarray): z coordinates along the sampled ray</span>
<span class="sd">            ls (str): optional line style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i_max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span> <span class="c1">#if i_max is None else i_max</span>
        <span class="n">i_step</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">i_off</span> <span class="o">=</span> <span class="n">i_step</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i_max</span><span class="o">//</span><span class="n">i_step</span><span class="p">)</span><span class="o">-</span><span class="n">i_max</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">my_arrow_style</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">ArrowStyle</span><span class="o">.</span><span class="n">Fancy</span><span class="p">(</span><span class="n">head_length</span><span class="o">=.</span><span class="mi">99</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=.</span><span class="mi">6</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                                                   <span class="n">tail_width</span><span class="o">=</span><span class="mf">0.01</span><span class="o">*</span><span class="n">sf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v_max</span><span class="p">,</span> <span class="n">v_min</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">v_array</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">v_array</span><span class="p">)</span>
            <span class="n">color_map</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i_max</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">color</span> <span class="k">if</span> <span class="n">do_one_ray</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[(</span><span class="n">i</span><span class="o">//</span><span class="n">i_step</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">n_colors</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i_off</span><span class="p">)</span><span class="o">//</span><span class="n">i_step</span><span class="o">==</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i_off</span><span class="p">)</span><span class="o">/</span><span class="n">i_step</span><span class="p">:</span>
                <span class="n">t_offset</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">do_one_ray</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">t_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">xiv_0</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)))</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">rx_array</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">rz_array</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t_offset</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$t_0=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i_max</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">do_labels</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i_off</span><span class="p">)</span><span class="o">//</span><span class="n">i_step</span><span class="o">==</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">i_off</span><span class="p">)</span><span class="o">/</span><span class="n">i_step</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">do_one_ray</span><span class="p">:</span>
                        <span class="n">v_rel</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">v_array</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">-</span><span class="n">v_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v_max</span><span class="o">-</span><span class="n">v_min</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                        <span class="n">rgba</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">(</span><span class="n">v_rel</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rgba</span> <span class="o">=</span> <span class="n">color</span>
                    <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">((</span><span class="n">rx_array</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]),(</span><span class="n">rz_array</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t_offset</span><span class="p">)),</span>
                                      <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">rx_array</span><span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="n">rz_array</span><span class="p">[</span><span class="n">q</span><span class="p">]</span><span class="o">-</span><span class="n">t_offset</span><span class="p">),</span>
                                  <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">rgba</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">v_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color_map</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">color_map</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tick_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$v_\mathrm</span><span class="si">{min}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$v_\mathrm</span><span class="si">{max}</span><span class="s1">$&#39;</span><span class="p">]):</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">idx</span><span class="o">*</span><span class="mf">1.3</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">tick_label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
            <span class="c1"># cbar.ax.get_yaxis().labelpad = -100</span>
            <span class="c1"># cbar.ax.set_ylabel(r&#39;ray speed  $v$&#39;, rotation=90)</span>

    <span class="k">def</span> <span class="nf">arrow_annotate_ray_custom</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">rx_array</span><span class="p">,</span> <span class="n">rz_array</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">i_ray</span><span class="p">,</span> <span class="n">i_ray_step</span><span class="p">,</span> <span class="n">n_rays</span><span class="p">,</span> <span class="n">n_arrows</span><span class="p">,</span>
                                   <span class="n">arrow_sf</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">arrow_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">line_style</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ray_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_smooth_colors</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add arrowheads to a ray trajectory to visualize the direction of motion.</span>

<span class="sd">        Args:</span>
<span class="sd">            rx_array (numpy.ndarray): x coordinates along the sampled ray</span>
<span class="sd">            rz_array (numpy.ndarray): z coordinates along the sampled ray</span>
<span class="sd">            axes (:class:`Matplotlib axes &lt;matplotlib.axes.Axes&gt;`): &#39;axes&#39; instance for current figure</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            i_ray (int): index of this ray among the set currently being plotted</span>
<span class="sd">            i_ray_step (int): ray index step, used as divisor when assigning a color to match the parent ray color</span>
<span class="sd">            n_arrows (int): number of arrows to plot along the ray</span>
<span class="sd">            arrow_sf (float): optional scale factor for arrowhead size</span>
<span class="sd">            arrow_offset (int): optional offset from ray initial point to start adding arrowheads</span>
<span class="sd">            x_limits (list): optional horizontal axis range</span>
<span class="sd">            y_limits (list): optional vertical axis range</span>
<span class="sd">            line_style (str): optional line style</span>
<span class="sd">            line_width (str): optional line width</span>
<span class="sd">            ray_label (str): optional ray label for legend</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Drop repeated points on vb</span>
        <span class="n">rxz_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">rx_array</span><span class="p">,</span><span class="n">rz_array</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
        <span class="n">n_pts</span> <span class="o">=</span> <span class="n">rxz_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">my_arrow_style</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">ArrowStyle</span><span class="o">.</span><span class="n">Fancy</span><span class="p">(</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.99</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.6</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">,</span>
                                                   <span class="n">tail_width</span><span class="o">=</span><span class="mf">0.01</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">)</span>
        <span class="c1"># color = self.colors[(i_ray//i_ray_step)%self.n_colors]</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mycolors</span><span class="p">(</span><span class="n">i_ray</span><span class="p">,</span> <span class="n">i_ray_step</span><span class="p">,</span> <span class="n">n_rays</span><span class="p">,</span> <span class="n">do_smooth</span><span class="o">=</span><span class="n">do_smooth_colors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_pts</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pts</span><span class="o">//</span><span class="p">(</span><span class="n">n_arrows</span><span class="p">)</span><span class="o">//</span><span class="n">arrow_offset</span><span class="o">+</span><span class="n">n_pts</span><span class="o">//</span><span class="p">(</span><span class="n">n_arrows</span><span class="p">),</span> <span class="n">n_pts</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_pts</span><span class="o">//</span><span class="p">(</span><span class="n">n_arrows</span><span class="p">)):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">y_limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                        <span class="p">(</span> <span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span>
                          <span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">&gt;</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">&lt;</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">))</span> \
                    <span class="ow">and</span> \
                    <span class="p">(</span><span class="n">x_limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                            <span class="p">(</span> <span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span>
                              <span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">&gt;</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">&lt;</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span> <span class="p">):</span>
                    <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">((</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]),(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">])),</span>
                                  <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">q</span><span class="p">],</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">q</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="p">),</span>
                                  <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rxz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">line_style</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ray_label</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">OneRayPlots</span><span class="p">(</span><span class="n">Graphing</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">profile_h_ray</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ray_eta_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                        <span class="n">do_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ray_subsetting</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">do_schematic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">do_simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_t_sampling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.50</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a set of erosion rays for a time-invariant topographic profile solution of Hamilton&#39;s equations.</span>

<span class="sd">        Hamilton&#39;s equations are integrated once (from the left boundary to the divide)</span>
<span class="sd">        and a time-invariant profile is constructed by repeating</span>
<span class="sd">        the ray trajectory, with a suitable truncation and vertical initial offset, multiple times at the left boundary:</span>
<span class="sd">        the set of end of truncated rays constitutes the &#39;steady-state&#39; topographic profile.</span>
<span class="sd">        The point of truncation of each trajectory corresponds to the effective time lag imposed by the choice of vertical initial</span>
<span class="sd">        offset (which is controlled by the vertical slip rate).</span>

<span class="sd">        Visualization of this profile includes: (i) plotting a subsampling of the terminated points of the ray truncations;</span>
<span class="sd">        (ii) plotting a continuous curve generated by integrating the surface gradient implied by the erosion-front normal</span>
<span class="sd">        covector values :math:`\mathbf{\widetilde{p}}` values generated by solving Hamilton&#39;s equations.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            do_direct (bool): plot directly integrated ray trajectory (from :math:`\mathbf{\widetilde{p}}` values) as a solid curve</span>
<span class="sd">            ray_subsetting (int): optional ray subsampling rate (typically far more rays are computed than should be plotted)</span>
<span class="sd">            do_schematic (bool):</span>
<span class="sd">                optionally plot in more schematic form for expository purposes?</span>
<span class="sd">            do_simple (bool): optionally simplify?</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">t_array</span>  <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_array</span>
        <span class="c1"># rx_array = gmes.rx_array</span>
        <span class="c1"># rz_array = gmes.rz_array</span>
        <span class="c1"># v_array = n.sqrt(gmes.rdotx_array**2 + gmes.rdotz_array**2)</span>

        <span class="k">if</span> <span class="n">do_t_sampling</span><span class="p">:</span>
            <span class="n">t_begin</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t_rsmpld_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_begin</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_rsmpld_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">t_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_interp_x</span><span class="p">(</span><span class="n">x_rsmpld_array</span><span class="p">)</span>
        <span class="n">rx_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rx_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span>
        <span class="n">rz_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rz_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span>
        <span class="n">v_rsmpld_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">rdotx_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                                <span class="o">+</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotz_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Plot arrow-annotated rays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rays_with_arrows_simple</span><span class="p">(</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span>
                                          <span class="n">t_rsmpld_array</span><span class="p">,</span> <span class="n">rx_rsmpld_array</span><span class="p">,</span> <span class="n">rz_rsmpld_array</span><span class="p">,</span> <span class="n">v_rsmpld_array</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">do_one_ray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span> <span class="p">)</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation, $z/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ray_eta_xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ray_eta_xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.92</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_schematic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">ray_eta_xy</span><span class="p">,</span> <span class="sa">rf</span><span class="s1">&#39;$\eta=</span><span class="si">{</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_h_rays</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ray_eta_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                        <span class="n">do_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ray_subsetting</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">do_schematic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">do_simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_one_ray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_t_sampling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.93</span><span class="p">,</span><span class="mf">0.33</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a set of erosion rays for a time-invariant topographic profile solution of Hamilton&#39;s equations.</span>

<span class="sd">        Hamilton&#39;s equations are integrated once (from the left boundary to the divide)</span>
<span class="sd">        and a time-invariant profile is constructed by repeating</span>
<span class="sd">        the ray trajectory, with a suitable truncation and vertical initial offset, multiple times at the left boundary:</span>
<span class="sd">        the set of end of truncated rays constitutes the &#39;steady-state&#39; topographic profile.</span>
<span class="sd">        The point of truncation of each trajectory corresponds to the effective time lag imposed by the choice of vertical initial</span>
<span class="sd">        offset (which is controlled by the vertical slip rate).</span>

<span class="sd">        Visualization of this profile includes: (i) plotting a subsampling of the terminated points of the ray truncations;</span>
<span class="sd">        (ii) plotting a continuous curve generated by integrating the surface gradient implied by the erosion-front normal</span>
<span class="sd">        covector values :math:`\mathbf{\widetilde{p}}` values generated by solving Hamilton&#39;s equations.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            do_direct (bool): plot directly integrated ray trajectory (from :math:`\mathbf{\widetilde{p}}` values) as a solid curve</span>
<span class="sd">            ray_subsetting (int): optional ray subsampling rate (typically far more rays are computed than should be plotted)</span>
<span class="sd">            do_schematic (bool):</span>
<span class="sd">                optionally plot in more schematic form for expository purposes?</span>
<span class="sd">            do_simple (bool): optionally simplify?</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">t_array</span>  <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_array</span><span class="p">[::</span><span class="n">ray_subsetting</span><span class="p">]</span>
        <span class="n">rx_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rx_array</span><span class="p">[::</span><span class="n">ray_subsetting</span><span class="p">]</span>
        <span class="n">rz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rz_array</span><span class="p">[::</span><span class="n">ray_subsetting</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">do_t_sampling</span><span class="p">:</span>
            <span class="n">t_begin</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t_rsmpld_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_begin</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_rsmpld_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">t_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_interp_x</span><span class="p">(</span><span class="n">x_rsmpld_array</span><span class="p">)</span>
        <span class="n">rx_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rx_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span>
        <span class="n">rz_rsmpld_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rz_interp_t</span><span class="p">(</span><span class="n">t_rsmpld_array</span><span class="p">)</span>

        <span class="c1"># Plot arrow-annotated rays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rays_with_arrows_simple</span><span class="p">(</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span>
                                           <span class="n">t_rsmpld_array</span><span class="p">,</span> <span class="n">rx_rsmpld_array</span><span class="p">,</span> <span class="n">rz_rsmpld_array</span><span class="p">,</span>
                                           <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                           <span class="n">sf</span><span class="o">=</span><span class="mf">0.5</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span> <span class="n">do_one_ray</span><span class="o">=</span><span class="n">do_one_ray</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">do_schematic</span><span class="p">:</span>
            <span class="c1"># For schematic fig, also plot mirror-image topo profile on opposite side of drainage divide</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_rays_with_arrows_simple</span><span class="p">(</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span>
                                               <span class="n">t_rsmpld_array</span><span class="p">,</span> <span class="mi">2</span><span class="o">-</span><span class="n">rx_rsmpld_array</span><span class="p">,</span> <span class="n">rz_rsmpld_array</span><span class="p">,</span>
                                               <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                               <span class="n">sf</span><span class="o">=</span><span class="mf">0.5</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span> <span class="n">do_labels</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>

        <span class="c1"># Markers = topo profile from ray terminations</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_schematic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_one_ray</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">gmes</span><span class="o">.</span><span class="n">x_array</span><span class="p">[::</span><span class="n">ray_subsetting</span><span class="p">],</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_array</span><span class="p">[::</span><span class="n">ray_subsetting</span><span class="p">],</span>
                        <span class="s1">&#39;ks&#39;</span><span class="p">,</span>  <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$T(\mathbf</span><span class="si">{r}</span><span class="s1">)$ from rays $\mathbf</span><span class="si">{r}</span><span class="s1">(t)$&#39;</span> <span class="p">)</span>

        <span class="c1"># Solid line = topo profile from direct integration of gradient array</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">do_direct</span> <span class="ow">or</span> <span class="n">do_schematic</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_one_ray</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T(\mathbf</span><span class="si">{r}</span><span class="s1">)$&#39;</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;$T(\mathbf</span><span class="si">{r}</span><span class="s1">)$ by integration&#39;</span>
                                             <span class="k">if</span> <span class="ow">not</span> <span class="n">do_simple</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">do_schematic</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.26</span><span class="p">,</span> <span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.13</span><span class="p">,</span> <span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.13</span><span class="p">,</span> <span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.26</span><span class="p">,</span> <span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation, $z/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span> <span class="k">if</span> <span class="n">do_schematic</span> <span class="k">else</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_schematic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_one_ray</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span> <span class="k">if</span> <span class="n">do_schematic</span>
                       <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;upper left&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">do_simple</span>
                       <span class="k">else</span> <span class="p">(</span><span class="mf">0.38</span><span class="p">,</span><span class="mf">0.75</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span> <span class="k">if</span> <span class="n">do_schematic</span>
                       <span class="k">else</span> <span class="mi">11</span><span class="p">,</span>
                       <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ray_eta_xy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ray_eta_xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.92</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_schematic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">ray_eta_xy</span><span class="p">,</span> <span class="sa">rf</span><span class="s1">&#39;$\eta=</span><span class="si">{</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
                         <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_schematic</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">2.15</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.62</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span><span class="mf">0.38</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_schematic</span><span class="p">:</span>
            <span class="n">annotate_color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
            <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">align_</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">0.03</span><span class="p">,</span><span class="s1">&#39;center&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.97</span><span class="p">,</span><span class="s1">&#39;center&#39;</span><span class="p">)]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;rays initiated&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                         <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">align_</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                         <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.53</span><span class="p">,</span> <span class="s1">&#39;rays annihilated&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.25&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">align_</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.03</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">)]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span> <span class="s1">&#39;fault slip b.c.&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                         <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">align_</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                         <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.46</span><span class="p">,</span><span class="mf">0.38</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;surface isochrone $T(\mathbf</span><span class="si">{r}</span><span class="s1">)=\mathrm</span><span class="si">{past}</span><span class="s1">$&#39;</span><span class="p">,</span>
                     <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;surface isochrone $T(\mathbf</span><span class="si">{r}</span><span class="s1">)=\mathrm</span><span class="si">{now}</span><span class="s1">$&#39;</span><span class="p">,</span>
                     <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">,</span><span class="n">dx_</span><span class="p">,</span><span class="n">dy_</span><span class="p">,</span><span class="n">shape_</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">)]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span> <span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">,</span><span class="n">dx_</span><span class="p">,</span><span class="n">dy_</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                           <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape_</span><span class="p">,</span>
                           <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">annotate_color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ray initiated&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.04</span><span class="p">,</span><span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ray terminated&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.25&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.06</span><span class="p">,</span> <span class="s1">&#39;surface isochrone $T(\mathbf</span><span class="si">{r}</span><span class="s1">)$&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">rotation</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                     <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">sf</span> <span class="o">=</span> <span class="mf">0.75</span>
            <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">,</span><span class="n">dx_</span><span class="p">,</span><span class="n">dy_</span><span class="p">,</span><span class="n">shape_</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;left&#39;</span><span class="p">)]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span> <span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">,</span><span class="n">dx_</span><span class="p">,</span><span class="n">dy_</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.04</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.03</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                           <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape_</span><span class="p">,</span>
                           <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">alpha_beta</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">x_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.7</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot ray vector angle :math:`\alpha` versus normal-slowness covector angle :math:`\beta`</span>
<span class="sd">        generated by a time-invariant solution.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): optional sample rate along each curve</span>
<span class="sd">            x_limits (list of float):</span>
<span class="sd">                optional [x_min, x_max] horizontal plot range</span>
<span class="sd">            y_limits (list of float):</span>
<span class="sd">                optional [z_min, z_max] vertical plot range</span>
<span class="sd">            do_legend (bool): optional plot legend?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">alpha_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">alpha_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">beta_p_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">beta_p_array</span><span class="p">,</span> <span class="n">alpha_array</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha(\beta)-90$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Surface normal angle  $\beta$  [$^\circ$ from vertical]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Ray angle  $\alpha\,$  [$^\circ$ from horiz]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="p">)</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">x_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">30</span><span class="p">,</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">x_limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">angular_disparity</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">x_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">aspect</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                           <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.7</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot ray vector angular disparity :math:`\alpha-\beta`</span>
<span class="sd">        generated by a time-invariant solution.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): optional sample rate along each curve</span>
<span class="sd">            x_limits (list of float):</span>
<span class="sd">                optional [x_min, x_max] horizontal plot range</span>
<span class="sd">            y_limits (list of float):</span>
<span class="sd">                optional [z_min, z_max] vertical plot range</span>
<span class="sd">            do_legend (bool): optional plot legend?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">alpha_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">alpha_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">beta_p_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">beta_p_array</span><span class="p">,</span> <span class="n">alpha_array</span><span class="o">-</span><span class="n">beta_p_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha(\beta)-90$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Surface normal angle  $\beta$  [$^\circ$ from vertical]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Angular disparity  $(\alpha-\beta\!)+90\,$  [$^\circ$]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="p">)</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="c1"># ylim = axes.get_ylim()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">x_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">30</span><span class="p">,</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">x_limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_angular_disparity</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;(b)&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.35</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot horizontal erosion speed :math:`\xi^{\rightarrow}` along a time-invariant profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="c1"># x_dbl_array = np.linspace(0,1,n_points*2-1)</span>
        <span class="n">angular_diff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">alpha_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">angular_diff_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha(x)-\beta(x)$&#39;</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">95</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Anisotropy,  $(\alpha-\beta)+90$  [$^\circ$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\alpha-\beta+90^{\circ}$&#39;</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_alpha</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot ray vector angle :math:`\alpha` along a time-invariant profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): optional sample rate along each curve</span>
<span class="sd">            do_legend (bool): optional plot legend?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">alpha_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">alpha_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">alpha_array</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha(x)$&#39;</span><span class="p">)</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">pz0_</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">pz0</span>
        <span class="n">alpha_array</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">180</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span>
            <span class="n">sy</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">tanalpha_pxpz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">px</span><span class="p">:</span><span class="n">gmes</span><span class="o">.</span><span class="n">px_value</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="n">pz0_</span><span class="p">,</span><span class="n">sub</span><span class="p">),</span><span class="n">pz</span><span class="p">:</span><span class="n">pz0_</span><span class="p">})))),</span><span class="mi">180</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">x_</span> <span class="ow">in</span> <span class="n">x_array</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Ray dip  $\alpha\!\,$  [$^\circ$ from horiz]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_v</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">xi_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">do_mod_v</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot velocity :math:`\dot{r}` along a ray.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xi_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="si">{v}</span><span class="s1">$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">xi_norm</span><span class="p">))</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{v}</span><span class="s1">/\xi^{\!\downarrow_{\!\!0}}$  [-]&#39;</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">t_array</span>  <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_interp_x</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">vx_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotx_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">vz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotz_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">v_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx_array</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vz_array</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">vx_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vx_array</span><span class="p">))</span>
        <span class="n">vz_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vz_array</span><span class="p">))</span>
        <span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">v_array</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">do_mod_v</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">v_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{v}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ray speed  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
            <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;lower left&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sfx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vz_max</span><span class="o">/</span><span class="n">v_max</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">label_suffix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">sfx</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\,\times\,$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sfx</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vx_array</span><span class="o">*</span><span class="n">sfx</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{v}</span><span class="s1">^x(x)$&#39;</span><span class="o">+</span><span class="n">label_suffix</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vz_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">{v}</span><span class="s1">^z(x)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ray velocity  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># axes.set_ylim( -(ylim[1]-ylim[0])/20,ylim[1] )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_vdot</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xi_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_mod_vdot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_geodesic</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot acceleration :math:`\ddot{r}` along a ray.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="c1"># Use an erosion rate (likely vertical xi) to renormalize velocities and accelns (up to T)</span>
        <span class="k">if</span> <span class="n">xi_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">xi_norm</span><span class="p">))</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">/\xi^{\!\downarrow_{\!\!0}}$  [T$^{-1}$]&#39;</span>

        <span class="c1"># Specify sampling in x and t</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">t_array</span>  <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_interp_x</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>

        <span class="c1"># Get ray velocities</span>
        <span class="n">vdotx_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rddotx_interp_t</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">vdotz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rddotz_interp_t</span><span class="p">(</span><span class="n">t_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">vdot_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vdotx_array</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vdotz_array</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Prep to set vertical axis to span vdotz and thus scale vdotx to fit</span>
        <span class="n">vdotx_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vdotx_array</span><span class="p">))</span>
        <span class="n">vdotz_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vdotz_array</span><span class="p">))</span>
        <span class="n">vdot_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">((</span><span class="n">vdot_array</span><span class="p">))</span>

        <span class="c1"># Start doing some plotting</span>
        <span class="n">sfx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vdotz_max</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">1e-20</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vdotz_max</span><span class="o">/</span><span class="n">vdot_max</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">label_suffix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">sfx</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\,\times\,$&#39;</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sfx</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="s1">&#39;_\mathrm</span><span class="si">{hmltn}</span><span class="s1">&#39;</span>
        <span class="n">vdotx_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">^x&#39;</span><span class="o">+</span><span class="n">choice</span><span class="o">+</span><span class="s1">&#39;(x)$&#39;</span><span class="o">+</span><span class="n">label_suffix</span>
        <span class="n">vdotz_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">^z&#39;</span><span class="o">+</span><span class="n">choice</span><span class="o">+</span><span class="s1">&#39;(x)$&#39;</span>
        <span class="k">if</span> <span class="n">do_mod_vdot</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdot_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">choice</span><span class="o">+</span><span class="s1">&#39;(x)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ray acceleration  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
            <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;lower left&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdotx_array</span><span class="o">*</span><span class="n">sfx</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vdotx_label</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdotz_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vdotz_label</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ray acceleration  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>

        <span class="c1"># Geodesic computation of acceln using Christoffel symbols</span>
        <span class="k">if</span> <span class="n">do_geodesic</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span><span class="s1">&#39;vdotx_lambdified&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span><span class="s1">&#39;vdotz_lambdified&#39;</span><span class="p">)</span>\
                        <span class="ow">and</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">vdotx_lambdified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">vdotz_lambdified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vx_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotx_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
            <span class="n">vz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotz_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
            <span class="n">vdotx_gdsc_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gmeq</span><span class="o">.</span><span class="n">vdotx_lambdified</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vz</span><span class="p">),</span> <span class="n">varepsilon</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span><span class="o">/</span><span class="n">xi_norm</span>
                                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vz</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">vx_array</span><span class="p">,</span> <span class="n">vz_array</span><span class="p">)])</span>
            <span class="n">vdotz_gdsc_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">gmeq</span><span class="o">.</span><span class="n">vdotz_lambdified</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vz</span><span class="p">),</span> <span class="n">varepsilon</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span><span class="o">/</span><span class="n">xi_norm</span>
                                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">vz</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">vx_array</span><span class="p">,</span> <span class="n">vz_array</span><span class="p">)])</span>
            <span class="n">vdot_gdsc_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vdotx_gdsc_array</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vdotz_gdsc_array</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">vdotx_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">^x_\mathrm</span><span class="si">{gdsc}</span><span class="s1">(x)$&#39;</span><span class="o">+</span><span class="n">label_suffix</span>
            <span class="n">vdotz_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">^z_\mathrm</span><span class="si">{gdsc}</span><span class="s1">(x)$&#39;</span>
            <span class="k">if</span> <span class="n">do_mod_vdot</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdot_gdsc_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{v}</span><span class="s1">_\mathrm</span><span class="si">{gdsc}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ray acceleration  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
                <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;lower left&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdotx_gdsc_array</span><span class="o">*</span><span class="n">sfx</span><span class="p">,</span> <span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vdotx_label</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">vdotz_gdsc_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">vdotz_label</span><span class="p">)</span>


        <span class="c1"># Misc pretty stuff</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="c1"># if ylim[1]&lt;0: axes.set_ylim(ylim[0],0)</span>
        <span class="c1"># if ylim[0]&gt;0: axes.set_ylim(0,ylim[1])</span>
        <span class="c1"># axes.set_ylim( -(ylim[1]-ylim[0])/20,ylim[1] )</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="c1"># axes.set_ylim(ylim[0]*1.1,-0)</span>
        <span class="k">if</span> <span class="n">do_legend</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prep_g_arrays</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">do_recompute</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;x_array&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">n_points</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_array</span><span class="p">):</span>
            <span class="n">do_recompute</span><span class="o">=</span><span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(Re)computing g matrices&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span> \
                        <span class="k">if</span> <span class="n">do_recompute</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;x_array&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_array</span>  <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">t_interp_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_array</span><span class="p">)</span> \
                        <span class="k">if</span> <span class="n">do_recompute</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;t_array&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rz_interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_array</span><span class="p">)</span>  \
                        <span class="k">if</span> <span class="n">do_recompute</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;rz_array&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">rz_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vx_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotx_interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_array</span><span class="p">)</span>  \
                        <span class="k">if</span> <span class="n">do_recompute</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;vx_array&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx_array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotz_interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_array</span><span class="p">)</span>  \
                        <span class="k">if</span> <span class="n">do_recompute</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;vz_array&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz_array</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_array</span>
        <span class="n">t_array</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_array</span>
        <span class="n">rz_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rz_array</span>
        <span class="n">vx_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx_array</span>
        <span class="n">vz_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz_array</span>

        <span class="k">if</span> <span class="n">do_recompute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_list</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_list</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="s1">&#39;gstar_ij_mat&#39;</span><span class="p">):</span> <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_list</span> \
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_recompute</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                                        <span class="k">else</span> <span class="p">[</span><span class="n">gmeq</span><span class="o">.</span><span class="n">gstar_ij_mat</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">x_</span><span class="p">,</span><span class="n">rdotx</span><span class="p">:</span><span class="n">vx_</span><span class="p">,</span><span class="n">rdotz</span><span class="p">:</span><span class="n">vz_</span><span class="p">})</span>
                                              <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">vx_</span><span class="p">,</span><span class="n">vz_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">vx_array</span><span class="p">,</span><span class="n">vz_array</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to (re)generate gstar_matrices_list: &quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span> \
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_recompute</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                                        <span class="k">else</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">elem_</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem_</span> <span class="ow">in</span> <span class="n">g_</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                                              <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_list</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to (re)generate gstar_matrices_array: &quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_list</span> \
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_recompute</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                                        <span class="k">else</span> <span class="p">[</span><span class="n">gmeq</span><span class="o">.</span><span class="n">g_ij_mat</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">x_</span><span class="p">,</span><span class="n">rdotx</span><span class="p">:</span><span class="n">vx_</span><span class="p">,</span><span class="n">rdotz</span><span class="p">:</span><span class="n">vz_</span><span class="p">})</span>
                                              <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">vx_</span><span class="p">,</span><span class="n">vz_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">vx_array</span><span class="p">,</span><span class="n">vz_array</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to (re)generate g_matrices_list: &quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span> \
                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_recompute</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                                        <span class="k">else</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">elem_</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem_</span> <span class="ow">in</span> <span class="n">g_</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                                              <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_list</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to (re)generate g_matrices_array: &quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_g_properties</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">y_limits</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span>
                              <span class="n">n_points</span><span class="o">=</span><span class="mi">121</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                              <span class="n">do_gstar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_det</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">eta_label_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">do_mod_v</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_pv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">do_recompute</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot velocity :math:`\dot{r}` along a ray.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.OneRaySolution`):</span>
<span class="sd">                    instance of single ray solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prep_g_arrays</span><span class="p">(</span><span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">do_recompute</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_gstar</span><span class="p">:</span>
            <span class="n">g_matrices_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g_matrices_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_array</span>
        <span class="n">t_array</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_array</span>
        <span class="n">rz_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rz_array</span>
        <span class="n">vx_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx_array</span>
        <span class="n">vz_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz_array</span>

        <span class="k">if</span> <span class="n">do_gstar</span><span class="p">:</span>
            <span class="c1"># Use of lambdified g matrix here fails for eta=1/4, sin(beta) for some reason</span>
            <span class="c1"># g_matrices_list = [gmeq.gstar_ij_mat_lambdified(x_,vx_,vz_)</span>
            <span class="c1">#                         for x_,vx_,vz_ in zip(x_array,vx_array,vz_array)]</span>
            <span class="n">g_label</span> <span class="o">=</span> <span class="s1">&#39;{g^*}&#39;</span>
            <span class="n">m_label</span> <span class="o">=</span> <span class="s1">&#39;co-metric&#39;</span>
            <span class="n">h_label</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span>
            <span class="n">eta_label_xy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]</span> <span class="k">if</span> <span class="n">eta_label_xy</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">eta_label_xy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use of lambdified g* matrix here fails for eta=1/4, sin(beta) for some reason</span>
            <span class="c1"># g_matrices_list = [gmeq.g_ij_mat_lambdified(x_,vx_,vz_)</span>
            <span class="c1">#                     for x_,vx_,vz_ in zip(x_array,vx_array,vz_array)]</span>
            <span class="n">g_label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{g}</span><span class="s1">&#39;</span>
            <span class="n">m_label</span> <span class="o">=</span> <span class="s1">&#39;metric&#39;</span>
            <span class="n">h_label</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
            <span class="n">eta_label_xy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.85</span><span class="p">]</span> <span class="k">if</span> <span class="n">eta_label_xy</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">eta_label_xy</span>
        <span class="c1"># g_eigenvalues_array = np.array([np.real(eig(g_)[0]) for g_ in g_matrices_array])</span>
        <span class="c1"># The metric tensor matrices are symmetric therefore Hermitian so we can use &#39;eigh&#39;</span>
        <span class="c1"># print(f&#39;g_matrices_array = {g_matrices_array}&#39;)</span>
        <span class="k">if</span> <span class="n">g_matrices_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">g_eigh_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">eigh</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span> <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="n">g_matrices_array</span><span class="p">]</span>
            <span class="n">g_det_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">det</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span> <span class="k">for</span> <span class="n">g_</span> <span class="ow">in</span> <span class="n">g_matrices_array</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g_eigh_array</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">g_det_array</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">g_eigh_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">g_eigenvalues_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="n">g_eigh_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g_eigh_</span> <span class="ow">in</span> <span class="n">g_eigh_array</span><span class="p">]</span> <span class="p">))</span>
            <span class="n">g_eigenvectors_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="n">g_eigh_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">g_eigh_</span> <span class="ow">in</span> <span class="n">g_eigh_array</span><span class="p">]</span> <span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g_eigenvalues_array</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">g_eigenvectors_array</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">do_eigenvectors</span> <span class="ow">and</span> <span class="n">g_eigenvectors_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">rz_array</span><span class="p">,</span> <span class="s1">&#39;0.6&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;ray&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Eigenvectors of $&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">arrow_sf</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">my_arrow_style</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">ArrowStyle</span><span class="o">.</span><span class="n">Fancy</span><span class="p">(</span><span class="n">head_length</span><span class="o">=</span><span class="mf">0.99</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.6</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">,</span>
                                                       <span class="n">tail_width</span><span class="o">=</span><span class="mf">0.01</span><span class="o">*</span><span class="n">arrow_sf</span><span class="p">)</span>
            <span class="n">step</span> <span class="o">=</span> <span class="mi">8</span>
            <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">step</span><span class="o">//</span><span class="mi">2</span>
            <span class="n">ev_sf</span> <span class="o">=</span> <span class="mf">0.04</span>
            <span class="n">zipped_arrays</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">[</span><span class="n">off</span><span class="p">::</span><span class="n">step</span><span class="p">],</span> <span class="n">rz_array</span><span class="p">[</span><span class="n">off</span><span class="p">::</span><span class="n">step</span><span class="p">],</span> <span class="n">g_eigenvectors_array</span><span class="p">[</span><span class="n">off</span><span class="p">::</span><span class="n">step</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">x_</span><span class="p">,</span><span class="n">rz_</span><span class="p">,</span><span class="n">evs_</span> <span class="ow">in</span> <span class="n">zipped_arrays</span><span class="p">:</span>
                <span class="n">xy_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_</span><span class="p">,</span><span class="n">rz_</span><span class="p">])</span>
                <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy_</span><span class="o">+</span><span class="n">pm</span><span class="o">*</span><span class="n">evs_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">ev_sf</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="n">xy_</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">}</span> <span class="p">)</span> <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
                <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy_</span><span class="o">+</span><span class="n">pm</span><span class="o">*</span><span class="n">evs_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">ev_sf</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="n">xy_</span><span class="p">,</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;DarkGreen&#39;</span><span class="p">}</span> <span class="p">)</span> <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;eigenvector 0&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;eigenvector 1&#39;</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">do_det</span> <span class="ow">and</span> <span class="n">g_det_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">g_det_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\det(&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Det of $&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;$ (Hessian of $&#39;</span><span class="o">+</span><span class="n">h_label</span><span class="o">+</span><span class="s1">&#39;$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">do_pv</span><span class="p">:</span>
            <span class="n">px_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">px_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
            <span class="n">pz_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">pz_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
            <span class="n">pv_array</span> <span class="o">=</span> <span class="n">px_array</span><span class="o">*</span><span class="n">vx_array</span> <span class="o">+</span> <span class="n">pz_array</span><span class="o">*</span><span class="n">vz_array</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">pv_array</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$p_i v^i$&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">gstarpp_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">gstar_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">])),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">]))</span>
                             <span class="k">for</span> <span class="n">gstar_</span><span class="p">,</span> <span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gstar_matrices_array</span><span class="p">,</span> <span class="n">px_array</span><span class="p">,</span> <span class="n">pz_array</span><span class="p">)]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">gstarpp_array</span><span class="p">,</span> <span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$g^j p_j p_j$&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">gvv_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">g_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vx_</span><span class="p">,</span> <span class="n">vz_</span><span class="p">])),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vx_</span><span class="p">,</span> <span class="n">vz_</span><span class="p">]))</span>
                             <span class="k">for</span> <span class="n">g_</span><span class="p">,</span> <span class="n">vx_</span><span class="p">,</span> <span class="n">vz_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_matrices_array</span><span class="p">,</span> <span class="n">vx_array</span><span class="p">,</span> <span class="n">vz_array</span><span class="p">)]</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">gvv_array</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$g_i v^iv^i$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Inner product of $\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">}$ and $\mathbf{{v}}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
        <span class="k">elif</span> <span class="n">g_eigenvalues_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sign_ev0</span><span class="p">,</span><span class="n">label_ev0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;negative  &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">g_eigenvalues_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;positive  &#39;</span><span class="p">)</span>
            <span class="n">sign_ev1</span><span class="p">,</span><span class="n">label_ev1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;negative  &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">g_eigenvalues_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;positive  &#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">sign_ev1</span><span class="o">*</span><span class="p">(</span><span class="n">g_eigenvalues_array</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;DarkGreen&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="o">+</span><span class="n">label_ev1</span><span class="o">+</span><span class="s1">&#39;$\lambda_&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;(1)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">sign_ev0</span><span class="o">*</span><span class="p">(</span><span class="n">g_eigenvalues_array</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="o">+</span><span class="n">label_ev0</span><span class="o">+</span><span class="s1">&#39;$\lambda_&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;(0)$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Eigenvalues of &#39;</span><span class="o">+</span><span class="n">m_label</span><span class="o">+</span><span class="s1">&#39; tensor $&#39;</span><span class="o">+</span><span class="n">g_label</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">do_eigenvectors</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">do_det</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># axes.set_ylim( -(ylim[1]-ylim[0])/20,ylim[1] )</span>
        <span class="k">elif</span> <span class="n">do_pv</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="c1"># axes.set_ylim(ylim[0]*1.1,-0)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">eta_label_xy</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TimeInvariantPlots</span><span class="p">(</span><span class="n">OneRayPlots</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">profile_flow_model</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">n_points</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">do_subtitling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_extra_annotations</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the flow component of the erosion model.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            n_points (int): optional number of points to plot along curve</span>
<span class="sd">            subtitle (str): optional sub-title (likely &#39;ramp&#39; or &#39;ramp-flat&#39; or similar)</span>
<span class="sd">            do_subtitling (bool): annotate with subtitle and eta value</span>
<span class="sd">            do_extra_annotations (bool): annotate with hillslope, channel labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">x_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)),</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">varphi_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmeq</span><span class="o">.</span><span class="n">varphi_rx_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">x_</span><span class="p">})</span> <span class="k">for</span> <span class="n">x_</span> <span class="ow">in</span> <span class="n">x_array</span><span class="p">]</span>
        <span class="n">varphi_xh1p0_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmeq</span><span class="o">.</span><span class="n">varphi_rx_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x_h</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">x_</span><span class="p">})</span> <span class="k">for</span> <span class="n">x_</span> <span class="ow">in</span> <span class="n">x_array</span><span class="p">]</span>
        <span class="c1"># print(area_array)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">varphi_array</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hillslope-channel model&#39;</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">x_array</span><span class="p">,</span> <span class="n">varphi_xh1p0_array</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;channel-only model&#39;</span> <span class="p">)</span>
        <span class="c1"># plt.loglog( area_array, gmes.beta_vt_interp(x_dbl_array), &#39;ko&#39; )</span>

        <span class="c1"># axes.set_aspect(1)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dimensionless horizontal distance, $x/x_1$  [-]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\varphi(x)$  [-]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_subtitling</span><span class="p">:</span>
            <span class="c1"># plt.legend(loc=&#39;upper left&#39;, fontsize=11, framealpha=0.95)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.22</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_extra_annotations</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">rotation</span><span class="o">=-</span><span class="mi">43</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.83</span><span class="p">,</span><span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;hillslope&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>

        <span class="n">y_limits</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">x_h_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x_h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>
        <span class="n">varphi_h_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">varphi_rx_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">x_h</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>
        <span class="c1"># plt.plot(x_h_,varphi_h_,&#39;bo&#39;, label=&#39;$x_h$&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_h_</span><span class="p">,</span><span class="n">x_h_</span><span class="p">],[</span><span class="n">varphi_h_</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">varphi_h_</span><span class="o">+</span><span class="mi">70</span><span class="p">],</span><span class="s1">&#39;b:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_h_</span><span class="p">,</span><span class="n">varphi_h_</span><span class="o">+</span><span class="mi">77</span><span class="p">,</span> <span class="s1">&#39;$x_h/x_1$&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_slope_area</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">n_points</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">x_min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                            <span class="n">do_subtitling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_extra_annotations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_simple</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a log-log slope-area plot for a time-invariant topographic profile solution</span>
<span class="sd">        of Hamilton&#39;s equations.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict): dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            n_points (int): optional number of points to plot along curve</span>
<span class="sd">            subtitle (str): optional sub-title (likely &#39;ramp&#39; or &#39;ramp-flat&#39; or similar)</span>
<span class="sd">            x_min (float): optional x offset</span>
<span class="sd">            do_subtitling (bool): optionally annotate with subtitle and eta value?</span>
<span class="sd">            do_extra_annotations (bool): optionally annotate with hillslope, channel labels?</span>
<span class="sd">            do_simple (bool): optionally avoid hillslope-channel extras?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="n">eta_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">x_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">-</span><span class="n">x_min</span><span class="p">),</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">x_dbl_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">x_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">-</span><span class="n">x_min</span><span class="p">),</span><span class="n">n_points</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">area_array</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">-</span><span class="n">x_dbl_array</span><span class="p">)</span><span class="o">/</span><span class="n">x_1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">slope_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">beta_vt_interp</span><span class="p">(</span><span class="n">x_dbl_array</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eta_</span><span class="o">!=</span><span class="mf">1.0</span> <span class="ow">or</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span> <span class="n">area_array</span><span class="p">,</span> <span class="n">slope_array</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span> <span class="p">)</span>
        <span class="c1"># plt.loglog( area_array, gmes.beta_vt_interp(x_dbl_array), &#39;-&#39; )</span>
        <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="p">]:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ScalarFormatter</span><span class="p">())</span>

        <span class="n">eta0p5_slope_array</span> <span class="o">=</span> <span class="p">[</span>\
        <span class="mf">0.0094</span><span class="p">,</span> <span class="mf">0.0096</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.0100</span><span class="p">,</span> <span class="mf">0.0102</span><span class="p">,</span> <span class="mf">0.0104</span><span class="p">,</span> <span class="mf">0.0107</span><span class="p">,</span> <span class="mf">0.0109</span><span class="p">,</span> <span class="mf">0.0112</span><span class="p">,</span> <span class="mf">0.0115</span><span class="p">,</span> <span class="mf">0.0117</span><span class="p">,</span> <span class="mf">0.0120</span><span class="p">,</span> <span class="mf">0.0123</span><span class="p">,</span> <span class="mf">0.0126</span><span class="p">,</span> <span class="mf">0.0129</span><span class="p">,</span> <span class="mf">0.0133</span><span class="p">,</span> <span class="mf">0.0136</span><span class="p">,</span> <span class="mf">0.0140</span><span class="p">,</span> <span class="mf">0.0143</span><span class="p">,</span> <span class="mf">0.0147</span><span class="p">,</span>
        <span class="mf">0.0151</span><span class="p">,</span> <span class="mf">0.0155</span><span class="p">,</span> <span class="mf">0.0160</span><span class="p">,</span> <span class="mf">0.0164</span><span class="p">,</span> <span class="mf">0.0169</span><span class="p">,</span> <span class="mf">0.0174</span><span class="p">,</span> <span class="mf">0.0179</span><span class="p">,</span> <span class="mf">0.0184</span><span class="p">,</span> <span class="mf">0.0190</span><span class="p">,</span> <span class="mf">0.0196</span><span class="p">,</span> <span class="mf">0.0202</span><span class="p">,</span> <span class="mf">0.0209</span><span class="p">,</span> <span class="mf">0.0215</span><span class="p">,</span> <span class="mf">0.0222</span><span class="p">,</span> <span class="mf">0.0230</span><span class="p">,</span> <span class="mf">0.0238</span><span class="p">,</span> <span class="mf">0.0246</span><span class="p">,</span> <span class="mf">0.0255</span><span class="p">,</span> <span class="mf">0.0264</span><span class="p">,</span> <span class="mf">0.0274</span><span class="p">,</span>
        <span class="mf">0.0284</span><span class="p">,</span> <span class="mf">0.0295</span><span class="p">,</span> <span class="mf">0.0306</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">,</span> <span class="mf">0.0331</span><span class="p">,</span> <span class="mf">0.0345</span><span class="p">,</span> <span class="mf">0.0359</span><span class="p">,</span> <span class="mf">0.0374</span><span class="p">,</span> <span class="mf">0.0391</span><span class="p">,</span> <span class="mf">0.0408</span><span class="p">,</span> <span class="mf">0.0427</span><span class="p">,</span> <span class="mf">0.0447</span><span class="p">,</span> <span class="mf">0.0469</span><span class="p">,</span> <span class="mf">0.0492</span><span class="p">,</span> <span class="mf">0.0516</span><span class="p">,</span> <span class="mf">0.0543</span><span class="p">,</span> <span class="mf">0.0572</span><span class="p">,</span> <span class="mf">0.0603</span><span class="p">,</span> <span class="mf">0.0636</span><span class="p">,</span> <span class="mf">0.0673</span><span class="p">,</span>
        <span class="mf">0.0713</span><span class="p">,</span> <span class="mf">0.0756</span><span class="p">,</span> <span class="mf">0.0803</span><span class="p">,</span> <span class="mf">0.0855</span><span class="p">,</span> <span class="mf">0.0912</span><span class="p">,</span> <span class="mf">0.0974</span><span class="p">,</span> <span class="mf">0.1043</span><span class="p">,</span> <span class="mf">0.1120</span><span class="p">,</span> <span class="mf">0.1205</span><span class="p">,</span> <span class="mf">0.1299</span><span class="p">,</span> <span class="mf">0.1405</span><span class="p">,</span> <span class="mf">0.1523</span><span class="p">,</span> <span class="mf">0.1655</span><span class="p">,</span> <span class="mf">0.1804</span><span class="p">,</span> <span class="mf">0.1973</span><span class="p">,</span> <span class="mf">0.2163</span><span class="p">,</span> <span class="mf">0.2379</span><span class="p">,</span> <span class="mf">0.2625</span><span class="p">,</span> <span class="mf">0.2902</span><span class="p">,</span> <span class="mf">0.3217</span><span class="p">,</span>
        <span class="mf">0.3573</span><span class="p">,</span> <span class="mf">0.3974</span><span class="p">,</span> <span class="mf">0.4423</span><span class="p">,</span> <span class="mf">0.4923</span><span class="p">,</span> <span class="mf">0.5475</span><span class="p">,</span> <span class="mf">0.6081</span><span class="p">,</span> <span class="mf">0.6740</span><span class="p">,</span> <span class="mf">0.7450</span><span class="p">,</span> <span class="mf">0.8196</span><span class="p">,</span> <span class="mf">0.8959</span><span class="p">,</span> <span class="mf">0.9673</span><span class="p">,</span> <span class="mf">1.0240</span><span class="p">,</span> <span class="mf">1.0601</span><span class="p">,</span> <span class="mf">1.0780</span><span class="p">,</span> <span class="mf">1.0858</span><span class="p">,</span> <span class="mf">1.0887</span><span class="p">,</span> <span class="mf">1.0899</span><span class="p">,</span> <span class="mf">1.0903</span><span class="p">,</span> <span class="mf">1.0905</span><span class="p">,</span> <span class="mf">1.0905</span><span class="p">,</span>
        <span class="mf">1.0905</span><span class="p">]</span>

        <span class="n">eta0p5_area_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.9803</span><span class="p">,</span> <span class="mf">0.9608</span><span class="p">,</span> <span class="mf">0.9415</span><span class="p">,</span> <span class="mf">0.9224</span><span class="p">,</span> <span class="mf">0.9035</span><span class="p">,</span> <span class="mf">0.8847</span><span class="p">,</span> <span class="mf">0.8662</span><span class="p">,</span> <span class="mf">0.8479</span><span class="p">,</span> <span class="mf">0.8297</span><span class="p">,</span> <span class="mf">0.8118</span><span class="p">,</span> <span class="mf">0.7941</span><span class="p">,</span> <span class="mf">0.7765</span><span class="p">,</span> <span class="mf">0.7592</span><span class="p">,</span> <span class="mf">0.7420</span><span class="p">,</span> <span class="mf">0.7251</span><span class="p">,</span> <span class="mf">0.7083</span><span class="p">,</span>
        <span class="mf">0.6917</span><span class="p">,</span> <span class="mf">0.6754</span><span class="p">,</span> <span class="mf">0.6592</span><span class="p">,</span> <span class="mf">0.6432</span><span class="p">,</span> <span class="mf">0.6274</span><span class="p">,</span> <span class="mf">0.6118</span><span class="p">,</span> <span class="mf">0.5964</span><span class="p">,</span> <span class="mf">0.5813</span><span class="p">,</span> <span class="mf">0.5663</span><span class="p">,</span> <span class="mf">0.5515</span><span class="p">,</span> <span class="mf">0.5368</span><span class="p">,</span> <span class="mf">0.5224</span><span class="p">,</span> <span class="mf">0.5082</span><span class="p">,</span> <span class="mf">0.4942</span><span class="p">,</span> <span class="mf">0.4804</span><span class="p">,</span> <span class="mf">0.4668</span><span class="p">,</span> <span class="mf">0.4533</span><span class="p">,</span> <span class="mf">0.4401</span><span class="p">,</span> <span class="mf">0.4271</span><span class="p">,</span> <span class="mf">0.4142</span><span class="p">,</span>
        <span class="mf">0.4016</span><span class="p">,</span> <span class="mf">0.3891</span><span class="p">,</span> <span class="mf">0.3769</span><span class="p">,</span> <span class="mf">0.3648</span><span class="p">,</span> <span class="mf">0.3530</span><span class="p">,</span> <span class="mf">0.3413</span><span class="p">,</span> <span class="mf">0.3298</span><span class="p">,</span> <span class="mf">0.3185</span><span class="p">,</span> <span class="mf">0.3075</span><span class="p">,</span> <span class="mf">0.2966</span><span class="p">,</span> <span class="mf">0.2859</span><span class="p">,</span> <span class="mf">0.2754</span><span class="p">,</span> <span class="mf">0.2651</span><span class="p">,</span> <span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2451</span><span class="p">,</span> <span class="mf">0.2354</span><span class="p">,</span> <span class="mf">0.2259</span><span class="p">,</span> <span class="mf">0.2166</span><span class="p">,</span> <span class="mf">0.2075</span><span class="p">,</span> <span class="mf">0.1986</span><span class="p">,</span>
        <span class="mf">0.1898</span><span class="p">,</span> <span class="mf">0.1813</span><span class="p">,</span> <span class="mf">0.1730</span><span class="p">,</span> <span class="mf">0.1648</span><span class="p">,</span> <span class="mf">0.1569</span><span class="p">,</span> <span class="mf">0.1492</span><span class="p">,</span> <span class="mf">0.1416</span><span class="p">,</span> <span class="mf">0.1342</span><span class="p">,</span> <span class="mf">0.1271</span><span class="p">,</span> <span class="mf">0.1201</span><span class="p">,</span> <span class="mf">0.1134</span><span class="p">,</span> <span class="mf">0.1068</span><span class="p">,</span> <span class="mf">0.1004</span><span class="p">,</span> <span class="mf">0.0942</span><span class="p">,</span> <span class="mf">0.0883</span><span class="p">,</span> <span class="mf">0.0825</span><span class="p">,</span> <span class="mf">0.0769</span><span class="p">,</span> <span class="mf">0.0715</span><span class="p">,</span> <span class="mf">0.0663</span><span class="p">,</span> <span class="mf">0.0613</span><span class="p">,</span>
        <span class="mf">0.0565</span><span class="p">,</span> <span class="mf">0.0519</span><span class="p">,</span> <span class="mf">0.0475</span><span class="p">,</span> <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">,</span> <span class="mf">0.0284</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">,</span> <span class="mf">0.0166</span><span class="p">,</span> <span class="mf">0.0141</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.0080</span><span class="p">,</span> <span class="mf">0.0063</span><span class="p">,</span> <span class="mf">0.0048</span><span class="p">,</span> <span class="mf">0.0035</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">,</span>
        <span class="mf">0.0016</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]</span>

        <span class="n">eta1p0_slope_array</span> <span class="o">=</span> <span class="p">[</span>\
        <span class="mf">0.0960</span><span class="p">,</span> <span class="mf">0.0970</span><span class="p">,</span> <span class="mf">0.0981</span><span class="p">,</span> <span class="mf">0.0991</span><span class="p">,</span> <span class="mf">0.1002</span><span class="p">,</span> <span class="mf">0.1013</span><span class="p">,</span> <span class="mf">0.1025</span><span class="p">,</span> <span class="mf">0.1036</span><span class="p">,</span> <span class="mf">0.1048</span><span class="p">,</span> <span class="mf">0.1060</span><span class="p">,</span> <span class="mf">0.1073</span><span class="p">,</span> <span class="mf">0.1085</span><span class="p">,</span> <span class="mf">0.1098</span><span class="p">,</span> <span class="mf">0.1112</span><span class="p">,</span> <span class="mf">0.1125</span><span class="p">,</span> <span class="mf">0.1139</span><span class="p">,</span> <span class="mf">0.1153</span><span class="p">,</span> <span class="mf">0.1168</span><span class="p">,</span> <span class="mf">0.1183</span><span class="p">,</span> <span class="mf">0.1199</span><span class="p">,</span>
        <span class="mf">0.1214</span><span class="p">,</span> <span class="mf">0.1231</span><span class="p">,</span> <span class="mf">0.1247</span><span class="p">,</span> <span class="mf">0.1264</span><span class="p">,</span> <span class="mf">0.1282</span><span class="p">,</span> <span class="mf">0.1300</span><span class="p">,</span> <span class="mf">0.1319</span><span class="p">,</span> <span class="mf">0.1338</span><span class="p">,</span> <span class="mf">0.1358</span><span class="p">,</span> <span class="mf">0.1378</span><span class="p">,</span> <span class="mf">0.1399</span><span class="p">,</span> <span class="mf">0.1420</span><span class="p">,</span> <span class="mf">0.1442</span><span class="p">,</span> <span class="mf">0.1465</span><span class="p">,</span> <span class="mf">0.1489</span><span class="p">,</span> <span class="mf">0.1513</span><span class="p">,</span> <span class="mf">0.1538</span><span class="p">,</span> <span class="mf">0.1564</span><span class="p">,</span> <span class="mf">0.1591</span><span class="p">,</span> <span class="mf">0.1619</span><span class="p">,</span>
        <span class="mf">0.1647</span><span class="p">,</span> <span class="mf">0.1677</span><span class="p">,</span> <span class="mf">0.1708</span><span class="p">,</span> <span class="mf">0.1740</span><span class="p">,</span> <span class="mf">0.1773</span><span class="p">,</span> <span class="mf">0.1807</span><span class="p">,</span> <span class="mf">0.1843</span><span class="p">,</span> <span class="mf">0.1880</span><span class="p">,</span> <span class="mf">0.1919</span><span class="p">,</span> <span class="mf">0.1959</span><span class="p">,</span> <span class="mf">0.2001</span><span class="p">,</span> <span class="mf">0.2044</span><span class="p">,</span> <span class="mf">0.2090</span><span class="p">,</span> <span class="mf">0.2137</span><span class="p">,</span> <span class="mf">0.2187</span><span class="p">,</span> <span class="mf">0.2238</span><span class="p">,</span> <span class="mf">0.2292</span><span class="p">,</span> <span class="mf">0.2349</span><span class="p">,</span> <span class="mf">0.2409</span><span class="p">,</span> <span class="mf">0.2471</span><span class="p">,</span>
        <span class="mf">0.2537</span><span class="p">,</span> <span class="mf">0.2606</span><span class="p">,</span> <span class="mf">0.2679</span><span class="p">,</span> <span class="mf">0.2756</span><span class="p">,</span> <span class="mf">0.2837</span><span class="p">,</span> <span class="mf">0.2922</span><span class="p">,</span> <span class="mf">0.3013</span><span class="p">,</span> <span class="mf">0.3109</span><span class="p">,</span> <span class="mf">0.3211</span><span class="p">,</span> <span class="mf">0.3319</span><span class="p">,</span> <span class="mf">0.3434</span><span class="p">,</span> <span class="mf">0.3557</span><span class="p">,</span> <span class="mf">0.3688</span><span class="p">,</span> <span class="mf">0.3828</span><span class="p">,</span> <span class="mf">0.3979</span><span class="p">,</span> <span class="mf">0.4141</span><span class="p">,</span> <span class="mf">0.4314</span><span class="p">,</span> <span class="mf">0.4501</span><span class="p">,</span> <span class="mf">0.4703</span><span class="p">,</span> <span class="mf">0.4922</span><span class="p">,</span>
        <span class="mf">0.5159</span><span class="p">,</span> <span class="mf">0.5419</span><span class="p">,</span> <span class="mf">0.5701</span><span class="p">,</span> <span class="mf">0.6009</span><span class="p">,</span> <span class="mf">0.6347</span><span class="p">,</span> <span class="mf">0.6720</span><span class="p">,</span> <span class="mf">0.7132</span><span class="p">,</span> <span class="mf">0.7588</span><span class="p">,</span> <span class="mf">0.8084</span><span class="p">,</span> <span class="mf">0.8615</span><span class="p">,</span> <span class="mf">0.9137</span><span class="p">,</span> <span class="mf">0.9573</span><span class="p">,</span> <span class="mf">0.9857</span><span class="p">,</span> <span class="mf">1.0003</span><span class="p">,</span> <span class="mf">1.0066</span><span class="p">,</span> <span class="mf">1.0091</span><span class="p">,</span> <span class="mf">1.0100</span><span class="p">,</span> <span class="mf">1.0104</span><span class="p">,</span> <span class="mf">1.0105</span><span class="p">,</span> <span class="mf">1.0105</span><span class="p">,</span>
        <span class="mf">1.0106</span><span class="p">]</span>

        <span class="n">eta1p0_area_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.9803</span><span class="p">,</span> <span class="mf">0.9608</span><span class="p">,</span> <span class="mf">0.9415</span><span class="p">,</span> <span class="mf">0.9224</span><span class="p">,</span> <span class="mf">0.9035</span><span class="p">,</span> <span class="mf">0.8847</span><span class="p">,</span> <span class="mf">0.8662</span><span class="p">,</span> <span class="mf">0.8479</span><span class="p">,</span> <span class="mf">0.8297</span><span class="p">,</span> <span class="mf">0.8118</span><span class="p">,</span> <span class="mf">0.7941</span><span class="p">,</span> <span class="mf">0.7765</span><span class="p">,</span> <span class="mf">0.7592</span><span class="p">,</span> <span class="mf">0.7420</span><span class="p">,</span> <span class="mf">0.7251</span><span class="p">,</span> <span class="mf">0.7083</span><span class="p">,</span> <span class="mf">0.6917</span><span class="p">,</span>
        <span class="mf">0.6754</span><span class="p">,</span> <span class="mf">0.6592</span><span class="p">,</span> <span class="mf">0.6432</span><span class="p">,</span> <span class="mf">0.6274</span><span class="p">,</span> <span class="mf">0.6118</span><span class="p">,</span> <span class="mf">0.5964</span><span class="p">,</span> <span class="mf">0.5813</span><span class="p">,</span> <span class="mf">0.5663</span><span class="p">,</span> <span class="mf">0.5515</span><span class="p">,</span> <span class="mf">0.5368</span><span class="p">,</span> <span class="mf">0.5224</span><span class="p">,</span> <span class="mf">0.5082</span><span class="p">,</span> <span class="mf">0.4942</span><span class="p">,</span> <span class="mf">0.4804</span><span class="p">,</span> <span class="mf">0.4668</span><span class="p">,</span> <span class="mf">0.4533</span><span class="p">,</span> <span class="mf">0.4401</span><span class="p">,</span> <span class="mf">0.4271</span><span class="p">,</span> <span class="mf">0.4142</span><span class="p">,</span> <span class="mf">0.4016</span><span class="p">,</span>
        <span class="mf">0.3891</span><span class="p">,</span> <span class="mf">0.3769</span><span class="p">,</span> <span class="mf">0.3648</span><span class="p">,</span> <span class="mf">0.3530</span><span class="p">,</span> <span class="mf">0.3413</span><span class="p">,</span> <span class="mf">0.3298</span><span class="p">,</span> <span class="mf">0.3185</span><span class="p">,</span> <span class="mf">0.3075</span><span class="p">,</span> <span class="mf">0.2966</span><span class="p">,</span> <span class="mf">0.2859</span><span class="p">,</span> <span class="mf">0.2754</span><span class="p">,</span> <span class="mf">0.2651</span><span class="p">,</span> <span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2451</span><span class="p">,</span> <span class="mf">0.2354</span><span class="p">,</span> <span class="mf">0.2259</span><span class="p">,</span> <span class="mf">0.2166</span><span class="p">,</span> <span class="mf">0.2075</span><span class="p">,</span> <span class="mf">0.1986</span><span class="p">,</span> <span class="mf">0.1898</span><span class="p">,</span>
        <span class="mf">0.1813</span><span class="p">,</span> <span class="mf">0.1730</span><span class="p">,</span> <span class="mf">0.1648</span><span class="p">,</span> <span class="mf">0.1569</span><span class="p">,</span> <span class="mf">0.1492</span><span class="p">,</span> <span class="mf">0.1416</span><span class="p">,</span> <span class="mf">0.1342</span><span class="p">,</span> <span class="mf">0.1271</span><span class="p">,</span> <span class="mf">0.1201</span><span class="p">,</span> <span class="mf">0.1134</span><span class="p">,</span> <span class="mf">0.1068</span><span class="p">,</span> <span class="mf">0.1004</span><span class="p">,</span> <span class="mf">0.0942</span><span class="p">,</span> <span class="mf">0.0883</span><span class="p">,</span> <span class="mf">0.0825</span><span class="p">,</span> <span class="mf">0.0769</span><span class="p">,</span> <span class="mf">0.0715</span><span class="p">,</span> <span class="mf">0.0663</span><span class="p">,</span> <span class="mf">0.0613</span><span class="p">,</span> <span class="mf">0.0565</span><span class="p">,</span>
        <span class="mf">0.0519</span><span class="p">,</span> <span class="mf">0.0475</span><span class="p">,</span> <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span>  <span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">,</span> <span class="mf">0.0284</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">,</span> <span class="mf">0.0166</span><span class="p">,</span> <span class="mf">0.0141</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.0080</span><span class="p">,</span> <span class="mf">0.0063</span><span class="p">,</span> <span class="mf">0.0048</span><span class="p">,</span> <span class="mf">0.0035</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">,</span> <span class="mf">0.0016</span><span class="p">,</span>
        <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]</span>

        <span class="n">eta1p0_xh1p0_slope_array</span> <span class="o">=</span> <span class="p">[</span>\
        <span class="mf">0.0960</span><span class="p">,</span> <span class="mf">0.0969</span><span class="p">,</span> <span class="mf">0.0979</span><span class="p">,</span> <span class="mf">0.0988</span><span class="p">,</span> <span class="mf">0.0998</span><span class="p">,</span> <span class="mf">0.1008</span><span class="p">,</span> <span class="mf">0.1018</span><span class="p">,</span> <span class="mf">0.1028</span><span class="p">,</span> <span class="mf">0.1039</span><span class="p">,</span> <span class="mf">0.1049</span><span class="p">,</span> <span class="mf">0.1060</span><span class="p">,</span> <span class="mf">0.1071</span><span class="p">,</span> <span class="mf">0.1083</span><span class="p">,</span> <span class="mf">0.1094</span><span class="p">,</span> <span class="mf">0.1106</span><span class="p">,</span> <span class="mf">0.1118</span><span class="p">,</span> <span class="mf">0.1131</span><span class="p">,</span> <span class="mf">0.1143</span><span class="p">,</span> <span class="mf">0.1156</span><span class="p">,</span> <span class="mf">0.1170</span><span class="p">,</span>
        <span class="mf">0.1183</span><span class="p">,</span> <span class="mf">0.1197</span><span class="p">,</span> <span class="mf">0.1211</span><span class="p">,</span> <span class="mf">0.1226</span><span class="p">,</span> <span class="mf">0.1241</span><span class="p">,</span> <span class="mf">0.1256</span><span class="p">,</span> <span class="mf">0.1271</span><span class="p">,</span> <span class="mf">0.1287</span><span class="p">,</span> <span class="mf">0.1304</span><span class="p">,</span> <span class="mf">0.1321</span><span class="p">,</span> <span class="mf">0.1338</span><span class="p">,</span> <span class="mf">0.1356</span><span class="p">,</span> <span class="mf">0.1374</span><span class="p">,</span> <span class="mf">0.1392</span><span class="p">,</span> <span class="mf">0.1412</span><span class="p">,</span> <span class="mf">0.1431</span><span class="p">,</span> <span class="mf">0.1451</span><span class="p">,</span> <span class="mf">0.1472</span><span class="p">,</span> <span class="mf">0.1494</span><span class="p">,</span> <span class="mf">0.1516</span><span class="p">,</span>
        <span class="mf">0.1538</span><span class="p">,</span> <span class="mf">0.1562</span><span class="p">,</span> <span class="mf">0.1586</span><span class="p">,</span> <span class="mf">0.1610</span><span class="p">,</span> <span class="mf">0.1636</span><span class="p">,</span> <span class="mf">0.1662</span><span class="p">,</span> <span class="mf">0.1689</span><span class="p">,</span> <span class="mf">0.1717</span><span class="p">,</span> <span class="mf">0.1746</span><span class="p">,</span> <span class="mf">0.1776</span><span class="p">,</span> <span class="mf">0.1807</span><span class="p">,</span> <span class="mf">0.1839</span><span class="p">,</span> <span class="mf">0.1873</span><span class="p">,</span> <span class="mf">0.1907</span><span class="p">,</span> <span class="mf">0.1943</span><span class="p">,</span> <span class="mf">0.1980</span><span class="p">,</span> <span class="mf">0.2018</span><span class="p">,</span> <span class="mf">0.2058</span><span class="p">,</span> <span class="mf">0.2099</span><span class="p">,</span> <span class="mf">0.2142</span><span class="p">,</span>
        <span class="mf">0.2187</span><span class="p">,</span> <span class="mf">0.2233</span><span class="p">,</span> <span class="mf">0.2281</span><span class="p">,</span> <span class="mf">0.2332</span><span class="p">,</span> <span class="mf">0.2385</span><span class="p">,</span> <span class="mf">0.2439</span><span class="p">,</span> <span class="mf">0.2497</span><span class="p">,</span> <span class="mf">0.2557</span><span class="p">,</span> <span class="mf">0.2620</span><span class="p">,</span> <span class="mf">0.2686</span><span class="p">,</span> <span class="mf">0.2756</span><span class="p">,</span> <span class="mf">0.2828</span><span class="p">,</span> <span class="mf">0.2905</span><span class="p">,</span> <span class="mf">0.2985</span><span class="p">,</span> <span class="mf">0.3070</span><span class="p">,</span> <span class="mf">0.3159</span><span class="p">,</span> <span class="mf">0.3253</span><span class="p">,</span> <span class="mf">0.3352</span><span class="p">,</span> <span class="mf">0.3458</span><span class="p">,</span> <span class="mf">0.3569</span><span class="p">,</span>
        <span class="mf">0.3688</span><span class="p">,</span> <span class="mf">0.3814</span><span class="p">,</span> <span class="mf">0.3948</span><span class="p">,</span> <span class="mf">0.4091</span><span class="p">,</span> <span class="mf">0.4243</span><span class="p">,</span> <span class="mf">0.4406</span><span class="p">,</span> <span class="mf">0.4580</span><span class="p">,</span> <span class="mf">0.4767</span><span class="p">,</span> <span class="mf">0.4968</span><span class="p">,</span> <span class="mf">0.5185</span><span class="p">,</span> <span class="mf">0.5419</span><span class="p">,</span> <span class="mf">0.5672</span><span class="p">,</span> <span class="mf">0.5945</span><span class="p">,</span> <span class="mf">0.6243</span><span class="p">,</span> <span class="mf">0.6568</span><span class="p">,</span> <span class="mf">0.6922</span><span class="p">,</span> <span class="mf">0.7310</span><span class="p">,</span> <span class="mf">0.7736</span><span class="p">,</span> <span class="mf">0.8202</span><span class="p">,</span> <span class="mf">0.8694</span><span class="p">,</span>
        <span class="mf">0.9179</span><span class="p">]</span>

        <span class="n">eta1p0_xh1p0_area_array</span> <span class="o">=</span> <span class="p">[</span>\
        <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.9803</span><span class="p">,</span> <span class="mf">0.9608</span><span class="p">,</span> <span class="mf">0.9415</span><span class="p">,</span> <span class="mf">0.9224</span><span class="p">,</span> <span class="mf">0.9035</span><span class="p">,</span> <span class="mf">0.8847</span><span class="p">,</span> <span class="mf">0.8662</span><span class="p">,</span> <span class="mf">0.8479</span><span class="p">,</span> <span class="mf">0.8297</span><span class="p">,</span> <span class="mf">0.8118</span><span class="p">,</span> <span class="mf">0.7941</span><span class="p">,</span> <span class="mf">0.7765</span><span class="p">,</span> <span class="mf">0.7592</span><span class="p">,</span> <span class="mf">0.7420</span><span class="p">,</span> <span class="mf">0.7251</span><span class="p">,</span> <span class="mf">0.7083</span><span class="p">,</span> <span class="mf">0.6917</span><span class="p">,</span> <span class="mf">0.6754</span><span class="p">,</span> <span class="mf">0.6592</span><span class="p">,</span>
        <span class="mf">0.6432</span><span class="p">,</span> <span class="mf">0.6274</span><span class="p">,</span> <span class="mf">0.6118</span><span class="p">,</span> <span class="mf">0.5964</span><span class="p">,</span> <span class="mf">0.5813</span><span class="p">,</span> <span class="mf">0.5663</span><span class="p">,</span> <span class="mf">0.5515</span><span class="p">,</span> <span class="mf">0.5368</span><span class="p">,</span> <span class="mf">0.5224</span><span class="p">,</span> <span class="mf">0.5082</span><span class="p">,</span> <span class="mf">0.4942</span><span class="p">,</span> <span class="mf">0.4804</span><span class="p">,</span> <span class="mf">0.4668</span><span class="p">,</span> <span class="mf">0.4533</span><span class="p">,</span> <span class="mf">0.4401</span><span class="p">,</span> <span class="mf">0.4271</span><span class="p">,</span> <span class="mf">0.4142</span><span class="p">,</span> <span class="mf">0.4016</span><span class="p">,</span> <span class="mf">0.3891</span><span class="p">,</span> <span class="mf">0.3769</span><span class="p">,</span>
        <span class="mf">0.3648</span><span class="p">,</span> <span class="mf">0.3530</span><span class="p">,</span> <span class="mf">0.3413</span><span class="p">,</span> <span class="mf">0.3298</span><span class="p">,</span> <span class="mf">0.3185</span><span class="p">,</span> <span class="mf">0.3075</span><span class="p">,</span> <span class="mf">0.2966</span><span class="p">,</span> <span class="mf">0.2859</span><span class="p">,</span> <span class="mf">0.2754</span><span class="p">,</span> <span class="mf">0.2651</span><span class="p">,</span> <span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2451</span><span class="p">,</span> <span class="mf">0.2354</span><span class="p">,</span> <span class="mf">0.2259</span><span class="p">,</span> <span class="mf">0.2166</span><span class="p">,</span> <span class="mf">0.2075</span><span class="p">,</span> <span class="mf">0.1986</span><span class="p">,</span> <span class="mf">0.1898</span><span class="p">,</span> <span class="mf">0.1813</span><span class="p">,</span> <span class="mf">0.1730</span><span class="p">,</span>
        <span class="mf">0.1648</span><span class="p">,</span> <span class="mf">0.1569</span><span class="p">,</span> <span class="mf">0.1492</span><span class="p">,</span> <span class="mf">0.1416</span><span class="p">,</span> <span class="mf">0.1342</span><span class="p">,</span> <span class="mf">0.1271</span><span class="p">,</span> <span class="mf">0.1201</span><span class="p">,</span> <span class="mf">0.1134</span><span class="p">,</span> <span class="mf">0.1068</span><span class="p">,</span> <span class="mf">0.1004</span><span class="p">,</span> <span class="mf">0.0942</span><span class="p">,</span> <span class="mf">0.0883</span><span class="p">,</span> <span class="mf">0.0825</span><span class="p">,</span> <span class="mf">0.0769</span><span class="p">,</span> <span class="mf">0.0715</span><span class="p">,</span> <span class="mf">0.0663</span><span class="p">,</span> <span class="mf">0.0613</span><span class="p">,</span> <span class="mf">0.0565</span><span class="p">,</span> <span class="mf">0.0519</span><span class="p">,</span> <span class="mf">0.0475</span><span class="p">,</span>
        <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">,</span> <span class="mf">0.0284</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">,</span> <span class="mf">0.0166</span><span class="p">,</span> <span class="mf">0.0141</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.0080</span><span class="p">,</span> <span class="mf">0.0063</span><span class="p">,</span> <span class="mf">0.0048</span><span class="p">,</span> <span class="mf">0.0035</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">,</span> <span class="mf">0.0016</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">,</span>
        <span class="mf">0.0001</span><span class="p">]</span>

        <span class="n">eta1p5_slope_array</span> <span class="o">=</span> <span class="p">[</span>\
        <span class="mf">0.2049</span><span class="p">,</span> <span class="mf">0.2063</span><span class="p">,</span> <span class="mf">0.2077</span><span class="p">,</span> <span class="mf">0.2092</span><span class="p">,</span> <span class="mf">0.2106</span><span class="p">,</span> <span class="mf">0.2121</span><span class="p">,</span> <span class="mf">0.2136</span><span class="p">,</span> <span class="mf">0.2151</span><span class="p">,</span> <span class="mf">0.2167</span><span class="p">,</span> <span class="mf">0.2183</span><span class="p">,</span> <span class="mf">0.2199</span><span class="p">,</span> <span class="mf">0.2216</span><span class="p">,</span> <span class="mf">0.2233</span><span class="p">,</span> <span class="mf">0.2250</span><span class="p">,</span> <span class="mf">0.2267</span><span class="p">,</span> <span class="mf">0.2285</span><span class="p">,</span> <span class="mf">0.2303</span><span class="p">,</span> <span class="mf">0.2322</span><span class="p">,</span> <span class="mf">0.2340</span><span class="p">,</span> <span class="mf">0.2360</span><span class="p">,</span>
        <span class="mf">0.2379</span><span class="p">,</span> <span class="mf">0.2400</span><span class="p">,</span> <span class="mf">0.2420</span><span class="p">,</span> <span class="mf">0.2441</span><span class="p">,</span> <span class="mf">0.2463</span><span class="p">,</span> <span class="mf">0.2485</span><span class="p">,</span> <span class="mf">0.2507</span><span class="p">,</span> <span class="mf">0.2530</span><span class="p">,</span> <span class="mf">0.2554</span><span class="p">,</span> <span class="mf">0.2578</span><span class="p">,</span> <span class="mf">0.2602</span><span class="p">,</span> <span class="mf">0.2628</span><span class="p">,</span> <span class="mf">0.2653</span><span class="p">,</span> <span class="mf">0.2680</span><span class="p">,</span> <span class="mf">0.2707</span><span class="p">,</span> <span class="mf">0.2735</span><span class="p">,</span> <span class="mf">0.2763</span><span class="p">,</span> <span class="mf">0.2792</span><span class="p">,</span> <span class="mf">0.2822</span><span class="p">,</span> <span class="mf">0.2853</span><span class="p">,</span>
        <span class="mf">0.2884</span><span class="p">,</span> <span class="mf">0.2917</span><span class="p">,</span> <span class="mf">0.2950</span><span class="p">,</span> <span class="mf">0.2984</span><span class="p">,</span> <span class="mf">0.3019</span><span class="p">,</span> <span class="mf">0.3056</span><span class="p">,</span> <span class="mf">0.3093</span><span class="p">,</span> <span class="mf">0.3131</span><span class="p">,</span> <span class="mf">0.3171</span><span class="p">,</span> <span class="mf">0.3212</span><span class="p">,</span> <span class="mf">0.3254</span><span class="p">,</span> <span class="mf">0.3298</span><span class="p">,</span> <span class="mf">0.3343</span><span class="p">,</span> <span class="mf">0.3390</span><span class="p">,</span> <span class="mf">0.3439</span><span class="p">,</span> <span class="mf">0.3489</span><span class="p">,</span> <span class="mf">0.3541</span><span class="p">,</span> <span class="mf">0.3595</span><span class="p">,</span> <span class="mf">0.3651</span><span class="p">,</span> <span class="mf">0.3709</span><span class="p">,</span>
        <span class="mf">0.3769</span><span class="p">,</span> <span class="mf">0.3832</span><span class="p">,</span> <span class="mf">0.3898</span><span class="p">,</span> <span class="mf">0.3966</span><span class="p">,</span> <span class="mf">0.4038</span><span class="p">,</span> <span class="mf">0.4112</span><span class="p">,</span> <span class="mf">0.4190</span><span class="p">,</span> <span class="mf">0.4272</span><span class="p">,</span> <span class="mf">0.4358</span><span class="p">,</span> <span class="mf">0.4448</span><span class="p">,</span> <span class="mf">0.4543</span><span class="p">,</span> <span class="mf">0.4643</span><span class="p">,</span> <span class="mf">0.4748</span><span class="p">,</span> <span class="mf">0.4860</span><span class="p">,</span> <span class="mf">0.4977</span><span class="p">,</span> <span class="mf">0.5102</span><span class="p">,</span> <span class="mf">0.5236</span><span class="p">,</span> <span class="mf">0.5380</span><span class="p">,</span> <span class="mf">0.5533</span><span class="p">,</span> <span class="mf">0.5697</span><span class="p">,</span>
        <span class="mf">0.5873</span><span class="p">,</span> <span class="mf">0.6064</span><span class="p">,</span> <span class="mf">0.6270</span><span class="p">,</span> <span class="mf">0.6495</span><span class="p">,</span> <span class="mf">0.6742</span><span class="p">,</span> <span class="mf">0.7015</span><span class="p">,</span> <span class="mf">0.7318</span><span class="p">,</span> <span class="mf">0.7656</span><span class="p">,</span> <span class="mf">0.8027</span><span class="p">,</span> <span class="mf">0.8432</span><span class="p">,</span> <span class="mf">0.8837</span><span class="p">,</span> <span class="mf">0.9186</span><span class="p">,</span> <span class="mf">0.9414</span><span class="p">,</span> <span class="mf">0.9534</span><span class="p">,</span> <span class="mf">0.9584</span><span class="p">,</span> <span class="mf">0.9605</span><span class="p">,</span> <span class="mf">0.9613</span><span class="p">,</span> <span class="mf">0.9615</span><span class="p">,</span> <span class="mf">0.9616</span><span class="p">,</span> <span class="mf">0.9617</span><span class="p">,</span>
        <span class="mf">0.9617</span><span class="p">]</span>

        <span class="n">eta1p5_area_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.9803</span><span class="p">,</span> <span class="mf">0.9608</span><span class="p">,</span> <span class="mf">0.9415</span><span class="p">,</span> <span class="mf">0.9224</span><span class="p">,</span> <span class="mf">0.9035</span><span class="p">,</span> <span class="mf">0.8847</span><span class="p">,</span> <span class="mf">0.8662</span><span class="p">,</span> <span class="mf">0.8479</span><span class="p">,</span> <span class="mf">0.8297</span><span class="p">,</span> <span class="mf">0.8118</span><span class="p">,</span> <span class="mf">0.7941</span><span class="p">,</span> <span class="mf">0.7765</span><span class="p">,</span> <span class="mf">0.7592</span><span class="p">,</span> <span class="mf">0.7420</span><span class="p">,</span> <span class="mf">0.7251</span><span class="p">,</span> <span class="mf">0.7083</span><span class="p">,</span>
        <span class="mf">0.6917</span><span class="p">,</span> <span class="mf">0.6754</span><span class="p">,</span> <span class="mf">0.6592</span><span class="p">,</span> <span class="mf">0.6432</span><span class="p">,</span> <span class="mf">0.6274</span><span class="p">,</span> <span class="mf">0.6118</span><span class="p">,</span> <span class="mf">0.5964</span><span class="p">,</span> <span class="mf">0.5813</span><span class="p">,</span> <span class="mf">0.5663</span><span class="p">,</span> <span class="mf">0.5515</span><span class="p">,</span> <span class="mf">0.5368</span><span class="p">,</span> <span class="mf">0.5224</span><span class="p">,</span> <span class="mf">0.5082</span><span class="p">,</span> <span class="mf">0.4942</span><span class="p">,</span> <span class="mf">0.4804</span><span class="p">,</span> <span class="mf">0.4668</span><span class="p">,</span> <span class="mf">0.4533</span><span class="p">,</span> <span class="mf">0.4401</span><span class="p">,</span> <span class="mf">0.4271</span><span class="p">,</span> <span class="mf">0.4142</span><span class="p">,</span>
        <span class="mf">0.4016</span><span class="p">,</span> <span class="mf">0.3891</span><span class="p">,</span> <span class="mf">0.3769</span><span class="p">,</span> <span class="mf">0.3648</span><span class="p">,</span> <span class="mf">0.3530</span><span class="p">,</span> <span class="mf">0.3413</span><span class="p">,</span> <span class="mf">0.3298</span><span class="p">,</span> <span class="mf">0.3185</span><span class="p">,</span> <span class="mf">0.3075</span><span class="p">,</span> <span class="mf">0.2966</span><span class="p">,</span> <span class="mf">0.2859</span><span class="p">,</span> <span class="mf">0.2754</span><span class="p">,</span> <span class="mf">0.2651</span><span class="p">,</span> <span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2451</span><span class="p">,</span> <span class="mf">0.2354</span><span class="p">,</span> <span class="mf">0.2259</span><span class="p">,</span> <span class="mf">0.2166</span><span class="p">,</span> <span class="mf">0.2075</span><span class="p">,</span> <span class="mf">0.1986</span><span class="p">,</span>
        <span class="mf">0.1898</span><span class="p">,</span> <span class="mf">0.1813</span><span class="p">,</span> <span class="mf">0.1730</span><span class="p">,</span> <span class="mf">0.1648</span><span class="p">,</span> <span class="mf">0.1569</span><span class="p">,</span> <span class="mf">0.1492</span><span class="p">,</span> <span class="mf">0.1416</span><span class="p">,</span> <span class="mf">0.1342</span><span class="p">,</span> <span class="mf">0.1271</span><span class="p">,</span> <span class="mf">0.1201</span><span class="p">,</span> <span class="mf">0.1134</span><span class="p">,</span> <span class="mf">0.1068</span><span class="p">,</span> <span class="mf">0.1004</span><span class="p">,</span> <span class="mf">0.0942</span><span class="p">,</span> <span class="mf">0.0883</span><span class="p">,</span> <span class="mf">0.0825</span><span class="p">,</span> <span class="mf">0.0769</span><span class="p">,</span> <span class="mf">0.0715</span><span class="p">,</span> <span class="mf">0.0663</span><span class="p">,</span> <span class="mf">0.0613</span><span class="p">,</span>
        <span class="mf">0.0565</span><span class="p">,</span> <span class="mf">0.0519</span><span class="p">,</span> <span class="mf">0.0475</span><span class="p">,</span> <span class="mf">0.0433</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.0354</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">,</span> <span class="mf">0.0284</span><span class="p">,</span> <span class="mf">0.0251</span><span class="p">,</span> <span class="mf">0.0221</span><span class="p">,</span> <span class="mf">0.0192</span><span class="p">,</span> <span class="mf">0.0166</span><span class="p">,</span> <span class="mf">0.0141</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">,</span> <span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.0080</span><span class="p">,</span> <span class="mf">0.0063</span><span class="p">,</span> <span class="mf">0.0048</span><span class="p">,</span> <span class="mf">0.0035</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">,</span>
        <span class="mf">0.0016</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">eta_</span><span class="o">==</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">eta1p5_area_array</span><span class="p">,</span><span class="n">eta1p5_slope_array</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\eta=3/2\,,\,\,x_h/x_1=0.9$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">eta0p5_area_array</span><span class="p">,</span><span class="n">eta0p5_slope_array</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\eta=1/2\,,\,\,x_h/x_1=0.9$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">eta1p0_area_array</span><span class="p">,</span><span class="n">eta1p0_slope_array</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\eta=1\,,\,\,x_h/x_1=0.9$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">eta1p0_xh1p0_area_array</span><span class="p">,</span><span class="n">eta1p0_xh1p0_slope_array</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;channel-only model&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># axes.set_aspect(1)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dimensionless area, $(x_1-x)^2/x_1^2$  [-]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Slope, $|\tan\beta|$  [-]&#39;</span><span class="p">)</span>
        <span class="c1"># plt.legend(loc=&#39;upper left&#39;, fontsize=11, framealpha=0.95)</span>

        <span class="k">if</span> <span class="n">do_subtitling</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_extra_annotations</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.29</span><span class="p">,</span><span class="mf">0.83</span><span class="p">,</span> <span class="s1">&#39;hillslope&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.735</span><span class="p">,</span><span class="mf">0.49</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">rotation</span><span class="o">=-</span><span class="mf">58.5</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.2&#39;</span><span class="p">)</span>

        <span class="n">y_limits</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">x_h_</span> <span class="o">=</span> <span class="n">x_h</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
        <span class="n">area_h_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span> <span class="p">((</span><span class="n">x_1</span><span class="o">-</span><span class="n">x_h_</span><span class="p">)</span><span class="o">/</span><span class="n">x_1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>
        <span class="n">slope_h_</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">beta_vt_interp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x_h_</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">area_h_</span><span class="p">,</span><span class="n">area_h_</span><span class="p">],[</span><span class="n">slope_h_</span><span class="o">*</span><span class="mf">0.45</span><span class="p">,</span><span class="n">slope_h_</span><span class="o">*</span><span class="mf">1.5</span><span class="p">],</span><span class="s1">&#39;b:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">area_h_</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">area_h_</span><span class="p">,</span><span class="n">slope_h_</span><span class="o">*</span><span class="mf">0.4</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\dfrac{(x_1-x_h)^2}{x_1^2}$&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                         <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_simple</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mf">1.15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">area_array</span><span class="p">,</span> <span class="n">slope_array</span>

    <span class="k">def</span> <span class="nf">profile_aniso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ray_eta_xy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">v_exponent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">sf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">n_arrows</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>
                      <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot time-invariant profile annotated with ray vectors, normal-slowness covector herringbones,</span>
<span class="sd">        and colorized for anisotropy (defined as the difference :math:`(\alpha-\beta)`).</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict):</span>
<span class="sd">                dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            sf ([float,float]):</span>
<span class="sd">                optional scale factor(s) for vertical axes (bottom and top)</span>
<span class="sd">            n_points (int):</span>
<span class="sd">                sample rate along each curve</span>
<span class="sd">            n_arrows (int):</span>
<span class="sd">                number of :math:`\mathbf{r}` vector arrows and :math:`\mathbf{\widetilde{p}}` covector herringbones to plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">h_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>

        <span class="n">profile_lw</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">profile_lw</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$h(x)&#39;</span><span class="o">+</span><span class="s1">&#39;\quad\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span>
                 <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation, $z/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

        <span class="n">cmap_choice</span> <span class="o">=</span> <span class="s1">&#39;viridis_r&#39;</span>
        <span class="c1">#     cmap_choice = &#39;plasma_r&#39;</span>
        <span class="c1">#     cmap_choice = &#39;magma_r&#39;</span>
        <span class="c1">#     cmap_choice = &#39;inferno_r&#39;</span>
        <span class="c1">#     cmap_choice = &#39;cividis_r&#39;</span>
        <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_arrows</span><span class="p">)</span>
        <span class="n">h_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">beta_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">alpha_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">alpha_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">rdot_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdot_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">p_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">aniso_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">alpha_array</span><span class="o">-</span><span class="n">beta_array</span><span class="p">)</span>

        <span class="n">aniso_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">aniso_array</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="mi">90</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">color_map</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_choice</span><span class="p">)</span>
        <span class="n">aniso_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">((</span><span class="n">aniso_</span><span class="o">-</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                         <span class="k">for</span> <span class="n">aniso_</span> <span class="ow">in</span> <span class="n">aniso_array</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rp_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="c1"># Fix the range of p values to be represented: smaller values will be clipped</span>
            <span class="n">p_range_max</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="n">p_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p_array</span><span class="p">)</span>
            <span class="n">p_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">p_array</span><span class="p">)</span>
            <span class="n">p_min</span> <span class="o">=</span> <span class="n">p_max</span><span class="o">/</span><span class="n">p_range_max</span> <span class="k">if</span> <span class="n">p_max</span><span class="o">/</span><span class="n">p_min</span><span class="o">&gt;</span><span class="n">p_range_max</span> <span class="k">else</span> <span class="n">p_min</span>
            <span class="n">p_range</span> <span class="o">=</span> <span class="n">p_max</span><span class="o">-</span><span class="n">p_min</span>
            <span class="n">np_scale</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="c1"># Fix the range of rdot values to be represented: smaller values will be clipped</span>
            <span class="n">rdot_range_max</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="n">rdot_max</span><span class="p">,</span> <span class="n">rdot_min</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rdot_array</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">rdot_array</span><span class="p">)</span>
            <span class="n">rdot_min</span> <span class="o">=</span> <span class="n">rdot_max</span><span class="o">/</span><span class="n">rdot_range_max</span> <span class="k">if</span> <span class="n">rdot_max</span><span class="o">/</span><span class="n">rdot_min</span><span class="o">&gt;</span><span class="n">rdot_range_max</span> <span class="k">else</span> <span class="n">rdot_min</span>
            <span class="n">rdot_range</span> <span class="o">=</span> <span class="n">rdot_max</span><span class="o">-</span><span class="n">rdot_min</span>
            <span class="n">nrdot_scale</span> <span class="o">=</span> <span class="mi">9</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="n">z_</span><span class="p">,</span> <span class="n">aniso_color</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">rdot_</span><span class="p">,</span> <span class="n">p_</span><span class="p">)</span> \
                    <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span>
                           <span class="n">aniso_colors</span><span class="p">,</span>
                           <span class="n">alpha_array</span><span class="p">,</span> <span class="n">beta_array</span><span class="p">,</span>
                           <span class="n">rdot_array</span><span class="p">,</span> <span class="n">p_array</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">rp_idx</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Ray vector</span>
                    <span class="n">hw</span><span class="o">=</span><span class="mf">0.01</span>
                    <span class="n">hl</span><span class="o">=</span><span class="mf">0.02</span>
                    <span class="n">oh</span><span class="o">=</span><span class="mf">0.1</span>
                    <span class="n">len_arrow</span> <span class="o">=</span> <span class="p">((</span> <span class="n">v_scale</span><span class="o">*</span><span class="p">((</span><span class="n">rdot_</span><span class="o">-</span><span class="n">rdot_min</span><span class="p">)</span><span class="o">**</span><span class="n">v_exponent</span><span class="o">/</span><span class="n">rdot_range</span><span class="p">)</span>
                                  <span class="k">if</span> <span class="n">rdot_</span><span class="o">&gt;=</span><span class="n">rdot_min</span> <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">v_scale</span><span class="o">/</span><span class="n">nrdot_scale</span><span class="p">)</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">len_arrow</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha_</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">len_arrow</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span>
                                <span class="n">head_width</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="n">hl</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="n">oh</span><span class="p">,</span>
                                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">ec</span><span class="o">=</span><span class="n">aniso_color</span><span class="p">,</span>
                                <span class="n">fc</span><span class="o">=</span><span class="n">aniso_color</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Slowness covector</span>
                    <span class="n">len_stick</span> <span class="o">=</span> <span class="mf">0.08</span>
                    <span class="n">hw</span><span class="o">=</span><span class="mf">0.015</span>
                    <span class="n">hl</span><span class="o">=</span><span class="mf">0.0</span>
                    <span class="n">oh</span><span class="o">=</span><span class="mf">0.0</span>
                    <span class="n">np_</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="n">np_scale</span><span class="o">*</span><span class="p">((</span><span class="n">p_</span><span class="o">-</span><span class="n">p_min</span><span class="p">)</span><span class="o">/</span><span class="n">p_range</span><span class="p">))</span> <span class="k">if</span> <span class="n">p_</span><span class="o">&gt;=</span><span class="n">p_min</span> <span class="k">else</span> <span class="mi">1</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">len_stick</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span> <span class="o">-</span><span class="n">len_stick</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">,</span> <span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dz</span><span class="p">,</span>
                                <span class="n">head_width</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">head_starts_at_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">ec</span><span class="o">=</span><span class="n">aniso_color</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i_head</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np_</span><span class="p">)):</span>
                        <span class="n">len_head</span> <span class="o">=</span> <span class="n">i_head</span><span class="o">/</span><span class="p">(</span><span class="n">np_</span><span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">,</span> <span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span> <span class="o">-</span><span class="n">dz</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span>
                                <span class="n">head_width</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="n">hl</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="n">oh</span><span class="p">,</span>
                                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">ec</span><span class="o">=</span><span class="n">aniso_color</span><span class="p">)</span>
        <span class="n">colorbar_im</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">aniso_span</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
                                  <span class="n">cmap</span><span class="o">=</span><span class="n">color_map</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.08</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span> <span class="o">&lt;=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">6.</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span> <span class="o">&lt;</span> <span class="n">sy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">4.3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span> <span class="o">&gt;=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">sfy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">((</span><span class="mi">9</span><span class="o">-</span><span class="mf">4.3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mf">4.3</span><span class="p">))</span><span class="o">*</span><span class="mf">0.3</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">sfy</span><span class="p">,</span><span class="n">sfy</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sfy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">((</span><span class="mi">9</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="mf">0.5</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">sfy</span><span class="p">,</span><span class="n">sfy</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>

        <span class="c1"># Hand-made legend</span>

        <span class="k">class</span> <span class="nc">ArrivalTime</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">HandlerArrivalTime</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">legend_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">orig_handle</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">handlebox</span><span class="p">):</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">xdescent</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">ydescent</span>
                <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">height</span>
                <span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">profile_lw</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                <span class="n">handlebox</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">patch</span>

        <span class="k">class</span> <span class="nc">RayPoint</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">HandlerRayPoint</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">fc</span>

            <span class="k">def</span> <span class="nf">legend_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">orig_handle</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">handlebox</span><span class="p">):</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">xdescent</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">ydescent</span>
                <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">height</span>
                <span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">)</span>
                <span class="n">handlebox</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">patch</span>

        <span class="k">class</span> <span class="nc">RayArrow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">HandlerRayArrow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">legend_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">orig_handle</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">handlebox</span><span class="p">):</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">xdescent</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">ydescent</span>
                <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">height</span>
                <span class="n">color_</span> <span class="o">=</span> <span class="n">aniso_colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                            <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                            <span class="n">head_width</span><span class="o">=</span><span class="mf">0.75</span><span class="o">*</span><span class="n">height</span><span class="p">,</span>
                                            <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                            <span class="n">fc</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">color_</span><span class="p">)</span>
                <span class="n">handlebox</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">patch</span>

        <span class="k">class</span> <span class="nc">NormalStick</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">class</span> <span class="nc">HandlerNormalStick</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">legend_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">orig_handle</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">handlebox</span><span class="p">):</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">xdescent</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">ydescent</span>
                <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">handlebox</span><span class="o">.</span><span class="n">height</span>
                <span class="n">color_</span> <span class="o">=</span> <span class="n">aniso_colors</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrow</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="n">height</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">height</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                            <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                            <span class="n">head_width</span><span class="o">=</span><span class="mf">0.65</span><span class="o">*</span><span class="n">height</span><span class="p">,</span>
                                            <span class="n">head_length</span><span class="o">=</span><span class="mf">0.7</span><span class="o">*</span><span class="n">height</span><span class="p">,</span>
                                            <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="n">fc</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">color_</span><span class="p">)</span>
                <span class="n">handlebox</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="p">[</span><span class="n">width</span><span class="o">*</span><span class="mf">0.25</span><span class="p">,</span><span class="n">width</span><span class="o">*</span><span class="mf">0.6</span><span class="p">,</span><span class="n">width</span><span class="o">*</span><span class="mf">0.8</span><span class="p">]:</span>
                    <span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyArrow</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="n">height</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                <span class="n">head_width</span><span class="o">=</span><span class="n">height</span> <span class="k">if</span> <span class="n">w</span><span class="o">&lt;</span><span class="n">width</span><span class="o">*</span><span class="mf">0.8</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                                                <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                                <span class="n">overhang</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                                <span class="n">fc</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">color_</span><span class="p">)</span>
                    <span class="n">handlebox</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">patch</span>

        <span class="n">legend_fns1</span> <span class="o">=</span> <span class="p">[</span><span class="n">ArrivalTime</span><span class="p">(),</span> <span class="n">RayPoint</span><span class="p">(),</span> <span class="n">RayArrow</span><span class="p">(),</span> <span class="n">NormalStick</span><span class="p">()]</span>
        <span class="n">legend_labels1</span> <span class="o">=</span> <span class="p">[</span> <span class="sa">r</span><span class="s1">&#39;$T(\mathbf</span><span class="si">{r}</span><span class="s1">)$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mathbf</span><span class="si">{r}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mathbf</span><span class="si">{v}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">}$&#39;</span><span class="p">]</span>
        <span class="n">legend_handlers1</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ArrivalTime</span><span class="p">:</span> <span class="n">HandlerArrivalTime</span><span class="p">(),</span>
                             <span class="n">RayPoint</span><span class="p">:</span><span class="n">HandlerRayPoint</span><span class="p">(),</span>
                             <span class="n">RayArrow</span><span class="p">:</span> <span class="n">HandlerRayArrow</span><span class="p">(),</span>
                             <span class="n">NormalStick</span><span class="p">:</span> <span class="n">HandlerNormalStick</span><span class="p">()</span> <span class="p">}</span>
        <span class="n">legend1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">legend_fns1</span><span class="p">,</span> <span class="n">legend_labels1</span><span class="p">,</span> <span class="n">handler_map</span><span class="o">=</span><span class="n">legend_handlers1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span> <span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">legend1</span><span class="p">)</span>

        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">colorbar_axes</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">colorbar_axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">colorbar_im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">colorbar_axes</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Anisotropy  $\alpha-\beta+90$  [$^\circ$]&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.93</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
                     <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_beta</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>
                      <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.7</span><span class="p">]</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For a time-invariant (steady-state) topographic profile,</span>
<span class="sd">        plot the surface-normal covector angle :math:`\beta` from vertical,</span>
<span class="sd">        aka the surface tilt angle from horizontal, as a function of</span>
<span class="sd">        dimensionless horizontal distance :math:`x/x_1`.</span>

<span class="sd">        This angle is named and calculated in three ways:</span>
<span class="sd">        (1) :math:`\beta_p`: directly from the series of :math:`\mathbf{\widetilde{p}}` values</span>
<span class="sd">        generated by ray ODE integration, since :math:`\tan(\beta_p)=-p_x/p_z`;</span>
<span class="sd">        (2) :math:`\beta_{ts}`: by differentiating the computed time-invariant</span>
<span class="sd">        topographic profile (itself constructed from the terminations of the ensemble of</span>
<span class="sd">        progressively truncated, identical rays);</span>
<span class="sd">        (3) :math:`\beta_{vt}`: from the velocity triangle</span>
<span class="sd">        :math:`\tan(\beta_{vt}) = \dfrac{v^z+\xi^{\perp}}{v^x}`: generated by the geometric</span>
<span class="sd">        constraint of balancing the ray velocities with surface-normal velocities.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">x_dbl_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_dbl_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_vt_interp</span><span class="p">(</span><span class="n">x_dbl_array</span><span class="p">)),</span>
                 <span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta_</span><span class="si">{vt}</span><span class="s1">$ from $(v^z+\xi^{\!\downarrow\!})/v^x$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_ts_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)),</span>
                 <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta_</span><span class="si">{ts}</span><span class="s1">$ from topo gradient&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_dbl_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">x_dbl_array</span><span class="p">)),</span>
                 <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>  <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\beta_p$ from $p_x/p_z$&#39;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># plt.plot(gmes.rx_array,np.rad2deg(gmes.beta_array),</span>
        <span class="c1">#          &#39;ks&#39;, ls=&#39;-&#39;, ms=3, label=r&#39;$\beta_p$ from $p_x/p_z$&#39;)</span>
        <span class="c1"># plt.plot(gmes.rx_array,np.rad2deg(gmes.beta_ts_array),</span>
        <span class="c1">#          &#39;bo&#39;, ls=&#39;-&#39;, ms=4, label=r&#39;$\beta_{ts}$ from topo gradient&#39;)</span>
        <span class="c1"># plt.plot(gmes.rx_array,np.rad2deg(gmes.beta_vt_array),</span>
        <span class="c1">#          &#39;r&#39;, ls=&#39;-&#39;, label=r&#39;$\beta_{vt}$ from $(v^z+\xi^{\!\downarrow\!})/v^x$&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Angle $\beta$  [$\circ$]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_beta_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                           <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For a time-invariant (steady-state) topographic profile,</span>
<span class="sd">        plot the error in the estimated surface-normal covector angle :math:`\beta`</span>
<span class="sd">        as a function of dimensionless horizontal distance :math:`x/x_1`.</span>

<span class="sd">        This error, expressed as a percentage, is defined as one of the following normalized differences:</span>
<span class="sd">        (1) :math:`100(\beta_{ts}-\beta_{p})/\beta_{p}`, or</span>
<span class="sd">        (2) :math:`100(\beta_{vt}-\beta_{p})/\beta_{p}`.</span>
<span class="sd">        The error in :math:`\beta_{vt}` can be non-trivial for $x/x_1 \rightarrow 0$ and :math:`\eta &lt; 1`</span>
<span class="sd">        if the number of rays used to construct the topographic profile is insufficient.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">beta_vt_error_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span>
                 <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\dfrac{\beta_</span><span class="si">{vt}</span><span class="s1">-\beta_</span><span class="si">{p}</span><span class="s1">}{\beta_</span><span class="si">{p}</span><span class="s1">}$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">beta_ts_error_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span>
                 <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\dfrac{\beta_</span><span class="si">{ts}</span><span class="s1">-\beta_</span><span class="si">{p}</span><span class="s1">}{\beta_</span><span class="si">{p}</span><span class="s1">}$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error  [%]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1.0</span><span class="p">,</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_xi</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>
                    <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">xi_norm</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot surface-normal erosion speed :math:`\xi^{\perp}`  along a time-invariant profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): optional sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xi_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\perp\!}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">xi_norm</span><span class="p">))</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\perp\!}/\xi^{\!\downarrow_{\!\!0}}$  [-]&#39;</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">u_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">u_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">u_from_rdot_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">u_from_rdot_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span>
        <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">u_from_rdot_array</span><span class="o">/</span><span class="n">xi_norm</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\perp\!}(x)$ from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">u_array</span><span class="o">/</span><span class="n">xi_norm</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\perp\!}(x)$ from $1/p$&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">u_from_rdot_array</span><span class="o">/</span><span class="n">xi_norm</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">u_array</span><span class="o">/</span><span class="n">xi_norm</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $1/p$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normal erosion rate  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.05</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.23</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.23</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\perp}$&#39;</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_xihorizontal</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>
                              <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;(d)&#39;</span><span class="p">,</span> <span class="n">xi_norm</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot horizontal erosion speed :math:`\xi^{\rightarrow}` along a time-invariant profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xi_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\rightarrow}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">xi_norm</span><span class="p">))</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\rightarrow\!\!}/\xi^{\!\downarrow_{\!\!0}}$  [-]&#39;</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">uhorizontal_p_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">uhorizontal_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">uhorizontal_v_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">uhorizontal_v_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">uhorizontal_p_array</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\rightarrow\!}(x)$ from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">uhorizontal_v_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\rightarrow\!}(x)$ from $1/p$&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">uhorizontal_p_array</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">uhorizontal_v_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $1/p$&#39;</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Horiz erosion rate  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="c1"># axes.set_ylim(ylim[0]*1.1,-0)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\rightarrow}$&#39;</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_xivertical</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xf_stop</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>
                           <span class="n">n_points</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pub_label</span><span class="o">=</span><span class="s1">&#39;(e)&#39;</span><span class="p">,</span> <span class="n">xi_norm</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot vertical erosion speed :math:`\xi^{\downarrow}` along a time-invariant profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.TimeInvariantSolution`):</span>
<span class="sd">                    instance of time invariant solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            n_points (int): sample rate along each curve</span>
<span class="sd">            y_limits (list of float):</span>
<span class="sd">                optional [z_min, z_max] vertical plot range</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xi_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\downarrow}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xi_norm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">xi_norm</span><span class="p">))</span>
            <span class="n">rate_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\!\downarrow}\!\!/\xi^{\!\downarrow_{\!\!0}}$  [-]&#39;</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">xf_stop</span><span class="p">,</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">xiv_p_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">xiv_p_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="n">xiv_v_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">xiv_v_interp</span><span class="p">(</span><span class="n">x_array</span><span class="p">)</span><span class="o">/</span><span class="n">xi_norm</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">xiv_p_array</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\downarrow\!}(x)$ from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">xiv_v_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\xi^{\!\downarrow\!}(x)$ from $1/p$&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">xiv_p_array</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $v$&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span><span class="n">xiv_v_array</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;from $1/p$&#39;</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vertical erosion rate  &#39;</span><span class="o">+</span><span class="n">rate_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">pub_label</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\xi^{\downarrow}$&#39;</span> <span class="k">if</span> <span class="n">do_pub_label</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TimeDependentPlots</span><span class="p">(</span><span class="n">Graphing</span><span class="p">):</span>

    <span class="n">rp_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rx&#39;</span><span class="p">,</span><span class="s1">&#39;rz&#39;</span><span class="p">,</span><span class="s1">&#39;px&#39;</span><span class="p">,</span><span class="s1">&#39;pz&#39;</span><span class="p">]</span>
    <span class="n">rpt_list</span> <span class="o">=</span> <span class="n">rp_list</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">profile_isochrones</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">do_zero_isochrone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">do_rays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ray_subsetting</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ray_lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ray_ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ray_label</span><span class="o">=</span><span class="s1">&#39;ray&#39;</span><span class="p">,</span>
                            <span class="n">do_isochrones</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isochrone_subsetting</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">do_isochrone_p</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">isochrone_lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">isochrone_ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">isochrone_label</span><span class="o">=</span><span class="s1">&#39;isochrone&#39;</span><span class="p">,</span>
                            <span class="n">do_annotate_rays</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_arrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">arrow_sf</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">arrow_offset</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                            <span class="n">do_annotate_cusps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cusp_lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">do_smooth_colors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">x_limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">1.001</span><span class="p">),</span> <span class="n">y_limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span><span class="mf">0.525</span><span class="p">),</span>
                            <span class="n">aspect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_alt_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">do_infer_initiation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_pub_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">pub_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pub_label_posn</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.92</span><span class="p">]</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot xxxx.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.VelocityBoundarySolution`):</span>
<span class="sd">                    instance of velocity boundary solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sub (dict):</span>
<span class="sd">                dictionary of model parameter values to be used for equation substitutions</span>
<span class="sd">            do_zero_isochrone (bool):</span>
<span class="sd">                optional plot initial surface?</span>
<span class="sd">            do_rays (bool):</span>
<span class="sd">                optional plot rays?</span>
<span class="sd">            ray_subsetting (int):</span>
<span class="sd">                optional rate of ray subsetting</span>
<span class="sd">            ray_lw (float):</span>
<span class="sd">                optional ray line width</span>
<span class="sd">            ray_ls (float):</span>
<span class="sd">                optional ray line style</span>
<span class="sd">            ray_label (float):</span>
<span class="sd">                optional ray line label</span>
<span class="sd">            do_isochrones (bool):</span>
<span class="sd">                optional plot isochrones?</span>
<span class="sd">            isochrone_subsetting (int):</span>
<span class="sd">                optional rate of isochrone subsetting</span>
<span class="sd">            do_isochrone_p (bool):</span>
<span class="sd">                optional plot isochrone herringbones?</span>
<span class="sd">            isochrone_lw (float):</span>
<span class="sd">                optional isochrone line width</span>
<span class="sd">            isochrone_ls (float):</span>
<span class="sd">                optional isochrone line style</span>
<span class="sd">            isochrone_label (float):</span>
<span class="sd">                optional isochrone line label</span>
<span class="sd">            do_annotate_rays (bool):</span>
<span class="sd">                optional plot arrowheads along rays?</span>
<span class="sd">            n_arrows (int):</span>
<span class="sd">                optional number of arrowheads to annotate along rays or cusp-line</span>
<span class="sd">            arrow_sf (float):</span>
<span class="sd">                optional scale factor for arrowhead sizes</span>
<span class="sd">            arrow_offset (int):</span>
<span class="sd">                optional offset to start annotating arrowheads</span>
<span class="sd">            do_annotate_cusps (bool):</span>
<span class="sd">                optional plot line to visualize cusp initiation and propagation</span>
<span class="sd">            cusp_lw (float):</span>
<span class="sd">                optional cusp propagation curve line width</span>
<span class="sd">            x_limits (list of float):</span>
<span class="sd">                optional [x_min, x_max] horizontal plot range</span>
<span class="sd">            y_limits (list of float):</span>
<span class="sd">                optional [z_min, z_max] vertical plot range</span>
<span class="sd">            aspect (float):</span>
<span class="sd">                optional figure aspect ratio</span>
<span class="sd">            do_legend (bool):</span>
<span class="sd">                optional plot legend</span>
<span class="sd">            do_alt_legend (bool):</span>
<span class="sd">                optional plot slightly different legend</span>
<span class="sd">            do_grid (bool):</span>
<span class="sd">                optional plot dotted grey gridlines</span>
<span class="sd">            do_infer_initiation (bool):</span>
<span class="sd">                optional draw dotted line inferring cusp initiation at the left boundary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">do_overlay</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="c1"># Unpack for brevity</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmes</span><span class="p">,</span><span class="s1">&#39;rpt_isochrones&#39;</span><span class="p">):</span>
            <span class="n">rx_isochrones</span><span class="p">,</span> <span class="n">rz_isochrones</span><span class="p">,</span> <span class="n">px_isochrones</span><span class="p">,</span> <span class="n">pz_isochrones</span><span class="p">,</span> <span class="n">t_isochrones</span> \
                <span class="o">=</span> <span class="p">[</span><span class="n">gmes</span><span class="o">.</span><span class="n">rpt_isochrones</span><span class="p">[</span><span class="n">rpt_</span><span class="p">]</span> <span class="k">for</span> <span class="n">rpt_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt_list</span><span class="p">]</span>

        <span class="c1"># Initial boundary</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmes</span><span class="p">,</span><span class="s1">&#39;rpt_isochrones&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">do_zero_isochrone</span><span class="p">:</span>
            <span class="n">n_isochrones</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rx_isochrones</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx_isochrones</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rz_isochrones</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;zero isochrone&#39;</span> <span class="k">if</span> <span class="n">do_legend</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span> <span class="p">)</span>

        <span class="c1"># Rays</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">do_rays</span><span class="p">:</span>
            <span class="n">n_rays</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">rpt_arrays</span><span class="p">[</span><span class="s1">&#39;rx&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i_ray</span><span class="p">,(</span><span class="n">rx_array</span><span class="p">,</span><span class="n">rz_array</span><span class="p">,</span><span class="n">t_array</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">rpt_arrays</span><span class="p">[</span><span class="s1">&#39;rx&#39;</span><span class="p">]),</span>
                                                                   <span class="nb">reversed</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">rpt_arrays</span><span class="p">[</span><span class="s1">&#39;rz&#39;</span><span class="p">]),</span>
                                                                   <span class="nb">reversed</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">rpt_arrays</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]))):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i_ray</span><span class="o">//</span><span class="n">ray_subsetting</span><span class="o">-</span><span class="n">i_ray</span><span class="o">/</span><span class="n">ray_subsetting</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">this_ray_label</span><span class="o">=</span><span class="p">(</span><span class="n">ray_label</span><span class="o">+</span><span class="s1">&#39; ($t_{\mathrm</span><span class="si">{newest}</span><span class="s1">}$)&#39;</span> <span class="k">if</span> <span class="n">i_ray</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span>
                                    <span class="n">ray_label</span><span class="o">+</span><span class="s1">&#39; ($t_{\mathrm</span><span class="si">{oldest}</span><span class="s1">}$)&#39;</span> <span class="k">if</span> <span class="n">i_ray</span><span class="o">==</span><span class="n">n_rays</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span>
                                    <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">do_annotate_rays</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_annotate_ray_custom</span><span class="p">(</span><span class="n">rx_array</span><span class="p">,</span> <span class="n">rz_array</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">i_ray</span><span class="p">,</span> <span class="n">ray_subsetting</span><span class="p">,</span> <span class="n">n_rays</span><span class="p">,</span>
                                                       <span class="n">n_arrows</span><span class="p">,</span> <span class="n">arrow_sf</span><span class="p">,</span> <span class="n">arrow_offset</span><span class="p">,</span>
                                                       <span class="n">x_limits</span><span class="o">=</span><span class="n">x_limits</span><span class="p">,</span> <span class="n">y_limits</span><span class="o">=</span><span class="n">y_limits</span><span class="p">,</span>
                                                       <span class="n">line_style</span><span class="o">=</span><span class="n">ray_ls</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="n">ray_lw</span><span class="p">,</span>
                                                       <span class="n">ray_label</span><span class="o">=</span><span class="n">this_ray_label</span><span class="p">,</span>
                                                       <span class="n">do_smooth_colors</span><span class="o">=</span><span class="n">do_smooth_colors</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx_array</span><span class="p">,</span><span class="n">rz_array</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">ray_lw</span><span class="p">,</span>
                                 <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mycolors</span><span class="p">(</span><span class="n">i_ray</span><span class="p">,</span> <span class="n">ray_subsetting</span><span class="p">,</span> <span class="n">n_rays</span><span class="p">,</span> <span class="n">do_smooth</span><span class="o">=</span><span class="n">do_smooth_colors</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">ray_ls</span><span class="p">,</span>
                                 <span class="n">label</span><span class="o">=</span><span class="n">this_ray_label</span><span class="p">)</span>

        <span class="c1"># Time slices or isochrones of erosion front</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gmes</span><span class="p">,</span><span class="s1">&#39;rpt_isochrones&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">do_isochrones</span><span class="p">:</span>
            <span class="n">n_isochrones</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rx_isochrones</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i_isochrone</span><span class="p">,(</span><span class="n">rx_isochrone</span><span class="p">,</span><span class="n">rz_isochrone</span><span class="p">,</span><span class="n">t_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rx_isochrones</span><span class="p">,</span><span class="n">rz_isochrones</span><span class="p">,</span>
                                                                                            <span class="n">t_isochrones</span><span class="p">)):</span>
                <span class="n">i_subsetted</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_isochrone</span><span class="o">//</span><span class="n">isochrone_subsetting</span><span class="o">-</span><span class="n">i_isochrone</span><span class="o">/</span><span class="n">isochrone_subsetting</span><span class="p">)</span>
                <span class="n">i_subsubsetted</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_isochrone</span><span class="o">//</span><span class="p">(</span><span class="n">isochrone_subsetting</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="n">i_isochrone</span><span class="o">/</span><span class="p">(</span><span class="n">isochrone_subsetting</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i_isochrone</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">i_subsetted</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">rx_isochrone</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx_isochrone</span><span class="p">,</span> <span class="n">rz_isochrone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="n">i_isochrone</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="p">),</span>
                             <span class="n">linestyle</span><span class="o">=</span><span class="n">isochrone_ls</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.3</span><span class="o">*</span><span class="n">isochrone_lw</span> <span class="k">if</span> <span class="n">i_subsubsetted</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">isochrone_lw</span><span class="p">)</span>
            <span class="c1"># Hack legend items</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">rx_isochrone</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx_isochrone</span><span class="p">,</span> <span class="n">rz_isochrone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="n">i_isochrone</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="p">),</span>
                         <span class="n">linestyle</span><span class="o">=</span><span class="n">isochrone_ls</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.3</span><span class="o">*</span><span class="n">isochrone_lw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;major &#39;</span><span class="o">+</span><span class="n">isochrone_label</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rx_isochrone</span><span class="p">,</span> <span class="n">rz_isochrone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="n">i_isochrone</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="p">),</span>
                         <span class="n">linestyle</span><span class="o">=</span><span class="n">isochrone_ls</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">isochrone_lw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;minor &#39;</span><span class="o">+</span><span class="n">isochrone_label</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">do_isochrone_p</span><span class="p">:</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">rx_lowres</span><span class="p">,</span><span class="n">rz_lowres</span><span class="p">,</span><span class="n">px_lowres</span><span class="p">,</span><span class="n">pz_lowres</span><span class="p">)</span> \
                            <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rx_isochrones_lowres</span><span class="p">,</span><span class="n">rz_isochrones_lowres</span><span class="p">,</span>
                                        <span class="n">px_isochrones_lowres</span><span class="p">,</span><span class="n">pz_isochrones_lowres</span><span class="p">):</span>
                        <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">rx_</span><span class="p">,</span><span class="n">rz_</span><span class="p">,</span><span class="mf">0.02</span><span class="o">*</span><span class="n">px_</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">px_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">pz_</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="mf">0.02</span><span class="o">*</span><span class="n">pz_</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">px_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">pz_</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
                               <span class="n">ec</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="n">isochrone_lw</span><span class="p">,</span>
                               <span class="n">head_width</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                     <span class="k">for</span> <span class="p">(</span><span class="n">rx_</span><span class="p">,</span><span class="n">rz_</span><span class="p">,</span><span class="n">px_</span><span class="p">,</span><span class="n">pz_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rx_lowres</span><span class="p">,</span> <span class="n">rz_lowres</span><span class="p">,</span> <span class="n">px_lowres</span><span class="p">,</span> <span class="n">pz_lowres</span><span class="p">)]</span>

        <span class="c1"># Knickpoint aka cusp propagation</span>
        <span class="k">if</span> <span class="n">do_annotate_cusps</span><span class="p">:</span>
            <span class="n">rxz_array</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rxz</span> <span class="k">for</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">rxz</span><span class="p">),</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">gmes</span><span class="o">.</span><span class="n">trxz_cusps</span> <span class="k">if</span> <span class="n">rxz</span><span class="o">!=</span><span class="p">[]</span> <span class="ow">and</span> <span class="n">rxz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">1.01</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n_cusps</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rxz_array</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Plot locations of cusps as a propagation curve</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxz_array</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rxz_array</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">cusp_lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cusp propagation&#39;</span><span class="p">)</span>

                <span class="c1"># Plot inferred initiation of cusp propagation from LHS boundary</span>
                <span class="k">if</span> <span class="n">do_infer_initiation</span><span class="p">:</span>
                    <span class="p">((</span><span class="n">x1_</span><span class="p">,</span><span class="n">y1_</span><span class="p">),(</span><span class="n">x2_</span><span class="p">,</span><span class="n">y2_</span><span class="p">))</span> <span class="o">=</span> <span class="n">rxz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2_</span><span class="o">-</span><span class="n">x1_</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="n">y2_</span><span class="o">-</span><span class="n">y1_</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
                    <span class="n">x0_</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">y0_</span> <span class="o">=</span> <span class="n">y1_</span><span class="o">+</span><span class="p">(</span><span class="n">dy_</span><span class="o">/</span><span class="n">dx_</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x0_</span><span class="o">-</span><span class="n">x1_</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">(</span><span class="n">x0_</span><span class="p">,</span><span class="n">x1_</span><span class="p">),</span> <span class="p">(</span><span class="n">y0_</span><span class="p">,</span><span class="n">y1_</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">cusp_lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;inferred initiation&#39;</span> <span class="p">)</span>

                <span class="c1"># Plot arrow annotations using subset of cusps</span>
                <span class="n">cusp_subsetting</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_cusps</span><span class="o">//</span><span class="n">n_arrows</span><span class="p">)</span>
                <span class="n">rxz_array</span> <span class="o">=</span>  <span class="n">rxz_array</span><span class="p">[::</span><span class="n">cusp_subsetting</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="mf">0.7</span>
                <span class="n">my_arrow_style</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">ArrowStyle</span><span class="o">.</span><span class="n">Fancy</span><span class="p">(</span><span class="n">head_length</span><span class="o">=.</span><span class="mi">99</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                                                            <span class="n">head_width</span><span class="o">=.</span><span class="mi">6</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
                <span class="k">for</span> <span class="p">((</span><span class="n">x1_</span><span class="p">,</span><span class="n">y1_</span><span class="p">),(</span><span class="n">x0_</span><span class="p">,</span><span class="n">y0_</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rxz_array</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rxz_array</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                    <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_</span><span class="o">-</span><span class="n">x0_</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="n">y1_</span><span class="o">-</span><span class="n">y0_</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">x_limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>  <span class="p">(</span><span class="n">x0_</span><span class="o">&gt;=</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">)</span> \
                                         <span class="ow">and</span> <span class="p">(</span><span class="n">x0_</span><span class="o">&lt;=</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span><span class="p">)</span> <span class="p">):</span>
                        <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x0_</span><span class="p">,</span><span class="n">y0_</span><span class="p">),</span>  <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x0_</span><span class="o">+</span><span class="n">dx_</span><span class="p">,</span><span class="n">y0_</span><span class="o">+</span><span class="n">dy_</span><span class="p">),</span>
                                  <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span> <span class="p">))</span>

        <span class="c1"># Label axes</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation, $z/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_legend</span> <span class="ow">or</span> <span class="n">do_alt_legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

        <span class="c1"># Tidy axes etc</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">x_limits</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_grid</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">aspect</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">aspect</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_pub_label</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">pub_label_posn</span><span class="p">,</span> <span class="n">pub_label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>


    <span class="k">def</span> <span class="nf">profile_cusp_speed</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">sample_spacing</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_limits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">],</span> <span class="n">t_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span> <span class="n">y_limits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span>
                            <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">do_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_infer_initiation</span><span class="o">=</span><span class="kc">True</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot horizontal speed of cusp propagation</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmes (:class:`~.ode_raytracing.VelocityBoundarySolution`):</span>
<span class="sd">                    instance of velocity boundary solution class defined in :mod:`~.ode_raytracing`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            sample_spacing (int): sample interval between cusps over which to compute the speed</span>
<span class="sd">            x_limits (list of float):</span>
<span class="sd">                optional [x_min, x_max] horizontal plot range</span>
<span class="sd">            y_limits (list of float):</span>
<span class="sd">                optional [z_min, z_max] vertical plot range</span>
<span class="sd">            do_x (bool):</span>
<span class="sd">                optional plot x-axis as dimensionless horizontal distance :math:`x/x_1`;</span>
<span class="sd">                otherwise plot as time :math:`t`</span>
<span class="sd">            do_infer_initiation (bool):</span>
<span class="sd">                optional draw dotted line inferring cusp initiation at the left boundary</span>

<span class="sd">        Todo:</span>
<span class="sd">            implement `do_infer_initiation`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="c1"># Drop last cusp because it&#39;s sometimes bogus</span>
        <span class="n">trxz_cusps</span> <span class="o">=</span>  <span class="n">gmes</span><span class="o">.</span><span class="n">trxz_cusps</span>
        <span class="n">x_or_t_array</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;rxz&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">do_x</span> <span class="k">else</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">vc_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[(</span><span class="n">x1_</span><span class="o">-</span><span class="n">x0_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t1_</span><span class="o">-</span><span class="n">t0_</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x0_</span><span class="p">,</span><span class="n">z0</span><span class="p">),(</span><span class="n">x1_</span><span class="p">,</span><span class="n">z1</span><span class="p">),</span><span class="n">t0_</span><span class="p">,</span><span class="n">t1_</span>
                            <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;rxz&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;rxz&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
                                   <span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cusps</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:])]</span> <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_or_t_array</span><span class="p">,</span> <span class="n">vc_array</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;measured&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_x</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time, $t$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cusp horiz propagation speed,  $c^x$&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span> <span class="k">if</span> <span class="n">do_infer_initiation</span> <span class="k">else</span> <span class="n">x_or_t_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
        <span class="c1"># color_cx, color_bounds = &#39;DarkGreen&#39;, &#39;Green&#39;</span>
        <span class="n">color_cx</span><span class="p">,</span> <span class="n">color_bounds</span> <span class="o">=</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;DarkRed&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cx_pz_lambda</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color_cx</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$c^x$ model ($p_z$)&#39;</span> <span class="p">)</span>
        <span class="c1"># plt.plot(x_array, gmes.cx_pz_tanbeta_lambda(x_array), &#39;:&#39;, color=&#39;g&#39;, alpha=0.8, lw=2, label=r&#39;$c^x$ model ($\tan\beta$)&#39; )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">cx_v_lambda</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$c^x$ model ($\mathbf</span><span class="si">{v}</span><span class="s1">$)&#39;</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">vx_interp_fast</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_bounds</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fast ray $v^x$ bound&#39;</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">vx_interp_slow</span><span class="p">(</span><span class="n">x_array</span><span class="p">),</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_bounds</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;slow ray $v^x$ bound&#39;</span> <span class="p">)</span>

        <span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">x_limits</span><span class="p">)</span> <span class="k">if</span> <span class="n">do_x</span> <span class="k">else</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">t_limits</span><span class="p">)</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span> <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TheoryPlots</span><span class="p">(</span><span class="n">Graphing</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">comparison_logpolar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">varphi_</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                            <span class="n">idtx_pz_min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">idtx_pz_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                            <span class="n">fgtx_pz_min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">fgtx_pz_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                            <span class="n">y_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot both indicatrix and figuratrix on one log-polar graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Erosion indicatrix &amp; figuratrix&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="c1"># px_pz_lambda = lambdify( [pz], gmeq.fgtx_px_pz_varphi_eqn.rhs.subs({varphi:varphi_}) )</span>
        <span class="c1"># fgtx_pz_array = -np.power(10,np.linspace(np.log10(1000),np.log10(1e-6),n_points))</span>
        <span class="c1"># fgtx_px_array = np.array([float(re(sy.N(px_pz_lambda(pz_)))) for pz_ in fgtx_pz_array])</span>

        <span class="c1"># Compute figuratrix</span>
        <span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">,</span> <span class="n">_</span> \
            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figuratrix</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">fgtx_pz_min</span><span class="p">,</span> <span class="n">fgtx_pz_max</span><span class="p">)</span>
        <span class="n">fgtx_p_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fgtx_px_array</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">fgtx_pz_array</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">fgtx_tanbeta_array</span> <span class="o">=</span> <span class="o">-</span><span class="n">fgtx_px_array</span><span class="o">/</span><span class="n">fgtx_pz_array</span>
        <span class="n">fgtx_beta_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">fgtx_tanbeta_array</span><span class="p">)</span>
        <span class="n">fgtx_theta_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fgtx_beta_array</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">fgtx_beta_array</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">fgtx_p_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fgtx_p_array</span><span class="p">,</span><span class="n">fgtx_p_array</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

        <span class="c1"># Compute indicatrix</span>
        <span class="n">idtx_rdotx_array</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span><span class="n">_</span> \
            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indicatrix</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">idtx_pz_min</span><span class="p">,</span> <span class="n">idtx_pz_max</span><span class="p">)</span>
        <span class="n">idtx_rdot_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">idtx_rdotx_array</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">idtx_rdotz_array</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">idtx_alpha_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="o">-</span><span class="n">idtx_rdotx_array</span><span class="o">/</span><span class="n">idtx_rdotz_array</span><span class="p">)</span>
        <span class="n">idtx_theta_negrdot_array</span> <span class="o">=</span> <span class="n">idtx_alpha_array</span><span class="p">[</span><span class="n">idtx_rdotz_array</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">idtx_rdot_negrdot_array</span> <span class="o">=</span> <span class="n">idtx_rdot_array</span><span class="p">[</span><span class="n">idtx_rdotz_array</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">idtx_theta_posrdot_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="n">idtx_alpha_array</span><span class="p">[</span><span class="n">idtx_rdotz_array</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">idtx_rdot_posrdot_array</span> <span class="o">=</span> <span class="n">idtx_rdot_array</span><span class="p">[</span><span class="n">idtx_rdotz_array</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">idtx_theta_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">idtx_theta_negrdot_array</span><span class="p">,</span> <span class="n">idtx_theta_posrdot_array</span><span class="p">])</span>
        <span class="n">idtx_rdot_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">idtx_rdot_negrdot_array</span><span class="p">,</span><span class="n">idtx_rdot_posrdot_array</span><span class="p">])</span>

        <span class="c1"># Compute reference unit circle</span>
        <span class="n">unit_circle_beta_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

        <span class="c1"># Do the basic plotting</span>
        <span class="c1"># idtx_label = r&#39;indicatrix $F(\mathbf{v},\alpha)$&#39;</span>
        <span class="c1"># fgtx_label = r&#39;figuratrix $F^*(\mathbf{\widetilde{p}},\beta)$&#39;</span>
        <span class="n">idtx_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ray velocity&#39;</span>
        <span class="n">fgtx_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;normal slowness&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span> <span class="n">fgtx_theta_array</span><span class="p">,</span> <span class="n">fgtx_p_array</span><span class="p">,</span> <span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">fgtx_label</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span> <span class="n">idtx_theta_array</span><span class="p">,</span> <span class="n">idtx_rdot_array</span><span class="p">,</span> <span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">idtx_label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">idtx_theta_array</span><span class="p">,</span> <span class="n">idtx_rdot_array</span><span class="p">,</span> <span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="c1"># plt.polar( idtx_theta_posrdot_array, idtx_rdot_posrdot_array, &#39;magenta&#39;, ls=&#39;-&#39;, lw=3)</span>
        <span class="c1"># plt.polar( idtx_theta_negrdot_array, idtx_rdot_negrdot_array, &#39;k&#39;, ls=&#39;-&#39;, lw=3)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">unit_circle_beta_array</span><span class="p">,</span> <span class="n">unit_circle_beta_array</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;unit circle&#39;</span><span class="p">)</span>

        <span class="c1"># Labelling etc</span>
        <span class="n">posn_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">]</span>
        <span class="n">xtick_posns</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">i_</span> <span class="k">if</span> <span class="n">i_</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="k">for</span> <span class="n">i_</span> <span class="ow">in</span> <span class="n">posn_list</span><span class="p">]</span>
        <span class="n">xtick_posns</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">xtick_labels</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">r</span><span class="s1">&#39;$\frac{\pi}{&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x_</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;}$&#39;</span> <span class="k">if</span> <span class="n">x_</span> <span class="o">&gt;</span> <span class="mi">0</span>
                         <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$-\frac{\pi}{&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">x_</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;}$&#39;</span> <span class="k">if</span> <span class="n">x_</span> <span class="o">!=</span> <span class="mi">0</span>
                         <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$0$&#39;</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">x_</span> <span class="ow">in</span> <span class="n">posn_list</span><span class="p">]</span>
        <span class="n">xtick_labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;$\beta=0$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\beta=\frac{\pi}</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\qquad\alpha,\beta=\frac{\pi}</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\alpha=\frac{3\pi}</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\alpha={\pi}$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\alpha=-\frac{3\pi}</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\alpha,\beta=-\frac{\pi}</span><span class="si">{2}</span><span class="s1">\quad$&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;$\beta=-\frac{\pi}</span><span class="si">{4}</span><span class="s1">$&#39;</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">xtick_posns</span><span class="p">,</span> <span class="n">xtick_labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">y_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_limits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">ytick_posns</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ytick_posns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="n">ytick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$10^{&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y_</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;}$&#39;</span> <span class="k">for</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">ytick_posns</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">ytick_posns</span><span class="p">,</span> <span class="n">ytick_labels</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">1.6</span><span class="p">,(</span><span class="mi">1</span><span class="o">+</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;$\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>

        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">handles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">]</span>
        <span class="c1"># Hacked fix to bug in Matplotlib that adds a bogus entry here</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">text_labels</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="n">rdotz_</span><span class="p">,</span> <span class="n">zoom_factor</span><span class="p">,</span> <span class="n">do_text_labels</span><span class="p">):</span>
        <span class="n">xy_</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">zoom_factor</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="mf">1.25</span><span class="p">,</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">xy_</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\varphi=</span><span class="si">{}</span><span class="s1">\quad\eta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">varphi_</span><span class="p">,</span><span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="p">),</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_text_labels</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rdotx_</span><span class="o">*</span><span class="mf">0.97</span><span class="p">,</span> <span class="n">rdotz_</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{v}</span><span class="s1">$&#39;</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">sf</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="k">if</span> <span class="n">varphi_</span><span class="o">&gt;=</span><span class="mf">0.5</span> <span class="k">else</span> <span class="mf">0.85</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">px_</span><span class="o">+</span><span class="mf">0.25</span><span class="p">,</span><span class="n">pz_</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">}$&#39;</span><span class="p">,</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">arrows</span><span class="p">(</span><span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="n">rdotz_</span><span class="p">):</span>
        <span class="n">p_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">px_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">pz_</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Arrow for rdot direction</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span><span class="n">rdotz_</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="c1"># Fishbone for p direction</span>
        <span class="n">np_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="p">((</span><span class="n">p_</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span> <span class="k">if</span> <span class="n">p_</span><span class="o">&gt;=</span><span class="mf">0.2</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">hw_</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#if do_half else 0.2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">px_</span><span class="p">,</span><span class="n">pz_</span><span class="p">,</span><span class="o">-</span><span class="n">px_</span><span class="p">,</span><span class="o">-</span><span class="n">pz_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                <span class="n">head_width</span><span class="o">=</span><span class="n">hw_</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">head_starts_at_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_head</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np_</span><span class="p">)):</span>
            <span class="n">len_head</span> <span class="o">=</span> <span class="n">i_head</span><span class="o">/</span><span class="p">(</span><span class="n">np_</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">px_</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span> <span class="n">pz_</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span>
                    <span class="n">head_width</span><span class="o">=</span><span class="n">hw_</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">len_head</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">px_</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span> <span class="n">pz_</span><span class="o">*</span><span class="n">len_head</span><span class="p">,</span>
                <span class="n">head_width</span><span class="o">=</span><span class="n">hw_</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">lines_and_points</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">zoomx</span><span class="p">,</span> <span class="n">do_pz</span><span class="p">,</span> <span class="n">do_shapes</span><span class="p">):</span>
        <span class="c1"># Unpack</span>
        <span class="n">varphi_</span> <span class="o">=</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;varphi&#39;</span><span class="p">]</span>
        <span class="n">n_vertices_</span><span class="p">,</span> <span class="n">ls_</span> <span class="o">=</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;n_vertices&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;ls&#39;</span><span class="p">]</span>
        <span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="n">rdotz_</span> <span class="o">=</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;px&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;pz&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;rdotx&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;rdotz&#39;</span><span class="p">]</span>
        <span class="n">pz_min_</span><span class="p">,</span> <span class="n">pz_max_</span> <span class="o">=</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;pz_min&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;pz_max&#39;</span><span class="p">]</span>
        <span class="n">psqrd_</span> <span class="o">=</span> <span class="p">(</span><span class="n">px_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">pz_</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">px_</span><span class="o">/</span><span class="n">psqrd_</span><span class="p">,</span><span class="n">rdotx_</span><span class="p">],</span> <span class="p">[</span><span class="n">pz_</span><span class="o">/</span><span class="n">psqrd_</span><span class="p">,</span> <span class="n">rdotz_</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls_</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">px_</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pz_</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls_</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_pz</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">zoomx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zoomx</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">pz_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">psqrd_</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">px_</span><span class="p">,</span><span class="n">px_</span><span class="o">/</span><span class="n">psqrd_</span><span class="p">],</span> <span class="p">[</span><span class="n">pz_</span><span class="p">,</span><span class="n">pz_</span><span class="o">/</span><span class="n">psqrd_</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls_</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_shapes</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">RegularPolygon</span><span class="p">(</span> <span class="p">(</span><span class="n">px_</span><span class="p">,</span><span class="n">pz_</span><span class="p">),</span> <span class="n">n_vertices_</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
                            <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">RegularPolygon</span><span class="p">(</span> <span class="p">(</span><span class="n">rdotx_</span><span class="p">,</span><span class="n">rdotz_</span><span class="p">),</span> <span class="n">n_vertices_</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
                            <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">Circle</span><span class="p">(</span> <span class="p">(</span><span class="n">px_</span><span class="p">,</span><span class="n">pz_</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">Circle</span><span class="p">(</span> <span class="p">(</span><span class="n">rdotx_</span><span class="p">,</span><span class="n">rdotz_</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">annotations</span><span class="p">(</span><span class="n">beta_</span><span class="p">,</span> <span class="n">tanalpha_</span><span class="p">):</span>
        <span class="c1"># alpha arc</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Arc</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">theta1</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span> <span class="mi">90</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tanalpha_</span><span class="p">)))</span> <span class="p">)</span>
        <span class="c1"># beta arc</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Arc</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">theta1</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="mi">270</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">beta_</span><span class="p">))</span> <span class="p">)</span>
        <span class="c1"># &quot;faster&quot; direction</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.05</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;faster&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="c1"># &quot;faster&quot; direction</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.03</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;slower&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="c1">#transform=axes.transAxes,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">85</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">do_legend</span><span class="p">,</span> <span class="n">do_half</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">do_legend</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">loc_</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span> <span class="k">if</span> <span class="n">do_half</span> <span class="k">else</span> <span class="s1">&#39;upper left&#39;</span> <span class="k">if</span> <span class="n">do_ray_slowness</span>  <span class="k">else</span> <span class="s1">&#39;lower left&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc_</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span> <span class="k">if</span> <span class="n">do_half</span> <span class="k">else</span> <span class="s1">&#39;upper left&#39;</span> <span class="k">if</span> <span class="n">do_ray_slowness</span> <span class="k">else</span> <span class="s1">&#39;lower left&#39;</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc_</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">figuratrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">pz_max</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">px_pz_eqn</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span> <span class="n">px</span><span class="p">,</span> <span class="n">factor</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">fgtx_px_pz_varphi_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">varphi</span><span class="p">:</span><span class="n">varphi_</span><span class="p">}))</span> <span class="p">)</span>
        <span class="n">fgtx_pz_array</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pz_max</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pz_min</span><span class="p">),</span> <span class="n">n_points</span><span class="p">))</span>
        <span class="n">fgtx_px_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">px_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">}))))</span> <span class="k">for</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="n">fgtx_pz_array</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">,</span> <span class="n">px_pz_eqn</span>

    <span class="k">def</span> <span class="nf">indicatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">pz_max</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="n">rdotx_pz_eqn</span> <span class="o">=</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">idtx_rdotx_pz_varphi_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">varphi</span><span class="p">:</span><span class="n">varphi_</span><span class="p">})</span>
        <span class="n">rdotz_pz_eqn</span> <span class="o">=</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">idtx_rdotz_pz_varphi_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">varphi</span><span class="p">:</span><span class="n">varphi_</span><span class="p">})</span>
        <span class="n">fgtx_pz_array</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pz_max</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pz_min</span><span class="p">),</span> <span class="n">n_points</span><span class="p">))</span>
        <span class="n">idtx_rdotx_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">rdotx_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">}))))</span>
                                        <span class="k">for</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="n">fgtx_pz_array</span><span class="p">])</span>
        <span class="n">idtx_rdotz_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">rdotz_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">}))))</span>
                                        <span class="k">for</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="n">fgtx_pz_array</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">idtx_rdotx_array</span><span class="p">,</span> <span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">rdotx_pz_eqn</span><span class="p">,</span> <span class="n">rdotz_pz_eqn</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_figuratrix</span><span class="p">(</span><span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">,</span> <span class="n">maybe_recip_fn</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># label = r&#39;normal speed&#39; if do_ray_slowness else r&#39;figuratrix $F^*$&#39;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;normal velocity&#39;</span> <span class="k">if</span> <span class="n">do_ray_slowness</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;normal slowness&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="o">*</span><span class="n">maybe_recip_fn</span><span class="p">(</span><span class="o">-</span><span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="o">*</span><span class="n">maybe_recip_fn</span><span class="p">(</span> <span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkBlue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_indicatrix</span><span class="p">(</span><span class="n">idtx_rdotx_array</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">maybe_recip_fn</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># label = r&#39;ray slowness&#39; if do_ray_slowness else r&#39;indicatrix $F$&#39;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;ray slowness&#39;</span> <span class="k">if</span> <span class="n">do_ray_slowness</span> <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;ray velocity&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="o">*</span><span class="n">maybe_recip_fn</span><span class="p">(</span> <span class="n">idtx_rdotx_array</span><span class="p">,</span> <span class="n">idtx_rdotz_array</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="o">*</span><span class="n">maybe_recip_fn</span><span class="p">(</span><span class="o">-</span><span class="n">idtx_rdotx_array</span><span class="p">,</span> <span class="n">idtx_rdotz_array</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;DarkRed&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_unit_circle</span><span class="p">(</span><span class="n">do_varphi_circle</span><span class="p">):</span>
        <span class="n">unit_circle_beta_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">unit_circle_beta_array</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">unit_circle_beta_array</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                 <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;unit circle&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_varphi_circle</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">varphi_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">unit_circle_beta_array</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">varphi_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">unit_circle_beta_array</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                     <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\varphi=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">varphi_</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">relative_geometry</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">varphi_</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zoom_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">do_half</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_annotations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">do_text_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_lines_points</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">do_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_varphi_circle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_pz</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">do_ray_slowness</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">x_max</span><span class="o">=</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="mf">1e-1</span> <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the loci of :math:`\mathbf{\widetilde{p}}` and :math:`\mathbf{r}` and</span>
<span class="sd">        their behavior defined by :math:`F` relative to the :math:`\xi` circle.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            varphi_choice (int): the value of :math:`\varphi` to use</span>
<span class="sd">            zoom_factor (float): fractional zoom factor relative to preassigned graph limits</span>
<span class="sd">            do_half (bool): plot only for :math:`x\geq0`?</span>
<span class="sd">            do_annotations (bool): plot annotated arcs, faster/slower arrows?</span>
<span class="sd">            do_legend (bool): display the legend?</span>
<span class="sd">            do_text_labels (bool): display text annotations?</span>
<span class="sd">            do_arrows (bool): display vector/covector arrows?</span>
<span class="sd">            do_lines_points (bool): display dashed/dotted tangent lines etc?</span>
<span class="sd">            do_shapes (bool): plot key points using polygon symbols rather than simple circles</span>
<span class="sd">            do_varphi_circle (bool): plot the :math:`\xi` (typically unit) circle?</span>
<span class="sd">            do_pz (bool): plot horizontal dotted line indicating magnitude of :math:`p_z`</span>
<span class="sd">            do_ray_slowness (bool): invert ray speed (but keep ray direction) in indicatrix?</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="c1"># Adjust plot scale, limits</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span> <span class="k">if</span> <span class="n">do_half</span> <span class="k">else</span> <span class="o">-</span><span class="n">x_max</span>
        <span class="n">y_minmax</span> <span class="o">=</span> <span class="mf">2.4</span> <span class="k">if</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">eta</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">2.4</span>
        <span class="n">zoomx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">])</span> <span class="o">*</span> <span class="n">zoom_factor</span>
        <span class="n">zoomz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">y_minmax</span><span class="p">,</span> <span class="n">y_minmax</span><span class="p">])</span> <span class="o">*</span> <span class="n">zoom_factor</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">zoomx</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">zoomz</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Horizontal component&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vertical component&#39;</span><span class="p">)</span>

        <span class="c1"># Prep</span>
        <span class="n">recip_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">:</span> <span class="p">[</span><span class="n">x_</span><span class="o">/</span><span class="p">(</span><span class="n">x_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z_</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">z_</span><span class="o">/</span><span class="p">(</span><span class="n">x_</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z_</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
        <span class="n">null_fn</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">:</span> <span class="p">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">]</span>
        <span class="n">maybe_recip_fn</span> <span class="o">=</span> <span class="n">recip_fn</span> <span class="k">if</span> <span class="n">do_ray_slowness</span> <span class="k">else</span> <span class="n">null_fn</span>
        <span class="n">points_tangents_dicts</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mf">0.1</span>  <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>  <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
            <span class="mf">0.15</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>  <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
            <span class="mf">0.5</span>  <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
            <span class="mi">1</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
            <span class="mf">1.3</span>  <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
            <span class="mi">2</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
            <span class="mi">3</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;n_vertices&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span> <span class="p">:</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;pz_min&#39;</span> <span class="p">:</span> <span class="n">pz_min</span><span class="p">,</span> <span class="s1">&#39;pz_max&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
        <span class="p">}</span>

        <span class="c1"># Compute some stuff</span>
        <span class="n">pdict</span> <span class="o">=</span> <span class="n">points_tangents_dicts</span><span class="p">[</span><span class="n">varphi_</span><span class="p">]</span>
        <span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">,</span> <span class="n">px_pz_eqn</span> \
            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figuratrix</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
        <span class="n">idtx_rdotx_array</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">rdotx_pz_eqn</span><span class="p">,</span> <span class="n">rdotz_pz_eqn</span> \
            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indicatrix</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pz_min&#39;</span><span class="p">],</span> <span class="n">pz_max</span><span class="o">=</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pz_max&#39;</span><span class="p">])</span>
        <span class="n">pz_</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">px_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">px_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">}))))</span>
        <span class="n">rdotx_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">rdotx_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">})))</span>
        <span class="n">rdotz_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">rdotz_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">pz</span><span class="p">:</span><span class="n">pz_</span><span class="p">})))</span>
        <span class="n">tanalpha_</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">rdotx_</span><span class="o">/</span><span class="n">rdotz_</span><span class="p">)</span>
        <span class="n">pdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;varphi&#39;</span><span class="p">:</span> <span class="n">varphi_</span><span class="p">,</span> <span class="s1">&#39;px&#39;</span> <span class="p">:</span> <span class="n">px_</span><span class="p">,</span> <span class="s1">&#39;pz&#39;</span> <span class="p">:</span> <span class="n">pz_</span><span class="p">,</span> <span class="s1">&#39;rdotx&#39;</span> <span class="p">:</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="s1">&#39;rdotz&#39;</span> <span class="p">:</span> <span class="n">rdotz_</span><span class="p">})</span>

        <span class="c1"># Do the plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_indicatrix</span><span class="p">(</span><span class="n">idtx_rdotx_array</span><span class="p">,</span> <span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">maybe_recip_fn</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_figuratrix</span><span class="p">(</span><span class="n">fgtx_px_array</span><span class="p">,</span> <span class="n">fgtx_pz_array</span><span class="p">,</span> <span class="n">maybe_recip_fn</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_unit_circle</span><span class="p">(</span><span class="n">do_varphi_circle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_lines_points</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_and_points</span><span class="p">(</span><span class="n">pdict</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">zoomx</span><span class="p">,</span> <span class="n">do_pz</span><span class="p">,</span> <span class="n">do_shapes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_labels</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">varphi_</span><span class="p">,</span> <span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="n">rdotz_</span><span class="p">,</span> <span class="n">zoom_factor</span><span class="p">,</span> <span class="n">do_text_labels</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_arrows</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrows</span><span class="p">(</span><span class="n">px_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">rdotx_</span><span class="p">,</span> <span class="n">rdotz_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_annotations</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotations</span><span class="p">(</span><span class="n">beta_</span><span class="p">,</span> <span class="n">tanalpha_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">gmeq</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">do_legend</span><span class="p">,</span> <span class="n">do_half</span><span class="p">,</span> <span class="n">do_ray_slowness</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ManuscriptPlots</span><span class="p">(</span><span class="n">Graphing</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">covector_isochrones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Schematic illustrating relationship between normal erosion rate vector, normal slowness covector,</span>
<span class="sd">        isochrones, covector components, and vertical/normal erosion rates.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Basics</span>
        <span class="n">beta_deg</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="n">beta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">)</span>
        <span class="n">origin_distance</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">origin_</span> <span class="o">=</span> <span class="p">(</span><span class="n">origin_distance</span><span class="p">,</span><span class="n">origin_distance</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">))</span>
        <span class="n">x_limit</span><span class="p">,</span> <span class="n">y_limit</span> <span class="o">=</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.5</span>
        <span class="n">p_color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
        <span class="n">u_color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>

        <span class="c1"># Vectors and covectors</span>
        <span class="n">u_perp_</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">p_</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">u_perp_</span>
        <span class="n">px_</span><span class="p">,</span><span class="n">pz_</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span><span class="o">-</span><span class="n">p_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta_</span><span class="p">))</span>
        <span class="n">nDt_</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">L_u_perp_</span> <span class="o">=</span> <span class="n">u_perp_</span><span class="o">*</span><span class="n">nDt_</span>
        <span class="n">L_p_</span><span class="p">,</span><span class="n">L_px_</span><span class="p">,</span><span class="n">L_pz_</span> <span class="o">=</span> <span class="n">p_</span><span class="o">*</span><span class="n">nDt_</span><span class="p">,</span><span class="n">px_</span><span class="o">*</span><span class="n">nDt_</span><span class="p">,</span><span class="n">pz_</span><span class="o">*</span><span class="n">nDt_</span>
        <span class="n">L_ux_</span><span class="p">,</span><span class="n">L_uz_</span> <span class="o">=</span> <span class="p">(</span><span class="n">L_u_perp_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span><span class="o">-</span><span class="n">L_u_perp_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta_</span><span class="p">))</span>
        <span class="c1"># L_px_,L_pz_ = (L_p_*np.sin(beta_),-L_p_*np.cos(beta_))</span>
        <span class="c1"># L_u_right_,L_u_up_ = (1/px_)*nDt_,(1/pz_)*nDt_</span>
        <span class="c1"># px_,pz_ = (p_*np.sin(beta_),-p_*np.cos(beta_))</span>

        <span class="c1"># Time scale and isochrones</span>
        <span class="n">n_major_isochrones</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">ts_major_isochrones</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">n_minor_isochrones</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_major_isochrones</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ts_major_isochrones</span><span class="o">+</span><span class="mi">2</span>
        <span class="n">sf_</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span>
        <span class="k">for</span> <span class="n">i_isochrone</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_minor_isochrones</span><span class="p">)):</span>
            <span class="n">color_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="n">i_isochrone</span><span class="o">=</span><span class="n">i_isochrone</span><span class="p">,</span> <span class="n">n_isochrones</span><span class="o">=</span><span class="n">n_minor_isochrones</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_array</span><span class="o">+</span><span class="n">sf_</span><span class="o">*</span><span class="n">i_isochrone</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span> <span class="n">x_array</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color_</span><span class="p">,</span>
                     <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span> <span class="k">if</span> <span class="n">i_isochrone</span> <span class="o">%</span> <span class="n">ts_major_isochrones</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.75</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$T(\mathbf</span><span class="si">{r}</span><span class="s1">)$&#39;</span><span class="o">+</span><span class="s1">&#39;$=</span><span class="si">{}</span><span class="s1">$y&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i_isochrone</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">i_isochrone</span> <span class="o">%</span> <span class="n">ts_major_isochrones</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># r vector</span>
        <span class="n">af</span><span class="p">,</span> <span class="n">naf</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span>
        <span class="n">r_length</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c1">#1.5</span>
        <span class="n">r_color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">r_color</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">r_length</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">naf</span><span class="o">+</span><span class="mf">0.04</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">r_length</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">naf</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{r}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">r_color</span><span class="p">)</span>


        <span class="c1"># Slowness covector p thick transparent lines</span>
        <span class="n">lw_pxz_</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">alpha_p_</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">px_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">L_px_</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">pz_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">L_pz_</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px_array</span><span class="p">,</span><span class="n">pz_array</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw_pxz_</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_p_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px_array</span><span class="p">,(</span><span class="n">pz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw_pxz_</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_p_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">px_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">px_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">pz_array</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw_pxz_</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_p_</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">,</span> <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">)</span>

        <span class="c1"># Slowness covector p decorations</span>
        <span class="n">hw</span><span class="o">=</span><span class="mf">0.12</span>
        <span class="n">hl</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">oh</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span>
        <span class="c1"># np_ = 1+int(0.5+np_scale*((p_-p_min)/p_range)) if p_&gt;=p_min else 1</span>
        <span class="k">for</span> <span class="n">np_</span><span class="p">,(</span><span class="n">dx_</span><span class="p">,</span><span class="n">dz_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">L_uz_</span><span class="o">/</span><span class="mi">1</span><span class="p">],[</span><span class="n">L_ux_</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">L_uz_</span><span class="o">/</span><span class="mi">4</span><span class="p">],[</span><span class="n">L_ux_</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]]):</span>
            <span class="n">x_</span><span class="p">,</span> <span class="n">z_</span> <span class="o">=</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i_head</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np_</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">,</span> <span class="n">dx_</span><span class="o">*</span><span class="n">i_head</span><span class="p">,</span> <span class="o">-</span><span class="n">dz_</span><span class="o">*</span><span class="n">i_head</span><span class="p">,</span>
                        <span class="n">head_width</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="n">hl</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                        <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="n">oh</span><span class="p">,</span>
                        <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">ec</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i_head</span><span class="o">==</span><span class="n">np_</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">sf</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.995</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.995</span><span class="p">]:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">z_</span><span class="p">,</span> <span class="n">dx_</span><span class="o">*</span><span class="n">i_head</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="o">-</span><span class="n">dz_</span><span class="o">*</span><span class="n">i_head</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                            <span class="n">head_width</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="n">hl</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                            <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="n">oh</span><span class="p">,</span>
                            <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">ec</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">px_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">px_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">px_array</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">22</span><span class="p">,(</span><span class="n">pz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">pz_array</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
                    <span class="n">head_width</span><span class="o">=</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                    <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">head_starts_at_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="c1"># Coordinate axes</span>
        <span class="n">x_off</span><span class="p">,</span> <span class="n">y_off</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.4</span>
        <span class="n">my_arrow_style</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">ArrowStyle</span><span class="o">.</span><span class="n">Fancy</span><span class="p">(</span><span class="n">head_length</span><span class="o">=.</span><span class="mi">99</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=.</span><span class="mi">6</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.05</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">+</span><span class="n">y_off</span><span class="p">),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.275</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">+</span><span class="n">y_off</span><span class="p">),</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.265</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">+</span><span class="mf">0.2</span><span class="o">+</span><span class="n">y_off</span><span class="p">),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.265</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">-</span><span class="mf">0.01</span><span class="o">+</span><span class="n">y_off</span><span class="p">),</span>
                        <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="n">my_arrow_style</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.05</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">+</span><span class="n">y_off</span><span class="p">,</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_limit</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.265</span><span class="o">+</span><span class="n">x_off</span><span class="p">,</span><span class="n">y_limit</span><span class="o">*</span><span class="mf">0.7</span><span class="o">+</span><span class="mf">0.2</span><span class="o">+</span><span class="n">y_off</span><span class="p">,</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="c1"># Surface isochrone text label</span>
        <span class="n">si_posn</span> <span class="o">=</span> <span class="mf">0.35</span> <span class="c1">#1.1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">si_posn</span><span class="o">+</span><span class="mf">0.13</span><span class="p">,</span><span class="n">si_posn</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;surface isochrone $\,\,T(\mathbf</span><span class="si">{r}</span><span class="s1">)$&#39;</span><span class="p">,</span>
                 <span class="n">rotation</span><span class="o">=</span><span class="n">beta_deg</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Gray&#39;</span><span class="p">)</span>

        <span class="c1"># Angle arc and text</span>
        <span class="n">arc_radius</span> <span class="o">=</span> <span class="mf">1.35</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Arc</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">arc_radius</span><span class="p">,</span><span class="n">arc_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Gray&#39;</span><span class="p">,</span>
                                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                     <span class="n">theta1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.18</span><span class="p">,</span><span class="mf">0.18</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta = $&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$^{\circ}$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Gray&#39;</span><span class="p">)</span>

        <span class="c1"># from matplotlib import rcParams</span>
        <span class="c1"># rcParams[&#39;text.usetex&#39;] = True</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage{amsmath}&#39;</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage[scaled]{helvet}&#39;</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage[T1]{fontenc}&#39;</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage{eucal}&#39;</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage[mathcal]{eucal}&#39;</span>
        <span class="c1"># rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage[mathscr]{eucal}&#39;</span>


        <span class="c1"># Erosion arrow</span>
        <span class="n">l_erosion_arrow</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="n">gray_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">off_</span> <span class="o">=</span> <span class="mf">0.38</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">off_</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">off_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span>
                  <span class="n">l_erosion_arrow</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">),</span><span class="o">-</span><span class="n">l_erosion_arrow</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                  <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">gray_</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">gray_</span><span class="p">,</span> <span class="n">capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">off_x</span><span class="p">,</span> <span class="n">off_z</span> <span class="o">=</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">off_</span><span class="o">+</span><span class="mf">0.02</span><span class="o">+</span><span class="n">off_x</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">off_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">+</span><span class="n">off_z</span><span class="p">,</span><span class="s1">&#39;erosion&#39;</span><span class="p">,</span>
                 <span class="n">rotation</span><span class="o">=</span><span class="n">beta_deg</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">gray_</span><span class="p">)</span>

        <span class="c1"># Unit normal n vector</span>
        <span class="n">off_x</span><span class="p">,</span> <span class="n">off_z</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span><span class="mf">0.55</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">off_x</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">off_z</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{n}</span><span class="s1"> = $&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">off_x</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">off_z</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;$\left[ \,\stackrel{\sqrt</span><span class="si">{3}</span><span class="s1">/</span><span class="si">{2}</span><span class="s1">}{-1/2}\, \right]$&#39;</span><span class="p">,</span> <span class="c1">#  \binom{\sqrt{3}/{2}}{-1/2}</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


        <span class="c1"># p text annotations</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">1.7</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;${{p}}_x(\mathbf{{n}}) = 3$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;${{p}}_z(\mathbf{{n}}) = 1$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">1.77</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">}(\mathbf{{n}}) = p = 4$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">} = [2\sqrt</span><span class="si">{3}</span><span class="s1"> \,\,\, -\!2]$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">p_color</span><span class="p">)</span>

        <span class="c1"># u arrows</span>
        <span class="n">lw_u</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">alpha_</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">u_perp</span><span class="p">,</span> <span class="n">u_vert</span><span class="p">,</span> <span class="n">u_horiz</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">af</span><span class="p">,</span> <span class="n">naf</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">*</span><span class="n">origin_</span><span class="p">,</span> <span class="n">u_perp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">af</span><span class="p">,</span><span class="o">-</span><span class="n">u_perp</span><span class="o">*</span><span class="n">af</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">u_perp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">af</span><span class="p">,</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">u_perp</span><span class="o">*</span><span class="n">af</span><span class="p">,</span>
                  <span class="n">u_perp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">naf</span><span class="p">,</span><span class="o">-</span><span class="n">u_perp</span><span class="o">*</span><span class="n">naf</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">af</span><span class="p">,</span> <span class="n">naf</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">*</span><span class="n">origin_</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">u_vert</span><span class="o">*</span><span class="n">af</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">u_vert</span><span class="o">*</span><span class="n">af</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">u_vert</span><span class="o">*</span><span class="n">naf</span><span class="o">+</span><span class="mf">0.015</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">af</span><span class="p">,</span> <span class="n">naf</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">*</span><span class="n">origin_</span><span class="p">,</span> <span class="n">u_horiz</span><span class="o">*</span><span class="n">af</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">u_horiz</span><span class="o">*</span><span class="n">af</span><span class="p">,</span> <span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">u_horiz</span><span class="o">*</span><span class="n">naf</span><span class="o">-</span><span class="mf">0.015</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">lw</span><span class="o">=</span><span class="n">lw_u</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">u_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># u text annotations</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.23</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.09</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;${\xi}^{\!\rightarrow} = \frac</span><span class="si">{1}</span><span class="s1">{p \, \sin\beta} = \frac</span><span class="si">{1}</span><span class="s1">{2\sqrt</span><span class="si">{3}</span><span class="s1">}$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">u_color</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.06</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.61</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;${\xi}^{\!\downarrow} = \frac</span><span class="si">{1}</span><span class="s1">{p \, \cos\beta} = \frac</span><span class="si">{1}{2}</span><span class="s1">$&#39;</span><span class="p">,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">u_color</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">origin_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">origin_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span>
                 <span class="sa">r</span><span class="s1">&#39;${\xi}^{\!\perp} = \frac</span><span class="si">{1}{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="c1">#&#39;$\xi^{\!\perp} = 1/4$&#39;,</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">u_color</span><span class="p">)</span>


        <span class="c1"># Grid, limits, etc</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x_limit</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">y_limit</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
        <span class="c1"># plt.legend(loc=&#39;center left&#39;, fontsize=13, framealpha=0.95)</span>


        <span class="c1"># Length scale</span>
        <span class="n">inset_axes_</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">31.5</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;distance  [mm]&#39;</span><span class="p">)</span>
        <span class="n">inset_axes_</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inset_axes_</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inset_axes_</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inset_axes_</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">huygens_wavelets</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">gmes</span><span class="p">,</span> <span class="n">gmeq</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">do_ray_conjugacy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_fast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">do_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">annotation_fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the loci of :math:`\mathbf{\widetilde{p}}` and :math:`\mathbf{r}` and</span>
<span class="sd">        their behavior defined by :math:`F` relative to the :math:`\xi` circle.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (:obj:`Matplotlib figure &lt;matplotlib.figure.Figure&gt;`):</span>
<span class="sd">                reference to figure instantiated by :meth:`GMPLib create_figure &lt;plot_utils.GraphingBase.create_figure&gt;`</span>
<span class="sd">            gmeq (:class:`~.equations.Equations`):</span>
<span class="sd">                    GME model equations class instance defined in :mod:`~.equations`</span>
<span class="sd">            do_ray_conjugacy (bool): optional generate ray conjugacy schematic?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">trace_indicatrix</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="n">xy_offset</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="mf">2.5e-2</span><span class="p">,</span> <span class="n">pz_max</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
            <span class="n">rdotx_pz_eqn</span> <span class="o">=</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">idtx_rdotx_pz_varphi_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
            <span class="n">rdotz_pz_eqn</span> <span class="o">=</span> <span class="n">gmeq</span><span class="o">.</span><span class="n">idtx_rdotz_pz_varphi_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
            <span class="n">rdotx_pz_lambda</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span> <span class="n">pz</span><span class="p">,</span> <span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">rdotx_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="p">))),</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
            <span class="n">rdotz_pz_lambda</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span> <span class="n">pz</span><span class="p">,</span> <span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">rdotz_pz_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="p">))),</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
            <span class="n">fgtx_pz_array</span> <span class="o">=</span> <span class="o">-</span><span class="n">pz_min</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">pz_max</span><span class="o">/</span><span class="n">pz_min</span><span class="p">),</span>
                                                           <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">pz_min</span><span class="o">/</span><span class="n">pz_min</span><span class="p">),</span><span class="n">n_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="c1"># print(fgtx_pz_array)</span>
            <span class="n">idtx_rdotx_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="nb">float</span><span class="p">(</span><span class="n">rdotx_pz_lambda</span><span class="p">(</span><span class="n">pz_</span><span class="p">))</span> <span class="k">for</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="n">fgtx_pz_array</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">idtx_rdotz_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="nb">float</span><span class="p">(</span><span class="n">rdotz_pz_lambda</span><span class="p">(</span><span class="n">pz_</span><span class="p">))</span> <span class="k">for</span> <span class="n">pz_</span> <span class="ow">in</span> <span class="n">fgtx_pz_array</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">idtx_rdotx_array</span><span class="o">*</span><span class="n">sf</span><span class="o">+</span><span class="n">xy_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">idtx_rdotz_array</span><span class="o">*</span><span class="n">sf</span><span class="o">+</span><span class="n">xy_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">isochrone_color</span><span class="p">,</span> <span class="n">isochrone_width</span><span class="p">,</span> <span class="n">isochrone_ms</span><span class="p">,</span> <span class="n">isochrone_ls</span> \
                <span class="o">=</span> <span class="s1">&#39;Black&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">new_isochrone_color</span><span class="p">,</span> <span class="n">newpt_isochrone_color</span><span class="p">,</span> <span class="n">new_isochrone_width</span><span class="p">,</span> \
            <span class="n">new_isochrone_ms</span><span class="p">,</span> <span class="n">new_isochrone_ls</span> \
                <span class="o">=</span> <span class="s1">&#39;Gray&#39;</span><span class="p">,</span> <span class="s1">&#39;White&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">4</span><span class="p">,</span> \
                  <span class="mi">8</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span>
        <span class="n">wavelet_color</span> <span class="o">=</span> <span class="s1">&#39;DarkRed&#39;</span>
        <span class="n">wavelet_width</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mf">1.5</span>
        <span class="n">p_color</span><span class="p">,</span> <span class="n">p_width</span> <span class="o">=</span> <span class="s1">&#39;Blue&#39;</span><span class="p">,</span> <span class="mi">2</span>
        <span class="n">r_color</span><span class="p">,</span> <span class="n">r_width</span> <span class="o">=</span> <span class="s1">&#39;#15e01a&#39;</span><span class="p">,</span> <span class="mf">1.5</span>

        <span class="n">dt_</span> <span class="o">=</span> <span class="mf">0.0015</span>
        <span class="n">dz_</span> <span class="o">=</span> <span class="o">-</span><span class="n">gmes</span><span class="o">.</span><span class="n">xiv_v_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dt_</span><span class="o">*</span><span class="mf">1.15</span>
        <span class="c1"># Fudge factors are NOT to &quot;correct&quot; curves but rather to account</span>
        <span class="c1">#   for the exaggerated Delta{t} that makes the approximations here just wrong</span>
        <span class="c1">#   enough to make the r, p etc annotations a bit wonky</span>
        <span class="n">dx_fudge</span><span class="p">,</span> <span class="n">dp_fudge</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span><span class="mf">1.15</span>

        <span class="c1"># Old isochrones</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                  <span class="n">mfc</span><span class="o">=</span><span class="n">isochrone_color</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">isochrone_ms</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;point $\mathbf</span><span class="si">{r}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">isochrone_width</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">isochrone_color</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">isochrone_ls</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;isochrone  $T(\mathbf</span><span class="si">{r}</span><span class="s1">)=t$&#39;</span> <span class="p">)</span>

        <span class="c1"># Adjust plot scale, limits</span>
        <span class="k">if</span> <span class="n">do_ray_conjugacy</span><span class="p">:</span>
            <span class="n">x_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.62</span><span class="p">];</span> <span class="n">y_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.018</span><span class="p">,</span><span class="mf">0.12</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># plt.xlim([0.5,0.8]); plt.ylim(0.045,0.2)</span>
            <span class="n">x_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.75</span><span class="p">];</span> <span class="n">y_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.19</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">x_limits</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">y_limits</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># New isochrones</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="o">+</span><span class="n">dx_fudge</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span> <span class="o">+</span> <span class="n">dz_</span><span class="p">,</span>
                  <span class="n">c</span><span class="o">=</span><span class="n">new_isochrone_color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">new_isochrone_width</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">new_isochrone_ls</span> <span class="p">)</span>

        <span class="c1"># Erosion arrow</span>
        <span class="n">i_</span> <span class="o">=</span> <span class="mi">161</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">180</span>
        <span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="p">]</span><span class="o">+</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="p">]</span><span class="o">+</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">do_ray_conjugacy</span><span class="p">:</span>
            <span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="p">]</span><span class="o">+</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                         <span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="p">]</span><span class="o">+</span><span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">rx_</span> <span class="o">+=</span> <span class="n">dx_fudge</span>
            <span class="n">rz_</span> <span class="o">+=</span> <span class="n">dz_</span>
        <span class="n">beta_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">))</span>
        <span class="n">beta_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="mf">0.03</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mf">0.06</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">5</span>
        <span class="n">l_erosion_arrow</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">gray_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_color</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span> <span class="n">rx_</span><span class="p">,</span><span class="n">rz_</span><span class="p">,</span> <span class="n">l_erosion_arrow</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span><span class="o">-</span><span class="n">l_erosion_arrow</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                   <span class="n">head_width</span><span class="o">=</span><span class="mf">0.15</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.15</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                   <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">gray_</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">gray_</span><span class="p">,</span> <span class="n">capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">sf</span> <span class="p">)</span>

        <span class="c1"># Erosion label</span>
        <span class="n">off_x</span><span class="p">,</span> <span class="n">off_z</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="o">+</span><span class="mf">0.015</span><span class="p">)</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">beta_deg</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="n">beta_deg</span><span class="o">-</span><span class="mi">90</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span> <span class="n">rx_</span><span class="o">+</span><span class="n">off_x</span><span class="p">,</span><span class="n">rz_</span><span class="o">+</span><span class="n">off_z</span><span class="p">,</span><span class="s1">&#39;erosion&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span>
                  <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="n">annotation_fontsize</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">gray_</span> <span class="p">)</span>

        <span class="c1"># Specify where to sample indicatrices</span>
        <span class="n">i_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i_end</span> <span class="o">=</span> <span class="mi">220</span><span class="p">;</span> <span class="n">n_i</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">do_fast</span> <span class="k">else</span> <span class="mi">15</span>
        <span class="n">i_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">111</span><span class="p">]</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> \
                <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">i_start</span><span class="o">+</span><span class="p">(</span><span class="n">i_end</span><span class="o">-</span><span class="n">i_start</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n_i</span><span class="p">)</span><span class="o">**</span><span class="mf">0.7</span><span class="p">]</span>

        <span class="c1"># Construct indicatrix wavelets</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">i_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">i_list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">i_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">i_from</span> <span class="o">=</span> <span class="n">i_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_x_array</span><span class="p">[</span><span class="n">i_</span><span class="p">],</span> <span class="n">gmes</span><span class="o">.</span><span class="n">h_z_array</span><span class="p">[</span><span class="n">i_</span><span class="p">]</span>
            <span class="n">drx_</span><span class="p">,</span> <span class="n">drz</span> <span class="o">=</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotx_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">)</span><span class="o">*</span><span class="n">dt_</span><span class="p">,</span> <span class="n">gmes</span><span class="o">.</span><span class="n">rdotz_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">)</span><span class="o">*</span><span class="n">dt_</span>
            <span class="n">rxn_</span><span class="p">,</span> <span class="n">rzn_</span> <span class="o">=</span> <span class="n">rx_</span><span class="o">+</span><span class="n">drx_</span><span class="p">,</span> <span class="n">rz_</span><span class="o">+</span><span class="n">drz</span>
            <span class="n">recip_p_</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">gmes</span><span class="o">.</span><span class="n">p_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">))</span><span class="o">*</span><span class="n">dt_</span>
            <span class="n">pxn_</span><span class="p">,</span> <span class="n">pzn_</span> <span class="o">=</span> <span class="n">rx_</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">gmes</span><span class="o">.</span><span class="n">px_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">))</span><span class="o">*</span><span class="n">dt_</span><span class="p">,</span> <span class="n">rz_</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">gmes</span><span class="o">.</span><span class="n">pz_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">))</span><span class="o">*</span><span class="n">dt_</span>
             <span class="c1">#(1/gmes.pz_array[0])*dt_</span>
            <span class="n">beta_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gmes</span><span class="o">.</span><span class="n">beta_p_interp</span><span class="p">(</span><span class="n">rx_</span><span class="p">))</span>
            <span class="n">dpx_</span><span class="p">,</span> <span class="n">dpz_</span> <span class="o">=</span> <span class="n">recip_p_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">dp_fudge</span><span class="p">,</span> <span class="o">-</span><span class="n">recip_p_</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta_</span><span class="p">)</span><span class="o">*</span><span class="n">dp_fudge</span>
            <span class="n">varphi_</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gmeq</span><span class="o">.</span><span class="n">varphi_rx_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span><span class="n">rx_</span><span class="p">}))</span>
            <span class="n">n_points</span> <span class="o">=</span> <span class="mi">80</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">5</span> <span class="k">if</span> <span class="n">do_fast</span> <span class="k">else</span> <span class="mi">50</span>
            <span class="n">pz_max</span> <span class="o">=</span> <span class="mi">1000</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mi">1000</span>
            <span class="n">idtx_rdotx_array</span><span class="p">,</span><span class="n">idtx_rdotz_array</span> \
                <span class="o">=</span> <span class="n">trace_indicatrix</span><span class="p">(</span> <span class="p">{</span><span class="n">varphi</span><span class="p">:</span><span class="n">varphi_</span><span class="p">},</span>  <span class="n">n_points</span><span class="o">=</span><span class="n">n_points</span><span class="p">,</span>
                                    <span class="n">xy_offset</span><span class="o">=</span><span class="p">[</span><span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="n">dt_</span><span class="p">,</span> <span class="n">pz_min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">pz_max</span><span class="o">=</span><span class="n">pz_max</span> <span class="p">)</span>

            <span class="c1"># Plot wavelets</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.5</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">idtx_rdotx_array</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">wavelet_width</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                      <span class="n">c</span><span class="o">=</span><span class="n">wavelet_color</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="s1">&#39;erosional wavelet $\{\Delta\mathbf</span><span class="si">{r}</span><span class="s1">\}$&#39;</span> <span class="k">if</span> <span class="n">i_</span><span class="o">==</span><span class="n">i_from</span> <span class="k">else</span> <span class="kc">None</span> <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">do_ray_conjugacy</span><span class="p">:</span>
                <span class="n">k_</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">rx_</span><span class="o">*</span><span class="n">k_</span><span class="o">+</span><span class="n">idtx_rdotx_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">k_</span><span class="p">),</span><span class="n">idtx_rdotx_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                          <span class="p">[</span><span class="n">rz_</span><span class="o">*</span><span class="n">k_</span><span class="o">+</span><span class="n">idtx_rdotz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">k_</span><span class="p">),</span><span class="n">idtx_rdotz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                          <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">wavelet_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span> <span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">rx_</span><span class="p">,</span><span class="n">idtx_rdotx_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">rz_</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                          <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">wavelet_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">rx_</span><span class="p">,</span><span class="n">idtx_rdotx_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">rz_</span><span class="p">,</span><span class="n">idtx_rdotz_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                          <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">wavelet_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span> <span class="p">)</span>

            <span class="c1"># Ray arrows &amp; new points</span>
            <span class="n">sf</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="mf">0.1</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span><span class="p">,</span> <span class="p">(</span><span class="n">rxn_</span><span class="o">-</span><span class="n">rx_</span><span class="p">),</span> <span class="p">(</span><span class="n">rzn_</span><span class="o">-</span><span class="n">rz_</span><span class="p">),</span>
                      <span class="n">head_width</span><span class="o">=</span><span class="mf">0.007</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                      <span class="n">head_length</span><span class="o">=</span><span class="mf">0.009</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                      <span class="n">overhang</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.0003</span><span class="p">,</span>
                      <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">r_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1">#, shape=&#39;full&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">rx_</span><span class="p">,</span> <span class="n">rxn_</span><span class="p">],</span> <span class="p">[</span><span class="n">rz_</span><span class="p">,</span> <span class="n">rzn_</span><span class="p">],</span>
                      <span class="n">lw</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="n">r_width</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">r_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="c1"># shape=&#39;full&#39;,</span>
                      <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;ray increment  $\Delta{\mathbf</span><span class="si">{r}</span><span class="s1">}$&#39;</span> <span class="k">if</span> <span class="n">i_</span><span class="o">==</span><span class="n">i_from</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">rxn_</span><span class="p">,</span> <span class="n">rzn_</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="n">new_isochrone_color</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">newpt_isochrone_color</span><span class="p">,</span>
                      <span class="n">ms</span><span class="o">=</span><span class="n">new_isochrone_ms</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

            <span class="c1"># Normal slownesses</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">rx_</span><span class="p">,</span><span class="n">rx_</span><span class="o">+</span><span class="n">dpx_</span><span class="p">],[</span><span class="n">rz_</span><span class="p">,</span><span class="n">rz_</span><span class="o">+</span><span class="n">dpz_</span><span class="p">],</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">p_color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span> <span class="k">if</span> <span class="n">do_ray_conjugacy</span> <span class="k">else</span> <span class="n">r_width</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;front increment  $\mathbf{\widetilde</span><span class="si">{p}</span><span class="s1">}\Delta</span><span class="si">{t}</span><span class="s1">\,/\,</span><span class="si">{p}</span><span class="s1">^2$&#39;</span>
                     <span class="k">if</span> <span class="n">i_</span><span class="o">==</span><span class="n">i_from</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># axes.annotate(&#39;&#39;, xy=(rx_,rz_), xytext=(rx_-dpx_*1e-6,rz_-dpz_*1e-6),</span>
            <span class="c1">#               arrowprops={&#39;headlength&#39;:0.4*sf, &#39;headwidth&#39;:0.2*sf, &#39;lw&#39;:1.5, &#39;ec&#39;:&#39;b&#39;, &#39;fc&#39;:&#39;w&#39;},</span>
            <span class="c1">#               va=&#39;center&#39;)</span>
            <span class="c1"># my_arrow_style = mpatches.ArrowStyle.Fancy(head_length=1*sf, head_width=.8*sf, tail_width=0.1*sf)</span>
            <span class="c1"># axes.annotate(&#39;&#39;, xy=(rx_,rz_), xytext=(rx_-dpx_*1e-6,rz_-dpz_*1e-6),</span>
            <span class="c1">#               arrowprops=dict(arrowstyle=my_arrow_style, color=&#39;b&#39;, lw=1.5))</span>
            <span class="k">if</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">do_ray_conjugacy</span><span class="p">:</span>
                <span class="n">sf</span> <span class="o">=</span> <span class="mf">1.5</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">rx_</span><span class="o">-</span><span class="n">dpx_</span><span class="o">*</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">rz_</span><span class="o">-</span><span class="n">dpz_</span><span class="o">*</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="n">dpx_</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="n">dpz_</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">head_width</span><span class="o">=</span><span class="mf">0.007</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=-</span><span class="mf">0.006</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">sf</span><span class="p">,</span>
                            <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">head_starts_at_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="c1"># Old points</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">rx_</span><span class="p">,</span> <span class="n">rz_</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">isochrone_color</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">isochrone_ms</span><span class="p">,</span>
                      <span class="n">fillstyle</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span> <span class="p">)</span>

        <span class="c1"># New isochrones</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">new_isochrone_color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">new_isochrone_width</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">new_isochrone_ls</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;isochrone  $T(\mathbf</span><span class="si">{r}</span><span class="s1">\!+\!\Delta{\mathbf</span><span class="si">{r}</span><span class="s1">})=t+\Delta</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">rxn_</span><span class="p">,</span> <span class="n">rzn_</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="n">new_isochrone_color</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">newpt_isochrone_color</span><span class="p">,</span>
                  <span class="n">ms</span><span class="o">=</span><span class="n">new_isochrone_ms</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;point $\mathbf</span><span class="si">{r}</span><span class="s1">+\Delta{\mathbf</span><span class="si">{r}</span><span class="s1">}$&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance, $x/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation, $z/x_1$  [-]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">do_legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="sidebar-anchor"></a>
    

<div id="searchbox" style="display: none" role="search">
    <a class="biglink" href="../index.html">
        <img src="../_static/gme_icon.png" />
    </a>
  <h3></h3>
    <form class="search" action="../search.html" method="get">
      <div class="ui action left icon input">
        <i class="search icon"></i>
        <input type="text" name="q" placeholder="Search...">
        <div class="ui teal button"></div>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<!-- <br> -->
<script type="text/javascript">$('#searchbox').show(0);</script><h3><a href="../index.html">Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Design.html">  Software design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dependencies.html">  Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">  Installation and set-up</a></li>
<li class="toctree-l1"><a class="reference internal" href="Running.html">  Running the notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Python.html">  Python package docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="symbols.html"> Symbol definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="equations.html"> Equation derivations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ode_base.html"> ODE integration (base)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ode_raytracing.html"> ODE integration (ray tracing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ode_knickpoints.html"> ODE integration (knickpoints)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"> Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Notebooks.html">  Notebook docs</a></li>
</ul>

    <!-- <h3><a href="../index.html">This page</a></h3> -->
    <!-- <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">plot.py</span></code></a><ul>
<li><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>
 -->
    <p class="biglink">
        <h3><a href="../genindex.html"> Index</a></h3>
    </p>
  <br>
  <!-- <p class="biglink"><a class="biglink" href="../py-modindex.html">
         Module index</a>
  <br><br> -->
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Notebooks.html" title="Jupyter notebooks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ode_knickpoints.html" title="ode_knickpoints.py"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, CPS.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.3.
    </div>
  </body>
</html>