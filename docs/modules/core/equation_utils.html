<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>equation_utils.py &#8212; GME 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pydoctheme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <script src="../../_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="gme.ode" href="../ode/index.html" />
    <link rel="prev" title="equations.py" href="equations.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="../../_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    

  </head><body>
    <!-- <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="../../index.html">GME 1.0 documentation</a> &#187;</li>
          <li><a href="../Python.html" >Python package <cite>gme</cite></a> &#187;</li>
          <li><a href="index.html" accesskey="U"><cite>gme.core</cite></a> &#187;</li> 
      </ul>
    </div> -->
    <!-- 
        <div class="badge">
            <a href="https://github.com/geomorphysics/GME/">Fork me on GitHub</a>
            <img src="../../_static/right-red@2x.png">
        </div>
     -->
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-gme.core.equation_utils">
<span id="equation-utils-py"></span><h1><code class="docutils literal notranslate"><span class="pre">equation_utils.py</span></code><a class="headerlink" href="#module-gme.core.equation_utils" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Equation definitions and derivations using <a class="reference external" href="https://docs.sympy.org/latest/modules/index.html#module-sympy" title="(in SymPy v1.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">SymPy</span></code></a>.</p>
<hr class="docutils" />
<p>This module provides a derivation of GME theory using <a class="reference external" href="https://docs.sympy.org/latest/modules/index.html#module-sympy" title="(in SymPy v1.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">SymPy</span></code></a>
for a 2D slice of a 3D landscape along a channel transect.</p>
<p>Starting from a model equation for the surface-normal erosion rate in terms of
the tilt angle of the topographic surface and the distance downstream
(used to infer the flow component of the model erosion process), we derive
the fundamental function (of a co-Finsler metric space), the corresponding
Hamiltonian,and the equivalent metric tensor.
The rest of the equations are derived from these core results.</p>
<hr class="docutils" />
<dl class="simple">
<dt>Requires Python packages/modules:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/index.html#module-scipy" title="(in SciPy v1.7.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a>, <a class="reference external" href="https://docs.sympy.org/latest/modules/index.html#module-sympy" title="(in SymPy v1.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy</span></code></a></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">gmplib.utils</span></code></p></li>
<li><p><a class="reference internal" href="symbols.html#module-gme.core.symbols" title="gme.core.symbols"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gme.core.symbols</span></code></a></p></li>
</ul>
</dd>
</dl>
<hr class="docutils" />
<dl class="py function">
<dt class="sig sig-object py" id="gme.core.equation_utils.gradient_value">
<span class="sig-prename descclassname"><span class="pre">gme.core.equation_utils.</span></span><span class="sig-name descname"><span class="pre">gradient_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_poly_eqn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_use_newton</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><a class="headerlink" href="#gme.core.equation_utils.gradient_value" title="Permalink to this definition">¶</a></dt>
<dd><p>TBD</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gme.core.equation_utils.px_value">
<span class="sig-prename descclassname"><span class="pre">gme.core.equation_utils.</span></span><span class="sig-name descname"><span class="pre">px_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_poly_eqn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_var_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">p_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_var_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">p_z</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><a class="headerlink" href="#gme.core.equation_utils.px_value" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>TODO</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gme.core.equation_utils.px_value_search">
<span class="sig-prename descclassname"><span class="pre">gme.core.equation_utils.</span></span><span class="sig-name descname"><span class="pre">px_value_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_poly_eqn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'newton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px_var_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">p_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz_var_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">p_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bracket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">30)</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><a class="headerlink" href="#gme.core.equation_utils.px_value_search" title="Permalink to this definition">¶</a></dt>
<dd><p>TBD</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gme.core.equation_utils.pxpz0_from_xiv0">
<span class="sig-prename descclassname"><span class="pre">gme.core.equation_utils.</span></span><span class="sig-name descname"><span class="pre">pxpz0_from_xiv0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz0_xiv0_eqn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_px_xiv0_eqn</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#gme.core.equation_utils.pxpz0_from_xiv0" title="Permalink to this definition">¶</a></dt>
<dd><p>TBD</p>
</dd></dl>

<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">Equation definitions and derivations using :mod:`SymPy &lt;sympy&gt;`.</span>

<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">This module provides a derivation of GME theory using :mod:`SymPy &lt;sympy&gt;`</span>
<span class="sd">for a 2D slice of a 3D landscape along a channel transect.</span>

<span class="sd">Starting from a model equation for the surface-normal erosion rate in terms of</span>
<span class="sd">the tilt angle of the topographic surface and the distance downstream</span>
<span class="sd">(used to infer the flow component of the model erosion process), we derive</span>
<span class="sd">the fundamental function (of a co-Finsler metric space), the corresponding</span>
<span class="sd">Hamiltonian,and the equivalent metric tensor.</span>
<span class="sd">The rest of the equations are derived from these core results.</span>

<span class="sd">---------------------------------------------------------------------</span>


<span class="sd">Requires Python packages/modules:</span>
<span class="sd">  -  :mod:`scipy`, :mod:`sympy`</span>
<span class="sd">  -  :mod:`gmplib.utils`</span>
<span class="sd">  -  :mod:`gme.core.symbols`</span>

<span class="sd">---------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Typing</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="c1"># SciPy</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root_scalar</span>

<span class="c1"># SymPy</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">lambdify</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> \
                  <span class="n">poly</span><span class="p">,</span> <span class="n">nroots</span><span class="p">,</span> <span class="n">Abs</span>

<span class="c1"># GME</span>
<span class="kn">from</span> <span class="nn">gme.core.symbols</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">pz</span><span class="p">,</span> <span class="n">xiv</span><span class="p">,</span> <span class="n">xiv_0</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pxpz0_from_xiv0&#39;</span><span class="p">,</span> <span class="s1">&#39;gradient_value&#39;</span><span class="p">,</span> <span class="s1">&#39;px_value_search&#39;</span><span class="p">,</span> <span class="s1">&#39;px_value&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">pxpz0_from_xiv0</span><span class="p">(</span><span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
                    <span class="c1"># xiv_0_, xih_0_,</span>
                    <span class="n">pz0_xiv0_eqn</span><span class="p">,</span> <span class="n">poly_px_xiv0_eqn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TBD</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pz0_xiv0_eqn = pz_xiv_eqn.subs({xiv:xiv_0}).subs(parameters)</span>
    <span class="n">px0_poly_rx0_eqn</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">poly_px_xiv0_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
    <span class="c1"># .subs(parameters))</span>
    <span class="c1"># eta_ = eta.subs(parameters)</span>
    <span class="c1"># if True: #eta==Rational(1,2) or eta==Rational(3,2):</span>
    <span class="n">px0sqrd_solns</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">px0_poly_rx0_eqn</span><span class="p">,</span> <span class="n">px</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">px0_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">([</span><span class="n">px0sqrd_</span> <span class="k">for</span> <span class="n">px0sqrd_</span> <span class="ow">in</span> <span class="n">px0sqrd_solns</span>
                        <span class="k">if</span> <span class="n">re</span><span class="p">(</span><span class="n">px0sqrd_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">im</span><span class="p">(</span><span class="n">px0sqrd_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># else:</span>
    <span class="c1">#     px0_poly_lambda = lambdify( [px], px0_poly_rx0_eqn.lhs.as_expr() )</span>
    <span class="c1">#     dpx0_poly_lambda \</span>
    <span class="c1">#  = lambdify( [px], diff(px0_poly_rx0_eqn.lhs.as_expr(),px) )</span>
    <span class="c1">#     px0_root_search = None</span>
    <span class="c1">#     for px_guess_ in [px_guess]:</span>
    <span class="c1">#         px0_root_search = root_scalar( px0_poly_lambda,</span>
    <span class="c1"># fprime=dpx0_poly_lambda,</span>
    <span class="c1">#                 method=&#39;newton&#39;, x0=px_guess_ )</span>
    <span class="c1">#         if px0_root_search.converged:</span>
    <span class="c1">#             break</span>
    <span class="c1">#     px0_ = px0_root_search.root</span>

    <span class="n">pz0_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">pz0_xiv0_eqn</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">xiv</span><span class="p">:</span> <span class="n">xiv_0</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">px0_</span><span class="p">,</span> <span class="n">pz0_</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">gradient_value</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">px_poly_eqn</span><span class="p">,</span> <span class="n">do_use_newton</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TBD</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">px_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="n">px_value_search</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">px_poly_eqn</span><span class="p">)</span> <span class="k">if</span> <span class="n">do_use_newton</span> \
        <span class="k">else</span> <span class="o">-</span><span class="n">px_value</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">px_poly_eqn</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">px_</span><span class="o">/</span><span class="n">pz_</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">px_value_search</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">px_poly_eqn</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;newton&#39;</span><span class="p">,</span>
                    <span class="n">px_guess</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">px_var_</span><span class="o">=</span><span class="n">px</span><span class="p">,</span> <span class="n">pz_var_</span><span class="o">=</span><span class="n">pz</span><span class="p">,</span>
                    <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TBD</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">px_poly_eqn_</span> <span class="o">=</span> <span class="n">px_poly_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span> <span class="n">x_</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x_</span><span class="p">,</span> <span class="n">pz_var_</span><span class="p">:</span> <span class="n">pz_</span><span class="p">})</span>
    <span class="n">px_poly_lambda</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">([</span><span class="n">px_var_</span><span class="p">],</span> <span class="n">px_poly_eqn_</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
    <span class="n">dpx_poly_lambda</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">([</span><span class="n">px_var_</span><span class="p">],</span>
                               <span class="n">diff</span><span class="p">(</span><span class="n">px_poly_eqn_</span><span class="o">.</span><span class="n">as_expr</span><span class="p">(),</span> <span class="n">px_var_</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;newton&#39;</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">bracket_</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">bracket</span> <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;brentq&#39;</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">px_guess_</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">px_guess</span><span class="p">]:</span>
        <span class="n">px_root_search</span> \
            <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">px_poly_lambda</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">dpx_poly_lambda</span><span class="p">,</span>
                          <span class="n">bracket</span><span class="o">=</span><span class="n">bracket_</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">px_guess_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">px_root_search</span><span class="o">.</span><span class="n">converged</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="c1"># px_root_search = root_scalar( px_poly_lambda, fprime=dpx_poly_lambda,</span>
    <span class="c1">#     method=&#39;newton&#39;, x0=px_guess )</span>
    <span class="n">px_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">px_root_search</span><span class="o">.</span><span class="n">root</span>
    <span class="k">return</span> <span class="n">px_</span>


<span class="k">def</span> <span class="nf">px_value</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">pz_</span><span class="p">,</span> <span class="n">px_poly_eqn</span><span class="p">,</span> <span class="n">px_var_</span><span class="o">=</span><span class="n">px</span><span class="p">,</span> <span class="n">pz_var_</span><span class="o">=</span><span class="n">pz</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TODO.</span>

<span class="sd">    Args:</span>
<span class="sd">        TODO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">px_poly_eqn_</span> <span class="o">=</span> <span class="n">poly</span><span class="p">(</span><span class="n">px_poly_eqn</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">rx</span><span class="p">:</span> <span class="n">x_</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x_</span><span class="p">,</span> <span class="n">pz_var_</span><span class="p">:</span> <span class="n">pz_</span><span class="p">}))</span>
    <span class="n">px_poly_roots</span> <span class="o">=</span> <span class="n">nroots</span><span class="p">(</span><span class="n">px_poly_eqn_</span><span class="p">)</span>
    <span class="n">pxgen</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">root_</span> <span class="k">for</span> <span class="n">root_</span> <span class="ow">in</span> <span class="n">px_poly_roots</span>
                          <span class="k">if</span> <span class="n">Abs</span><span class="p">(</span><span class="n">im</span><span class="p">(</span><span class="n">root_</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span> <span class="ow">and</span> <span class="n">re</span><span class="p">(</span><span class="n">root_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">px_poly_eqn_</span><span class="o">.</span><span class="n">gens</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pxgen</span><span class="p">),</span> <span class="n">px_var_</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="sidebar-anchor"></a>
    

<div id="searchbox" style="display: none" role="search">
    <a class="biglink" href="../../index.html">
        <img src="../../_static/gme_icon_varphi_rx.png" />
    </a>
  <h3></h3>
    <form class="search" action="../../search.html" method="get">
      <div class="ui action left icon input">
        <i class="search icon"></i>
        <input type="text" name="q" placeholder="Search...">
        <div class="ui teal button"></div>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<!-- <br> -->
<script type="text/javascript">$('#searchbox').show(0);</script><h3><a href="../../index.html">Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary.html">  Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Presentations.html">  Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Publications.html">  Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Design.html">  Software design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Dependencies.html">  Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">  Installation and set-up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Running.html">  Running the notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Python.html">  Python package docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ode/index.html">ODE integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot/index.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knickpoints/index.html">Knickpoint detection and tracking [in development]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Notebooks.html">  Notebook docs</a></li>
</ul>

    <!-- <h3><a href="../../index.html">This page</a></h3> -->
    <!-- <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">equation_utils.py</span></code></a><ul>
<li><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>
 -->
    <p class="biglink">
        <h3><a href="../../genindex.html"> Index</a></h3>
    </p>
  <br>
  <!-- <p class="biglink"><a class="biglink" href="../../py-modindex.html">
         Module index</a>
  <br><br> -->
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ode/index.html" title="gme.ode"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="equations.html" title="equations.py"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, CPS.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.3.
    </div>
  </body>
</html>